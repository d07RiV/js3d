!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/js3d/",n(n.s=75)}([function(t,e,n){"use strict";var r=n(85),i=(n(38),n(22));n.d(e,"g",function(){return i.a}),n.d(e,"h",function(){return i.b});var o=n(90);n.d(e,"c",function(){return o.a}),n.d(e,"d",function(){return o.b}),n.d(e,"e",function(){return o.c});var a=n(91);n.d(e,"f",function(){return a.a}),n.d(e,"a",function(){return r});var s=n(92);n.d(e,"b",function(){return s.a});n(93)},function(t,e,n){"use strict";var r=n(0),i={average:function(t,e){return.5*(t+e)},multiply:function(t,e){return t*e},minimum:function(t,e){return Math.min(t,e)},maximum:function(t,e){return Math.max(t,e)}};e.a={combiners:i,iterations:8,positionIterations:2,step:1/60,defaultGravity:r.g.fromValues(0,0,-10),defaultMaterial:{restitution:0,friction:.5,density:1,frictionCombine:i.average,restitutionCombine:i.average},delta:.01,sleepTime:.5,sleepThreshold:.08,sleepWakeThreshold:.15,angularMomentum:!1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DEPTH_BUFFER_BIT",function(){return r}),n.d(e,"STENCIL_BUFFER_BIT",function(){return i}),n.d(e,"COLOR_BUFFER_BIT",function(){return o}),n.d(e,"POINTS",function(){return a}),n.d(e,"LINES",function(){return s}),n.d(e,"LINE_LOOP",function(){return u}),n.d(e,"LINE_STRIP",function(){return c}),n.d(e,"TRIANGLES",function(){return f}),n.d(e,"TRIANGLE_STRIP",function(){return l}),n.d(e,"TRIANGLE_FAN",function(){return h}),n.d(e,"ZERO",function(){return d}),n.d(e,"ONE",function(){return _}),n.d(e,"SRC_COLOR",function(){return p}),n.d(e,"ONE_MINUS_SRC_COLOR",function(){return E}),n.d(e,"SRC_ALPHA",function(){return g}),n.d(e,"ONE_MINUS_SRC_ALPHA",function(){return v}),n.d(e,"DST_ALPHA",function(){return A}),n.d(e,"ONE_MINUS_DST_ALPHA",function(){return T}),n.d(e,"DST_COLOR",function(){return y}),n.d(e,"ONE_MINUS_DST_COLOR",function(){return m}),n.d(e,"SRC_ALPHA_SATURATE",function(){return b}),n.d(e,"FUNC_ADD",function(){return R}),n.d(e,"BLEND_EQUATION",function(){return N}),n.d(e,"BLEND_EQUATION_RGB",function(){return I}),n.d(e,"BLEND_EQUATION_ALPHA",function(){return M}),n.d(e,"FUNC_SUBTRACT",function(){return O}),n.d(e,"FUNC_REVERSE_SUBTRACT",function(){return P}),n.d(e,"BLEND_DST_RGB",function(){return S}),n.d(e,"BLEND_SRC_RGB",function(){return x}),n.d(e,"BLEND_DST_ALPHA",function(){return w}),n.d(e,"BLEND_SRC_ALPHA",function(){return L}),n.d(e,"CONSTANT_COLOR",function(){return F}),n.d(e,"ONE_MINUS_CONSTANT_COLOR",function(){return U}),n.d(e,"CONSTANT_ALPHA",function(){return C}),n.d(e,"ONE_MINUS_CONSTANT_ALPHA",function(){return D}),n.d(e,"BLEND_COLOR",function(){return B}),n.d(e,"ARRAY_BUFFER",function(){return X}),n.d(e,"ELEMENT_ARRAY_BUFFER",function(){return j}),n.d(e,"ARRAY_BUFFER_BINDING",function(){return k}),n.d(e,"ELEMENT_ARRAY_BUFFER_BINDING",function(){return Y}),n.d(e,"STREAM_DRAW",function(){return V}),n.d(e,"STATIC_DRAW",function(){return H}),n.d(e,"DYNAMIC_DRAW",function(){return G}),n.d(e,"BUFFER_SIZE",function(){return z}),n.d(e,"BUFFER_USAGE",function(){return Q}),n.d(e,"CURRENT_VERTEX_ATTRIB",function(){return W}),n.d(e,"FRONT",function(){return K}),n.d(e,"BACK",function(){return q}),n.d(e,"FRONT_AND_BACK",function(){return Z}),n.d(e,"CULL_FACE",function(){return J}),n.d(e,"BLEND",function(){return $}),n.d(e,"DITHER",function(){return tt}),n.d(e,"STENCIL_TEST",function(){return et}),n.d(e,"DEPTH_TEST",function(){return nt}),n.d(e,"SCISSOR_TEST",function(){return rt}),n.d(e,"POLYGON_OFFSET_FILL",function(){return it}),n.d(e,"SAMPLE_ALPHA_TO_COVERAGE",function(){return ot}),n.d(e,"SAMPLE_COVERAGE",function(){return at}),n.d(e,"NO_ERROR",function(){return st}),n.d(e,"INVALID_ENUM",function(){return ut}),n.d(e,"INVALID_VALUE",function(){return ct}),n.d(e,"INVALID_OPERATION",function(){return ft}),n.d(e,"OUT_OF_MEMORY",function(){return lt}),n.d(e,"CW",function(){return ht}),n.d(e,"CCW",function(){return dt}),n.d(e,"LINE_WIDTH",function(){return _t}),n.d(e,"ALIASED_POINT_SIZE_RANGE",function(){return pt}),n.d(e,"ALIASED_LINE_WIDTH_RANGE",function(){return Et}),n.d(e,"CULL_FACE_MODE",function(){return gt}),n.d(e,"FRONT_FACE",function(){return vt}),n.d(e,"DEPTH_RANGE",function(){return At}),n.d(e,"DEPTH_WRITEMASK",function(){return Tt}),n.d(e,"DEPTH_CLEAR_VALUE",function(){return yt}),n.d(e,"DEPTH_FUNC",function(){return mt}),n.d(e,"STENCIL_CLEAR_VALUE",function(){return bt}),n.d(e,"STENCIL_FUNC",function(){return Rt}),n.d(e,"STENCIL_FAIL",function(){return Nt}),n.d(e,"STENCIL_PASS_DEPTH_FAIL",function(){return It}),n.d(e,"STENCIL_PASS_DEPTH_PASS",function(){return Mt}),n.d(e,"STENCIL_REF",function(){return Ot}),n.d(e,"STENCIL_VALUE_MASK",function(){return Pt}),n.d(e,"STENCIL_WRITEMASK",function(){return St}),n.d(e,"STENCIL_BACK_FUNC",function(){return xt}),n.d(e,"STENCIL_BACK_FAIL",function(){return wt}),n.d(e,"STENCIL_BACK_PASS_DEPTH_FAIL",function(){return Lt}),n.d(e,"STENCIL_BACK_PASS_DEPTH_PASS",function(){return Ft}),n.d(e,"STENCIL_BACK_REF",function(){return Ut}),n.d(e,"STENCIL_BACK_VALUE_MASK",function(){return Ct}),n.d(e,"STENCIL_BACK_WRITEMASK",function(){return Dt}),n.d(e,"VIEWPORT",function(){return Bt}),n.d(e,"SCISSOR_BOX",function(){return Xt}),n.d(e,"COLOR_CLEAR_VALUE",function(){return jt}),n.d(e,"COLOR_WRITEMASK",function(){return kt}),n.d(e,"UNPACK_ALIGNMENT",function(){return Yt}),n.d(e,"PACK_ALIGNMENT",function(){return Vt}),n.d(e,"MAX_TEXTURE_SIZE",function(){return Ht}),n.d(e,"MAX_VIEWPORT_DIMS",function(){return Gt}),n.d(e,"SUBPIXEL_BITS",function(){return zt}),n.d(e,"RED_BITS",function(){return Qt}),n.d(e,"GREEN_BITS",function(){return Wt}),n.d(e,"BLUE_BITS",function(){return Kt}),n.d(e,"ALPHA_BITS",function(){return qt}),n.d(e,"DEPTH_BITS",function(){return Zt}),n.d(e,"STENCIL_BITS",function(){return Jt}),n.d(e,"POLYGON_OFFSET_UNITS",function(){return $t}),n.d(e,"POLYGON_OFFSET_FACTOR",function(){return te}),n.d(e,"TEXTURE_BINDING_2D",function(){return ee}),n.d(e,"SAMPLE_BUFFERS",function(){return ne}),n.d(e,"SAMPLES",function(){return re}),n.d(e,"SAMPLE_COVERAGE_VALUE",function(){return ie}),n.d(e,"SAMPLE_COVERAGE_INVERT",function(){return oe}),n.d(e,"COMPRESSED_TEXTURE_FORMATS",function(){return ae}),n.d(e,"DONT_CARE",function(){return se}),n.d(e,"FASTEST",function(){return ue}),n.d(e,"NICEST",function(){return ce}),n.d(e,"GENERATE_MIPMAP_HINT",function(){return fe}),n.d(e,"BYTE",function(){return le}),n.d(e,"UNSIGNED_BYTE",function(){return he}),n.d(e,"SHORT",function(){return de}),n.d(e,"UNSIGNED_SHORT",function(){return _e}),n.d(e,"INT",function(){return pe}),n.d(e,"UNSIGNED_INT",function(){return Ee}),n.d(e,"FLOAT",function(){return ge}),n.d(e,"DEPTH_COMPONENT",function(){return ve}),n.d(e,"ALPHA",function(){return Ae}),n.d(e,"RGB",function(){return Te}),n.d(e,"RGBA",function(){return ye}),n.d(e,"LUMINANCE",function(){return me}),n.d(e,"LUMINANCE_ALPHA",function(){return be}),n.d(e,"UNSIGNED_SHORT_4_4_4_4",function(){return Re}),n.d(e,"UNSIGNED_SHORT_5_5_5_1",function(){return Ne}),n.d(e,"UNSIGNED_SHORT_5_6_5",function(){return Ie}),n.d(e,"FRAGMENT_SHADER",function(){return Me}),n.d(e,"VERTEX_SHADER",function(){return Oe}),n.d(e,"MAX_VERTEX_ATTRIBS",function(){return Pe}),n.d(e,"MAX_VERTEX_UNIFORM_VECTORS",function(){return Se}),n.d(e,"MAX_VARYING_VECTORS",function(){return xe}),n.d(e,"MAX_COMBINED_TEXTURE_IMAGE_UNITS",function(){return we}),n.d(e,"MAX_VERTEX_TEXTURE_IMAGE_UNITS",function(){return Le}),n.d(e,"MAX_TEXTURE_IMAGE_UNITS",function(){return Fe}),n.d(e,"MAX_FRAGMENT_UNIFORM_VECTORS",function(){return Ue}),n.d(e,"SHADER_TYPE",function(){return Ce}),n.d(e,"DELETE_STATUS",function(){return De}),n.d(e,"LINK_STATUS",function(){return Be}),n.d(e,"VALIDATE_STATUS",function(){return Xe}),n.d(e,"ATTACHED_SHADERS",function(){return je}),n.d(e,"ACTIVE_UNIFORMS",function(){return ke}),n.d(e,"ACTIVE_ATTRIBUTES",function(){return Ye}),n.d(e,"SHADING_LANGUAGE_VERSION",function(){return Ve}),n.d(e,"CURRENT_PROGRAM",function(){return He}),n.d(e,"NEVER",function(){return Ge}),n.d(e,"LESS",function(){return ze}),n.d(e,"EQUAL",function(){return Qe}),n.d(e,"LEQUAL",function(){return We}),n.d(e,"GREATER",function(){return Ke}),n.d(e,"NOTEQUAL",function(){return qe}),n.d(e,"GEQUAL",function(){return Ze}),n.d(e,"ALWAYS",function(){return Je}),n.d(e,"KEEP",function(){return $e}),n.d(e,"REPLACE",function(){return tn}),n.d(e,"INCR",function(){return en}),n.d(e,"DECR",function(){return nn}),n.d(e,"INVERT",function(){return rn}),n.d(e,"INCR_WRAP",function(){return on}),n.d(e,"DECR_WRAP",function(){return an}),n.d(e,"VENDOR",function(){return sn}),n.d(e,"RENDERER",function(){return un}),n.d(e,"VERSION",function(){return cn}),n.d(e,"NEAREST",function(){return fn}),n.d(e,"LINEAR",function(){return ln}),n.d(e,"NEAREST_MIPMAP_NEAREST",function(){return hn}),n.d(e,"LINEAR_MIPMAP_NEAREST",function(){return dn}),n.d(e,"NEAREST_MIPMAP_LINEAR",function(){return _n}),n.d(e,"LINEAR_MIPMAP_LINEAR",function(){return pn}),n.d(e,"TEXTURE_MAG_FILTER",function(){return En}),n.d(e,"TEXTURE_MIN_FILTER",function(){return gn}),n.d(e,"TEXTURE_WRAP_S",function(){return vn}),n.d(e,"TEXTURE_WRAP_T",function(){return An}),n.d(e,"TEXTURE_2D",function(){return Tn}),n.d(e,"TEXTURE",function(){return yn}),n.d(e,"TEXTURE_CUBE_MAP",function(){return mn}),n.d(e,"TEXTURE_BINDING_CUBE_MAP",function(){return bn}),n.d(e,"TEXTURE_CUBE_MAP_POSITIVE_X",function(){return Rn}),n.d(e,"TEXTURE_CUBE_MAP_NEGATIVE_X",function(){return Nn}),n.d(e,"TEXTURE_CUBE_MAP_POSITIVE_Y",function(){return In}),n.d(e,"TEXTURE_CUBE_MAP_NEGATIVE_Y",function(){return Mn}),n.d(e,"TEXTURE_CUBE_MAP_POSITIVE_Z",function(){return On}),n.d(e,"TEXTURE_CUBE_MAP_NEGATIVE_Z",function(){return Pn}),n.d(e,"MAX_CUBE_MAP_TEXTURE_SIZE",function(){return Sn}),n.d(e,"TEXTURE0",function(){return xn}),n.d(e,"TEXTURE1",function(){return wn}),n.d(e,"TEXTURE2",function(){return Ln}),n.d(e,"TEXTURE3",function(){return Fn}),n.d(e,"TEXTURE4",function(){return Un}),n.d(e,"TEXTURE5",function(){return Cn}),n.d(e,"TEXTURE6",function(){return Dn}),n.d(e,"TEXTURE7",function(){return Bn}),n.d(e,"TEXTURE8",function(){return Xn}),n.d(e,"TEXTURE9",function(){return jn}),n.d(e,"TEXTURE10",function(){return kn}),n.d(e,"TEXTURE11",function(){return Yn}),n.d(e,"TEXTURE12",function(){return Vn}),n.d(e,"TEXTURE13",function(){return Hn}),n.d(e,"TEXTURE14",function(){return Gn}),n.d(e,"TEXTURE15",function(){return zn}),n.d(e,"TEXTURE16",function(){return Qn}),n.d(e,"TEXTURE17",function(){return Wn}),n.d(e,"TEXTURE18",function(){return Kn}),n.d(e,"TEXTURE19",function(){return qn}),n.d(e,"TEXTURE20",function(){return Zn}),n.d(e,"TEXTURE21",function(){return Jn}),n.d(e,"TEXTURE22",function(){return $n}),n.d(e,"TEXTURE23",function(){return tr}),n.d(e,"TEXTURE24",function(){return er}),n.d(e,"TEXTURE25",function(){return nr}),n.d(e,"TEXTURE26",function(){return rr}),n.d(e,"TEXTURE27",function(){return ir}),n.d(e,"TEXTURE28",function(){return or}),n.d(e,"TEXTURE29",function(){return ar}),n.d(e,"TEXTURE30",function(){return sr}),n.d(e,"TEXTURE31",function(){return ur}),n.d(e,"ACTIVE_TEXTURE",function(){return cr}),n.d(e,"REPEAT",function(){return fr}),n.d(e,"CLAMP_TO_EDGE",function(){return lr}),n.d(e,"MIRRORED_REPEAT",function(){return hr}),n.d(e,"FLOAT_VEC2",function(){return dr}),n.d(e,"FLOAT_VEC3",function(){return _r}),n.d(e,"FLOAT_VEC4",function(){return pr}),n.d(e,"INT_VEC2",function(){return Er}),n.d(e,"INT_VEC3",function(){return gr}),n.d(e,"INT_VEC4",function(){return vr}),n.d(e,"BOOL",function(){return Ar}),n.d(e,"BOOL_VEC2",function(){return Tr}),n.d(e,"BOOL_VEC3",function(){return yr}),n.d(e,"BOOL_VEC4",function(){return mr}),n.d(e,"FLOAT_MAT2",function(){return br}),n.d(e,"FLOAT_MAT3",function(){return Rr}),n.d(e,"FLOAT_MAT4",function(){return Nr}),n.d(e,"SAMPLER_2D",function(){return Ir}),n.d(e,"SAMPLER_CUBE",function(){return Mr}),n.d(e,"VERTEX_ATTRIB_ARRAY_ENABLED",function(){return Or}),n.d(e,"VERTEX_ATTRIB_ARRAY_SIZE",function(){return Pr}),n.d(e,"VERTEX_ATTRIB_ARRAY_STRIDE",function(){return Sr}),n.d(e,"VERTEX_ATTRIB_ARRAY_TYPE",function(){return xr}),n.d(e,"VERTEX_ATTRIB_ARRAY_NORMALIZED",function(){return wr}),n.d(e,"VERTEX_ATTRIB_ARRAY_POINTER",function(){return Lr}),n.d(e,"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",function(){return Fr}),n.d(e,"COMPILE_STATUS",function(){return Ur}),n.d(e,"LOW_FLOAT",function(){return Cr}),n.d(e,"MEDIUM_FLOAT",function(){return Dr}),n.d(e,"HIGH_FLOAT",function(){return Br}),n.d(e,"LOW_INT",function(){return Xr}),n.d(e,"MEDIUM_INT",function(){return jr}),n.d(e,"HIGH_INT",function(){return kr}),n.d(e,"FRAMEBUFFER",function(){return Yr}),n.d(e,"RENDERBUFFER",function(){return Vr}),n.d(e,"RGBA4",function(){return Hr}),n.d(e,"RGB5_A1",function(){return Gr}),n.d(e,"RGB565",function(){return zr}),n.d(e,"DEPTH_COMPONENT16",function(){return Qr}),n.d(e,"STENCIL_INDEX8",function(){return Wr}),n.d(e,"DEPTH_STENCIL",function(){return Kr}),n.d(e,"RENDERBUFFER_WIDTH",function(){return qr}),n.d(e,"RENDERBUFFER_HEIGHT",function(){return Zr}),n.d(e,"RENDERBUFFER_INTERNAL_FORMAT",function(){return Jr}),n.d(e,"RENDERBUFFER_RED_SIZE",function(){return $r}),n.d(e,"RENDERBUFFER_GREEN_SIZE",function(){return ti}),n.d(e,"RENDERBUFFER_BLUE_SIZE",function(){return ei}),n.d(e,"RENDERBUFFER_ALPHA_SIZE",function(){return ni}),n.d(e,"RENDERBUFFER_DEPTH_SIZE",function(){return ri}),n.d(e,"RENDERBUFFER_STENCIL_SIZE",function(){return ii}),n.d(e,"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",function(){return oi}),n.d(e,"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",function(){return ai}),n.d(e,"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",function(){return si}),n.d(e,"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",function(){return ui}),n.d(e,"COLOR_ATTACHMENT0",function(){return ci}),n.d(e,"DEPTH_ATTACHMENT",function(){return fi}),n.d(e,"STENCIL_ATTACHMENT",function(){return li}),n.d(e,"DEPTH_STENCIL_ATTACHMENT",function(){return hi}),n.d(e,"NONE",function(){return di}),n.d(e,"FRAMEBUFFER_COMPLETE",function(){return _i}),n.d(e,"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",function(){return pi}),n.d(e,"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",function(){return Ei}),n.d(e,"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",function(){return gi}),n.d(e,"FRAMEBUFFER_UNSUPPORTED",function(){return vi}),n.d(e,"FRAMEBUFFER_BINDING",function(){return Ai}),n.d(e,"RENDERBUFFER_BINDING",function(){return Ti}),n.d(e,"MAX_RENDERBUFFER_SIZE",function(){return yi}),n.d(e,"INVALID_FRAMEBUFFER_OPERATION",function(){return mi}),n.d(e,"IMPLEMENTATION_COLOR_READ_TYPE",function(){return bi}),n.d(e,"IMPLEMENTATION_COLOR_READ_FORMAT",function(){return Ri}),n.d(e,"UNPACK_FLIP_Y_WEBGL",function(){return Ni}),n.d(e,"UNPACK_PREMULTIPLY_ALPHA_WEBGL",function(){return Ii}),n.d(e,"CONTEXT_LOST_WEBGL",function(){return Mi}),n.d(e,"UNPACK_COLORSPACE_CONVERSION_WEBGL",function(){return Oi}),n.d(e,"BROWSER_DEFAULT_WEBGL",function(){return Pi}),n.d(e,"READ_BUFFER",function(){return Si}),n.d(e,"UNPACK_ROW_LENGTH",function(){return xi}),n.d(e,"UNPACK_SKIP_ROWS",function(){return wi}),n.d(e,"UNPACK_SKIP_PIXELS",function(){return Li}),n.d(e,"PACK_ROW_LENGTH",function(){return Fi}),n.d(e,"PACK_SKIP_ROWS",function(){return Ui}),n.d(e,"PACK_SKIP_PIXELS",function(){return Ci}),n.d(e,"COLOR",function(){return Di}),n.d(e,"DEPTH",function(){return Bi}),n.d(e,"STENCIL",function(){return Xi}),n.d(e,"RED",function(){return ji}),n.d(e,"RGB8",function(){return ki}),n.d(e,"RGBA8",function(){return Yi}),n.d(e,"RGB10_A2",function(){return Vi}),n.d(e,"TEXTURE_BINDING_3D",function(){return Hi}),n.d(e,"UNPACK_SKIP_IMAGES",function(){return Gi}),n.d(e,"UNPACK_IMAGE_HEIGHT",function(){return zi}),n.d(e,"TEXTURE_3D",function(){return Qi}),n.d(e,"TEXTURE_WRAP_R",function(){return Wi}),n.d(e,"MAX_3D_TEXTURE_SIZE",function(){return Ki}),n.d(e,"UNSIGNED_INT_2_10_10_10_REV",function(){return qi}),n.d(e,"MAX_ELEMENTS_VERTICES",function(){return Zi}),n.d(e,"MAX_ELEMENTS_INDICES",function(){return Ji}),n.d(e,"TEXTURE_MIN_LOD",function(){return $i}),n.d(e,"TEXTURE_MAX_LOD",function(){return to}),n.d(e,"TEXTURE_BASE_LEVEL",function(){return eo}),n.d(e,"TEXTURE_MAX_LEVEL",function(){return no}),n.d(e,"MIN",function(){return ro}),n.d(e,"MAX",function(){return io}),n.d(e,"DEPTH_COMPONENT24",function(){return oo}),n.d(e,"MAX_TEXTURE_LOD_BIAS",function(){return ao}),n.d(e,"TEXTURE_COMPARE_MODE",function(){return so}),n.d(e,"TEXTURE_COMPARE_FUNC",function(){return uo}),n.d(e,"CURRENT_QUERY",function(){return co}),n.d(e,"QUERY_RESULT",function(){return fo}),n.d(e,"QUERY_RESULT_AVAILABLE",function(){return lo}),n.d(e,"STREAM_READ",function(){return ho}),n.d(e,"STREAM_COPY",function(){return _o}),n.d(e,"STATIC_READ",function(){return po}),n.d(e,"STATIC_COPY",function(){return Eo}),n.d(e,"DYNAMIC_READ",function(){return go}),n.d(e,"DYNAMIC_COPY",function(){return vo}),n.d(e,"MAX_DRAW_BUFFERS",function(){return Ao}),n.d(e,"DRAW_BUFFER0",function(){return To}),n.d(e,"DRAW_BUFFER1",function(){return yo}),n.d(e,"DRAW_BUFFER2",function(){return mo}),n.d(e,"DRAW_BUFFER3",function(){return bo}),n.d(e,"DRAW_BUFFER4",function(){return Ro}),n.d(e,"DRAW_BUFFER5",function(){return No}),n.d(e,"DRAW_BUFFER6",function(){return Io}),n.d(e,"DRAW_BUFFER7",function(){return Mo}),n.d(e,"DRAW_BUFFER8",function(){return Oo}),n.d(e,"DRAW_BUFFER9",function(){return Po}),n.d(e,"DRAW_BUFFER10",function(){return So}),n.d(e,"DRAW_BUFFER11",function(){return xo}),n.d(e,"DRAW_BUFFER12",function(){return wo}),n.d(e,"DRAW_BUFFER13",function(){return Lo}),n.d(e,"DRAW_BUFFER14",function(){return Fo}),n.d(e,"DRAW_BUFFER15",function(){return Uo}),n.d(e,"MAX_FRAGMENT_UNIFORM_COMPONENTS",function(){return Co}),n.d(e,"MAX_VERTEX_UNIFORM_COMPONENTS",function(){return Do}),n.d(e,"SAMPLER_3D",function(){return Bo}),n.d(e,"SAMPLER_2D_SHADOW",function(){return Xo}),n.d(e,"FRAGMENT_SHADER_DERIVATIVE_HINT",function(){return jo}),n.d(e,"PIXEL_PACK_BUFFER",function(){return ko}),n.d(e,"PIXEL_UNPACK_BUFFER",function(){return Yo}),n.d(e,"PIXEL_PACK_BUFFER_BINDING",function(){return Vo}),n.d(e,"PIXEL_UNPACK_BUFFER_BINDING",function(){return Ho}),n.d(e,"FLOAT_MAT2x3",function(){return Go}),n.d(e,"FLOAT_MAT2x4",function(){return zo}),n.d(e,"FLOAT_MAT3x2",function(){return Qo}),n.d(e,"FLOAT_MAT3x4",function(){return Wo}),n.d(e,"FLOAT_MAT4x2",function(){return Ko}),n.d(e,"FLOAT_MAT4x3",function(){return qo}),n.d(e,"SRGB",function(){return Zo}),n.d(e,"SRGB8",function(){return Jo}),n.d(e,"SRGB8_ALPHA8",function(){return $o}),n.d(e,"COMPARE_REF_TO_TEXTURE",function(){return ta}),n.d(e,"RGBA32F",function(){return ea}),n.d(e,"RGB32F",function(){return na}),n.d(e,"RGBA16F",function(){return ra}),n.d(e,"RGB16F",function(){return ia}),n.d(e,"VERTEX_ATTRIB_ARRAY_INTEGER",function(){return oa}),n.d(e,"MAX_ARRAY_TEXTURE_LAYERS",function(){return aa}),n.d(e,"MIN_PROGRAM_TEXEL_OFFSET",function(){return sa}),n.d(e,"MAX_PROGRAM_TEXEL_OFFSET",function(){return ua}),n.d(e,"MAX_VARYING_COMPONENTS",function(){return ca}),n.d(e,"TEXTURE_2D_ARRAY",function(){return fa}),n.d(e,"TEXTURE_BINDING_2D_ARRAY",function(){return la}),n.d(e,"R11F_G11F_B10F",function(){return ha}),n.d(e,"UNSIGNED_INT_10F_11F_11F_REV",function(){return da}),n.d(e,"RGB9_E5",function(){return _a}),n.d(e,"UNSIGNED_INT_5_9_9_9_REV",function(){return pa}),n.d(e,"TRANSFORM_FEEDBACK_BUFFER_MODE",function(){return Ea}),n.d(e,"MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",function(){return ga}),n.d(e,"TRANSFORM_FEEDBACK_VARYINGS",function(){return va}),n.d(e,"TRANSFORM_FEEDBACK_BUFFER_START",function(){return Aa}),n.d(e,"TRANSFORM_FEEDBACK_BUFFER_SIZE",function(){return Ta}),n.d(e,"TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",function(){return ya}),n.d(e,"RASTERIZER_DISCARD",function(){return ma}),n.d(e,"MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",function(){return ba}),n.d(e,"MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",function(){return Ra}),n.d(e,"INTERLEAVED_ATTRIBS",function(){return Na}),n.d(e,"SEPARATE_ATTRIBS",function(){return Ia}),n.d(e,"TRANSFORM_FEEDBACK_BUFFER",function(){return Ma}),n.d(e,"TRANSFORM_FEEDBACK_BUFFER_BINDING",function(){return Oa}),n.d(e,"RGBA32UI",function(){return Pa}),n.d(e,"RGB32UI",function(){return Sa}),n.d(e,"RGBA16UI",function(){return xa}),n.d(e,"RGB16UI",function(){return wa}),n.d(e,"RGBA8UI",function(){return La}),n.d(e,"RGB8UI",function(){return Fa}),n.d(e,"RGBA32I",function(){return Ua}),n.d(e,"RGB32I",function(){return Ca}),n.d(e,"RGBA16I",function(){return Da}),n.d(e,"RGB16I",function(){return Ba}),n.d(e,"RGBA8I",function(){return Xa}),n.d(e,"RGB8I",function(){return ja}),n.d(e,"RED_INTEGER",function(){return ka}),n.d(e,"RGB_INTEGER",function(){return Ya}),n.d(e,"RGBA_INTEGER",function(){return Va}),n.d(e,"SAMPLER_2D_ARRAY",function(){return Ha}),n.d(e,"SAMPLER_2D_ARRAY_SHADOW",function(){return Ga}),n.d(e,"SAMPLER_CUBE_SHADOW",function(){return za}),n.d(e,"UNSIGNED_INT_VEC2",function(){return Qa}),n.d(e,"UNSIGNED_INT_VEC3",function(){return Wa}),n.d(e,"UNSIGNED_INT_VEC4",function(){return Ka}),n.d(e,"INT_SAMPLER_2D",function(){return qa}),n.d(e,"INT_SAMPLER_3D",function(){return Za}),n.d(e,"INT_SAMPLER_CUBE",function(){return Ja}),n.d(e,"INT_SAMPLER_2D_ARRAY",function(){return $a}),n.d(e,"UNSIGNED_INT_SAMPLER_2D",function(){return ts}),n.d(e,"UNSIGNED_INT_SAMPLER_3D",function(){return es}),n.d(e,"UNSIGNED_INT_SAMPLER_CUBE",function(){return ns}),n.d(e,"UNSIGNED_INT_SAMPLER_2D_ARRAY",function(){return rs}),n.d(e,"DEPTH_COMPONENT32F",function(){return is}),n.d(e,"DEPTH32F_STENCIL8",function(){return os}),n.d(e,"FLOAT_32_UNSIGNED_INT_24_8_REV",function(){return as}),n.d(e,"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",function(){return ss}),n.d(e,"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",function(){return us}),n.d(e,"FRAMEBUFFER_ATTACHMENT_RED_SIZE",function(){return cs}),n.d(e,"FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",function(){return fs}),n.d(e,"FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",function(){return ls}),n.d(e,"FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",function(){return hs}),n.d(e,"FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",function(){return ds}),n.d(e,"FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",function(){return _s}),n.d(e,"FRAMEBUFFER_DEFAULT",function(){return ps}),n.d(e,"UNSIGNED_INT_24_8",function(){return Es}),n.d(e,"DEPTH24_STENCIL8",function(){return gs}),n.d(e,"UNSIGNED_NORMALIZED",function(){return vs}),n.d(e,"DRAW_FRAMEBUFFER_BINDING",function(){return As}),n.d(e,"READ_FRAMEBUFFER",function(){return Ts}),n.d(e,"DRAW_FRAMEBUFFER",function(){return ys}),n.d(e,"READ_FRAMEBUFFER_BINDING",function(){return ms}),n.d(e,"RENDERBUFFER_SAMPLES",function(){return bs}),n.d(e,"FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",function(){return Rs}),n.d(e,"MAX_COLOR_ATTACHMENTS",function(){return Ns}),n.d(e,"COLOR_ATTACHMENT1",function(){return Is}),n.d(e,"COLOR_ATTACHMENT2",function(){return Ms}),n.d(e,"COLOR_ATTACHMENT3",function(){return Os}),n.d(e,"COLOR_ATTACHMENT4",function(){return Ps}),n.d(e,"COLOR_ATTACHMENT5",function(){return Ss}),n.d(e,"COLOR_ATTACHMENT6",function(){return xs}),n.d(e,"COLOR_ATTACHMENT7",function(){return ws}),n.d(e,"COLOR_ATTACHMENT8",function(){return Ls}),n.d(e,"COLOR_ATTACHMENT9",function(){return Fs}),n.d(e,"COLOR_ATTACHMENT10",function(){return Us}),n.d(e,"COLOR_ATTACHMENT11",function(){return Cs}),n.d(e,"COLOR_ATTACHMENT12",function(){return Ds}),n.d(e,"COLOR_ATTACHMENT13",function(){return Bs}),n.d(e,"COLOR_ATTACHMENT14",function(){return Xs}),n.d(e,"COLOR_ATTACHMENT15",function(){return js}),n.d(e,"FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",function(){return ks}),n.d(e,"MAX_SAMPLES",function(){return Ys}),n.d(e,"HALF_FLOAT",function(){return Vs}),n.d(e,"RG",function(){return Hs}),n.d(e,"RG_INTEGER",function(){return Gs}),n.d(e,"R8",function(){return zs}),n.d(e,"RG8",function(){return Qs}),n.d(e,"R16F",function(){return Ws}),n.d(e,"R32F",function(){return Ks}),n.d(e,"RG16F",function(){return qs}),n.d(e,"RG32F",function(){return Zs}),n.d(e,"R8I",function(){return Js}),n.d(e,"R8UI",function(){return $s}),n.d(e,"R16I",function(){return tu}),n.d(e,"R16UI",function(){return eu}),n.d(e,"R32I",function(){return nu}),n.d(e,"R32UI",function(){return ru}),n.d(e,"RG8I",function(){return iu}),n.d(e,"RG8UI",function(){return ou}),n.d(e,"RG16I",function(){return au}),n.d(e,"RG16UI",function(){return su}),n.d(e,"RG32I",function(){return uu}),n.d(e,"RG32UI",function(){return cu}),n.d(e,"VERTEX_ARRAY_BINDING",function(){return fu}),n.d(e,"R8_SNORM",function(){return lu}),n.d(e,"RG8_SNORM",function(){return hu}),n.d(e,"RGB8_SNORM",function(){return du}),n.d(e,"RGBA8_SNORM",function(){return _u}),n.d(e,"SIGNED_NORMALIZED",function(){return pu}),n.d(e,"COPY_READ_BUFFER",function(){return Eu}),n.d(e,"COPY_WRITE_BUFFER",function(){return gu}),n.d(e,"COPY_READ_BUFFER_BINDING",function(){return vu}),n.d(e,"COPY_WRITE_BUFFER_BINDING",function(){return Au}),n.d(e,"UNIFORM_BUFFER",function(){return Tu}),n.d(e,"UNIFORM_BUFFER_BINDING",function(){return yu}),n.d(e,"UNIFORM_BUFFER_START",function(){return mu}),n.d(e,"UNIFORM_BUFFER_SIZE",function(){return bu}),n.d(e,"MAX_VERTEX_UNIFORM_BLOCKS",function(){return Ru}),n.d(e,"MAX_FRAGMENT_UNIFORM_BLOCKS",function(){return Nu}),n.d(e,"MAX_COMBINED_UNIFORM_BLOCKS",function(){return Iu}),n.d(e,"MAX_UNIFORM_BUFFER_BINDINGS",function(){return Mu}),n.d(e,"MAX_UNIFORM_BLOCK_SIZE",function(){return Ou}),n.d(e,"MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",function(){return Pu}),n.d(e,"MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",function(){return Su}),n.d(e,"UNIFORM_BUFFER_OFFSET_ALIGNMENT",function(){return xu}),n.d(e,"ACTIVE_UNIFORM_BLOCKS",function(){return wu}),n.d(e,"UNIFORM_TYPE",function(){return Lu}),n.d(e,"UNIFORM_SIZE",function(){return Fu}),n.d(e,"UNIFORM_BLOCK_INDEX",function(){return Uu}),n.d(e,"UNIFORM_OFFSET",function(){return Cu}),n.d(e,"UNIFORM_ARRAY_STRIDE",function(){return Du}),n.d(e,"UNIFORM_MATRIX_STRIDE",function(){return Bu}),n.d(e,"UNIFORM_IS_ROW_MAJOR",function(){return Xu}),n.d(e,"UNIFORM_BLOCK_BINDING",function(){return ju}),n.d(e,"UNIFORM_BLOCK_DATA_SIZE",function(){return ku}),n.d(e,"UNIFORM_BLOCK_ACTIVE_UNIFORMS",function(){return Yu}),n.d(e,"UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",function(){return Vu}),n.d(e,"UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",function(){return Hu}),n.d(e,"UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",function(){return Gu}),n.d(e,"INVALID_INDEX",function(){return zu}),n.d(e,"MAX_VERTEX_OUTPUT_COMPONENTS",function(){return Qu}),n.d(e,"MAX_FRAGMENT_INPUT_COMPONENTS",function(){return Wu}),n.d(e,"MAX_SERVER_WAIT_TIMEOUT",function(){return Ku}),n.d(e,"OBJECT_TYPE",function(){return qu}),n.d(e,"SYNC_CONDITION",function(){return Zu}),n.d(e,"SYNC_STATUS",function(){return Ju}),n.d(e,"SYNC_FLAGS",function(){return $u}),n.d(e,"SYNC_FENCE",function(){return tc}),n.d(e,"SYNC_GPU_COMMANDS_COMPLETE",function(){return ec}),n.d(e,"UNSIGNALED",function(){return nc}),n.d(e,"SIGNALED",function(){return rc}),n.d(e,"ALREADY_SIGNALED",function(){return ic}),n.d(e,"TIMEOUT_EXPIRED",function(){return oc}),n.d(e,"CONDITION_SATISFIED",function(){return ac}),n.d(e,"WAIT_FAILED",function(){return sc}),n.d(e,"SYNC_FLUSH_COMMANDS_BIT",function(){return uc}),n.d(e,"TIMEOUT_IGNORED",function(){return cc}),n.d(e,"VERTEX_ATTRIB_ARRAY_DIVISOR",function(){return fc}),n.d(e,"ANY_SAMPLES_PASSED",function(){return lc}),n.d(e,"ANY_SAMPLES_PASSED_CONSERVATIVE",function(){return hc}),n.d(e,"SAMPLER_BINDING",function(){return dc}),n.d(e,"RGB10_A2UI",function(){return _c}),n.d(e,"INT_2_10_10_10_REV",function(){return pc}),n.d(e,"TRANSFORM_FEEDBACK",function(){return Ec}),n.d(e,"TRANSFORM_FEEDBACK_PAUSED",function(){return gc}),n.d(e,"TRANSFORM_FEEDBACK_ACTIVE",function(){return vc}),n.d(e,"TRANSFORM_FEEDBACK_BINDING",function(){return Ac}),n.d(e,"TEXTURE_IMMUTABLE_FORMAT",function(){return Tc}),n.d(e,"MAX_ELEMENT_INDEX",function(){return yc}),n.d(e,"TEXTURE_IMMUTABLE_LEVELS",function(){return mc}),n.d(e,"MAX_CLIENT_WAIT_TIMEOUT_WEBGL",function(){return bc});var r=256,i=1024,o=16384,a=0,s=1,u=2,c=3,f=4,l=5,h=6,d=0,_=1,p=768,E=769,g=770,v=771,A=772,T=773,y=774,m=775,b=776,R=32774,N=32777,I=32777,M=34877,O=32778,P=32779,S=32968,x=32969,w=32970,L=32971,F=32769,U=32770,C=32771,D=32772,B=32773,X=34962,j=34963,k=34964,Y=34965,V=35040,H=35044,G=35048,z=34660,Q=34661,W=34342,K=1028,q=1029,Z=1032,J=2884,$=3042,tt=3024,et=2960,nt=2929,rt=3089,it=32823,ot=32926,at=32928,st=0,ut=1280,ct=1281,ft=1282,lt=1285,ht=2304,dt=2305,_t=2849,pt=33901,Et=33902,gt=2885,vt=2886,At=2928,Tt=2930,yt=2931,mt=2932,bt=2961,Rt=2962,Nt=2964,It=2965,Mt=2966,Ot=2967,Pt=2963,St=2968,xt=34816,wt=34817,Lt=34818,Ft=34819,Ut=36003,Ct=36004,Dt=36005,Bt=2978,Xt=3088,jt=3106,kt=3107,Yt=3317,Vt=3333,Ht=3379,Gt=3386,zt=3408,Qt=3410,Wt=3411,Kt=3412,qt=3413,Zt=3414,Jt=3415,$t=10752,te=32824,ee=32873,ne=32936,re=32937,ie=32938,oe=32939,ae=34467,se=4352,ue=4353,ce=4354,fe=33170,le=5120,he=5121,de=5122,_e=5123,pe=5124,Ee=5125,ge=5126,ve=6402,Ae=6406,Te=6407,ye=6408,me=6409,be=6410,Re=32819,Ne=32820,Ie=33635,Me=35632,Oe=35633,Pe=34921,Se=36347,xe=36348,we=35661,Le=35660,Fe=34930,Ue=36349,Ce=35663,De=35712,Be=35714,Xe=35715,je=35717,ke=35718,Ye=35721,Ve=35724,He=35725,Ge=512,ze=513,Qe=514,We=515,Ke=516,qe=517,Ze=518,Je=519,$e=7680,tn=7681,en=7682,nn=7683,rn=5386,on=34055,an=34056,sn=7936,un=7937,cn=7938,fn=9728,ln=9729,hn=9984,dn=9985,_n=9986,pn=9987,En=10240,gn=10241,vn=10242,An=10243,Tn=3553,yn=5890,mn=34067,bn=34068,Rn=34069,Nn=34070,In=34071,Mn=34072,On=34073,Pn=34074,Sn=34076,xn=33984,wn=33985,Ln=33986,Fn=33987,Un=33988,Cn=33989,Dn=33990,Bn=33991,Xn=33992,jn=33993,kn=33994,Yn=33995,Vn=33996,Hn=33997,Gn=33998,zn=33999,Qn=34e3,Wn=34001,Kn=34002,qn=34003,Zn=34004,Jn=34005,$n=34006,tr=34007,er=34008,nr=34009,rr=34010,ir=34011,or=34012,ar=34013,sr=34014,ur=34015,cr=34016,fr=10497,lr=33071,hr=33648,dr=35664,_r=35665,pr=35666,Er=35667,gr=35668,vr=35669,Ar=35670,Tr=35671,yr=35672,mr=35673,br=35674,Rr=35675,Nr=35676,Ir=35678,Mr=35680,Or=34338,Pr=34339,Sr=34340,xr=34341,wr=34922,Lr=34373,Fr=34975,Ur=35713,Cr=36336,Dr=36337,Br=36338,Xr=36339,jr=36340,kr=36341,Yr=36160,Vr=36161,Hr=32854,Gr=32855,zr=36194,Qr=33189,Wr=36168,Kr=34041,qr=36162,Zr=36163,Jr=36164,$r=36176,ti=36177,ei=36178,ni=36179,ri=36180,ii=36181,oi=36048,ai=36049,si=36050,ui=36051,ci=36064,fi=36096,li=36128,hi=33306,di=0,_i=36053,pi=36054,Ei=36055,gi=36057,vi=36061,Ai=36006,Ti=36007,yi=34024,mi=1286,bi=35738,Ri=35739,Ni=37440,Ii=37441,Mi=37442,Oi=37443,Pi=37444,Si=3074,xi=3314,wi=3315,Li=3316,Fi=3330,Ui=3331,Ci=3332,Di=6144,Bi=6145,Xi=6146,ji=6403,ki=32849,Yi=32856,Vi=32857,Hi=32874,Gi=32877,zi=32878,Qi=32879,Wi=32882,Ki=32883,qi=33640,Zi=33e3,Ji=33001,$i=33082,to=33083,eo=33084,no=33085,ro=32775,io=32776,oo=33190,ao=34045,so=34892,uo=34893,co=34917,fo=34918,lo=34919,ho=35041,_o=35042,po=35045,Eo=35046,go=35049,vo=35050,Ao=34852,To=34853,yo=34854,mo=34855,bo=34856,Ro=34857,No=34858,Io=34859,Mo=34860,Oo=34861,Po=34862,So=34863,xo=34864,wo=34865,Lo=34866,Fo=34867,Uo=34868,Co=35657,Do=35658,Bo=35679,Xo=35682,jo=35723,ko=35051,Yo=35052,Vo=35053,Ho=35055,Go=35685,zo=35686,Qo=35687,Wo=35688,Ko=35689,qo=35690,Zo=35904,Jo=35905,$o=35907,ta=34894,ea=34836,na=34837,ra=34842,ia=34843,oa=35069,aa=35071,sa=35076,ua=35077,ca=35659,fa=35866,la=35869,ha=35898,da=35899,_a=35901,pa=35902,Ea=35967,ga=35968,va=35971,Aa=35972,Ta=35973,ya=35976,ma=35977,ba=35978,Ra=35979,Na=35980,Ia=35981,Ma=35982,Oa=35983,Pa=36208,Sa=36209,xa=36214,wa=36215,La=36220,Fa=36221,Ua=36226,Ca=36227,Da=36232,Ba=36233,Xa=36238,ja=36239,ka=36244,Ya=36248,Va=36249,Ha=36289,Ga=36292,za=36293,Qa=36294,Wa=36295,Ka=36296,qa=36298,Za=36299,Ja=36300,$a=36303,ts=36306,es=36307,ns=36308,rs=36311,is=36012,os=36013,as=36269,ss=33296,us=33297,cs=33298,fs=33299,ls=33300,hs=33301,ds=33302,_s=33303,ps=33304,Es=34042,gs=35056,vs=35863,As=36006,Ts=36008,ys=36009,ms=36010,bs=36011,Rs=36052,Ns=36063,Is=36065,Ms=36066,Os=36067,Ps=36068,Ss=36069,xs=36070,ws=36071,Ls=36072,Fs=36073,Us=36074,Cs=36075,Ds=36076,Bs=36077,Xs=36078,js=36079,ks=36182,Ys=36183,Vs=5131,Hs=33319,Gs=33320,zs=33321,Qs=33323,Ws=33325,Ks=33326,qs=33327,Zs=33328,Js=33329,$s=33330,tu=33331,eu=33332,nu=33333,ru=33334,iu=33335,ou=33336,au=33337,su=33338,uu=33339,cu=33340,fu=34229,lu=36756,hu=36757,du=36758,_u=36759,pu=36764,Eu=36662,gu=36663,vu=36662,Au=36663,Tu=35345,yu=35368,mu=35369,bu=35370,Ru=35371,Nu=35373,Iu=35374,Mu=35375,Ou=35376,Pu=35377,Su=35379,xu=35380,wu=35382,Lu=35383,Fu=35384,Uu=35386,Cu=35387,Du=35388,Bu=35389,Xu=35390,ju=35391,ku=35392,Yu=35394,Vu=35395,Hu=35396,Gu=35398,zu=4294967295,Qu=37154,Wu=37157,Ku=37137,qu=37138,Zu=37139,Ju=37140,$u=37141,tc=37142,ec=37143,nc=37144,rc=37145,ic=37146,oc=37147,ac=37148,sc=37149,uc=1,cc=-1,fc=35070,lc=35887,hc=36202,dc=35097,_c=36975,pc=36255,Ec=36386,gc=36387,vc=36388,Ac=36389,Tc=37167,yc=36203,mc=33503,bc=37447},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e="string"===typeof t?[t]:t.raw,n="",r=0;r<e.length;r++)if(n+=e[r].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),r<(arguments.length<=1?0:arguments.length-1)){var i=String(arguments.length<=r+1?void 0:arguments[r+1]);if(i.includes("\n")){var o=n.match(/(?:^|\n)([ \t]*).*$/);o&&"string"===typeof i?function(){var t=o[1];n+=i.split("\n").map(function(e,n){return 0===n?e:""+t+e}).join("\n")}():n+=i}else n+=arguments.length<=r+1?void 0:arguments[r+1]}var a=n.split("\n"),s=null;if(a.forEach(function(t,e){if(e){var n=t.match(/^(\s*)\S+/);if(n){var r=n[1].length;s=null==s?r:Math.min(s,r)}}}),null!==s){var u=s;n=a.map(function(t){return" "===t[0]?t.slice(u):t}).join("\n")}return n.trim().replace(/\\n/g,"\n")}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});const r=1e-6;e.b=r;let i="undefined"!==typeof Float32Array?Float32Array:Array;const o=Math.random;e.c=o;Math.PI},function(t,e,n){"use strict";var r,i;n.d(e,"a",function(){return o});var o=(i=r=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,n&&(this.name=n),this.instanceId=++t.InstanceCounter},r.InstanceCounter=0,i)},function(t,e,n){var r=n(51)("wks"),i=n(52),o=n(8).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(14),o=n(2),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.a.default;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.length=0,this.type=n,this.size=e;var r=0;for(var o in n.elements)r+=n.elements[o].stride*e;for(var a in this.array=new ArrayBuffer(r),this.views={},r=0,n.elements){var s=n.elements[a],u=s.view,c=s.stride;this.views[a]=new u(this.array,r,e*c/u.BYTES_PER_ELEMENT),r+=c*e}}return a(t,[{key:"set",value:function(t,e){var n=this;if(!e.POSITION)throw new Error("every vertex must have POSITION attribute");this.box?r.a.combineVec3(this.box,this.box,e.POSITION):(this.box=r.a.create(),r.a.setVec3(this.box,e.POSITION));var i=function(r){if(!n.type.elements[r])throw new Error("attribute "+r+" not in vertex declaration");var i,a=n.type.elements[r],s=a.view,u=a.stride,c=a.normalized,f=a.type;if(!c||![o.UNSIGNED_BYTE,o.UNSIGNED_SHORT,o.BYTE,o.SHORT].includes(f)||((i=e[r])instanceof Uint8Array||i instanceof Uint16Array||i instanceof Uint32Array||i instanceof Int8Array||i instanceof Int16Array||i instanceof Int32Array))n.views[r].set(e[r],t*u/s.BYTES_PER_ELEMENT);else{var l=t*u/s.BYTES_PER_ELEMENT;f===o.UNSIGNED_BYTE?e[r].forEach(function(t){return n.views[r][l++]=255*t+.5}):f===o.UNSIGNED_SHORT?e[r].forEach(function(t){return n.views[r][l++]=65535*t+.5}):f===o.BYTE?e[r].forEach(function(t){return n.views[r][l++]=Math.floor(255*t/2)}):f===o.SHORT&&e[r].forEach(function(t){return n.views[r][l++]=Math.floor(65535*t/2)})}};for(var a in e)i(a);return t}},{key:"add",value:function(t){return this.set(this.length++,t)}},{key:"get",value:function(t){var e={};for(var n in this.type.elements){var r=this.type.elements[n],i=r.size,o=r.view,a=t*r.stride/o.BYTES_PER_ELEMENT;e[n]=this.views[n].subarray(a,a+i)}return e}},{key:"buildAttributes",value:function(t){var e={},n=t.createBuffer();for(var r in t.bindBuffer(o.ARRAY_BUFFER,n),t.bufferData(o.ARRAY_BUFFER,this.array,o.STATIC_DRAW),this.type.elements){var i=this.type.elements[r],a=i.size,s=i.type,u=i.normalized,c=i.stride;e[r]={buffer:n,size:a,type:s,normalized:u,stride:c,offset:this.views[r].byteOffset}}return e}},{key:"build",value:function(t,e){var n=t.gl,r=this.buildAttributes(n),i=this.size;if(e){Array.isArray(e)&&(e=this.size>=65536?new Uint32Array(e):new Uint16Array(e));var a=void 0;if(e instanceof Uint8Array)a=o.UNSIGNED_BYTE;else if(e instanceof Uint16Array)a=o.UNSIGNED_SHORT;else{if(!(e instanceof Uint32Array))throw new Error("invalid index type");a=o.UNSIGNED_INT}i=e.length;var s=n.createBuffer();n.bindBuffer(o.ELEMENT_ARRAY_BUFFER,s),n.bufferData(o.ELEMENT_ARRAY_BUFFER,e,o.STATIC_DRAW),e={buffer:s,type:a}}return new t.Primitive(r,e,i,this.box)}}]),t}()},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";e.a=function(t,e,n,c){var f,l,h,d,_,p,E,g,v,A,T,y,m,b,R,N,I,M,O,P,S,x,w,L,F,U,C,D,B,X;r.g.subtract(i,e,t),r.g.subtract(o,c,n),r.g.subtract(a,t,n),f=r.g.dot(i,i),l=r.g.dot(i,o),h=r.g.dot(o,o),d=r.g.dot(i,a),_=r.g.dot(o,a),g=(p=d)-l,v=(E=p+f)-l,y=(A=-_)+h,m=(T=A-l)+h,f>1e-6&&h>1e-6?(N=u(f,p,E),I=u(f,g,v),M=N<1e-6?-1:N>1-1e-6?1:0,O=I<1e-6?-1:I>1-1e-6?1:0,-1==M&&-1==O?(b=0,R=u(h,A,y)):1==M&&1==O?(b=1,R=u(h,T,m)):(M<0?(P=0,x=0,((w=p/l)<0||w>1)&&(w=.5)):0==M?(P=2,x=N,w=0):(P=1,x=1,((w=E/l)<0||w>1)&&(w=.5)),O<0?(S=0,L=0,((F=p/l)<0||F>1)&&(F=.5)):0==O?(S=3,L=I,F=1):(S=1,L=1,((F=E/l)<0||F>1)&&(F=.5)),(C=(U=F-w)*(h*w-l*x-_))>-1e-6?0==P?(b=0,R=u(h,A,y)):1==P?(b=1,R=u(h,T,m)):(b=x,R=w):(D=U*(h*F-l*L-_))<1e-6?0==S?(b=0,R=u(h,A,y)):1==S?(b=1,R=u(h,T,m)):(b=L,R=F):(B=Math.min(Math.max(C/(C-D),0),1),b=(X=1-B)*x+B*L,R=X*w+B*F))):f>1e-6?(b=u(f,p,E),R=0):h>1e-6?(b=0,R=u(h,A,y)):(b=0,R=0);return r.g.lerp(s[0],t,e,b),r.g.lerp(s[1],n,c,R),s[2]=b,s[3]=R,s};var r=n(0),i=r.g.create(),o=r.g.create(),a=r.g.create(),s=[r.g.create(),r.g.create()];function u(t,e,n){if(e>-1e-6)return 0;if(n<1e-6)return 1;var r=-e/t;return r>1&&(r=.5),r}},function(t,e){t.exports={}},function(t,e){var n=t.exports={version:"2.5.6"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(27),i=n(50);t.exports=n(16)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){"use strict";var r=n(0),i=n(1),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.material=o({},i.a.defaultMaterial),this.aabb=r.a.create()}return a(t,[{key:"update",value:function(){}},{key:"getInfo",value:function(t,e){return r.g.set(t,0,0,0),r.d.zero(e),0}},{key:"intersect",value:function(){return!1}},{key:"type",get:function(){return this.constructor.type}}]),t}();e.a=s},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r,i,o,a=n(96),s=(n.n(a),n(2)),u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){var e=t.match(/^([a-zA-Z]+)(?:_\d+)?$/);if(!e)throw new Error("invalid attribute semantic "+t);switch(e[1]){case"POSITION":case"NORMAL":return 3;case"TANGENT":return 4;case"TEXCOORD":return 2;case"COLOR":return 3;case"JOINTS":case"WEIGHTS":return 4;default:throw new Error("invalid attribute semantic "+t)}}var l=(i=r=function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elements={},e){var r="object"===u(e[n])?e[n]:{type:e[n]},i=r.type,o=r.size,a=void 0===o?f(n):o,s=r.normalized,c=void 0===s||s,l=this.constructor.views[i];if(!l)throw new Error("invalid component type "+i);var h=4*Math.ceil(l.BYTES_PER_ELEMENT*a/4);this.elements[n]={type:i,size:a,normalized:c,view:l,stride:h}}},r.views=(c(o={},s.BYTE,Int8Array),c(o,s.SHORT,Int16Array),c(o,s.UNSIGNED_BYTE,Uint8Array),c(o,s.UNSIGNED_SHORT,Uint16Array),c(o,s.FLOAT,Float32Array),c(o,s.HALF_FLOAT,a.Float16Array),o),i);l.default=new l({POSITION:s.FLOAT,NORMAL:s.HALF_FLOAT,TEXCOORD_0:s.HALF_FLOAT})},function(t,e,n){var r=n(28);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(48)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(62)(Object,"create");t.exports=r},function(t,e,n){var r=n(156);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(162);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"===typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=n(23);n.d(e,"a",function(){return r.e}),n.d(e,"b",function(){return r.f}),r.e.makeBasis=function(t,e,n){var r=t[0],i=t[1],o=t[2];if(Math.abs(r)>Math.abs(i)){var a=1/Math.sqrt(r*r+o*o);n[0]=-o*a,n[1]=0,n[2]=r*a,e[0]=-i*n[2],e[1]=r*n[2]-o*n[0],e[2]=i*n[0]}else{var s=1/Math.sqrt(i*i+o*o);n[0]=0,n[1]=o*s,n[2]=-i*s,e[0]=o*n[1]-i*n[2],e[1]=r*n[2],e[2]=-r*n[1]}},r.e.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i);if(a<1e-6)return t[0]=0,t[1]=0,t[2]=0,t;var s=2*Math.atan2(a,o)/a;return t[0]=s*n,t[1]=s*r,t[2]=s*i,t},r.e.inverseMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[1]*i+n[2]*o,t[1]=n[3]*r+n[4]*i+n[5]*o,t[2]=n[6]*r+n[7]*i+n[8]*o,t},r.e.inverseMat4=function(t,e,n){var r=e[0]-n[12],i=e[1]-n[13],o=e[2]-n[14];return t[0]=n[0]*r+n[1]*i+n[2]*o,t[1]=n[4]*r+n[5]*i+n[6]*o,t[2]=n[8]*r+n[9]*i+n[10]*o,t},r.e.rotateMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[4]*i+n[8]*o,t[1]=n[1]*r+n[5]*i+n[9]*o,t[2]=n[2]*r+n[6]*i+n[10]*o,t},r.e.invRotateMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[1]*i+n[2]*o,t[1]=n[4]*r+n[5]*i+n[6]*o,t[2]=n[8]*r+n[9]*i+n[10]*o,t},r.e.quadMat3=function(t,e){var n=t[0],r=t[1],i=t[2];return n*(n*e[0]+r*e[3]+i*e[6])+r*(n*e[1]+r*e[4]+i*e[7])+i*(n*e[2]+r*e[5]+i*e[8])},r.e.eulerFromMat3=function(t,e){if(e[2]<1){if(e[2]>-1)return t[0]=Math.atan2(-e[5],e[8]),t[1]=Math.asin(e[2]),t[2]=Math.atan2(-e[1],e[0]),!0;t[0]=-Math.atan2(e[3],e[4]),t[1]=.5*-Math.PI,t[2]=0}else t[0]=Math.atan2(e[3],e[4]),t[1]=.5*Math.PI,t[2]=0},r.e.posX=r.e.fromValues(1,0,0),r.e.posY=r.e.fromValues(0,1,0),r.e.posZ=r.e.fromValues(0,0,1),r.e.negX=r.e.fromValues(-1,0,0),r.e.negY=r.e.fromValues(0,-1,0),r.e.negZ=r.e.fromValues(0,0,-1)},function(t,e,n){"use strict";n(4);var r=n(86),i=(n(87),n(39)),o=n(40),a=n(41),s=(n(88),n(89),n(42)),u=n(43);n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"d",function(){return a}),n.d(e,"e",function(){return s}),n.d(e,"f",function(){return u})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.roundToFloat16Bits=function(t){i[0]=t;const e=o[0],n=e>>23&511;return a[n]+((8388607&e)>>s[n])},e.convertToNumber=function(t){const e=t>>10;return o[0]=u[f[e]+(1023&t)]+c[e],i[0]};const r=new ArrayBuffer(4),i=new Float32Array(r),o=new Uint32Array(r),a=new Uint32Array(512),s=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(a[0|t]=0,a[256|t]=32768,s[0|t]=24,s[256|t]=24):e<-14?(a[0|t]=1024>>-e-14,a[256|t]=1024>>-e-14|32768,s[0|t]=-e-1,s[256|t]=-e-1):e<=15?(a[0|t]=e+15<<10,a[256|t]=e+15<<10|32768,s[0|t]=13,s[256|t]=13):e<128?(a[0|t]=31744,a[256|t]=64512,s[0|t]=24,s[256|t]=24):(a[0|t]=31744,a[256|t]=64512,s[0|t]=13,s[256|t]=13)}const u=new Uint32Array(2048),c=new Uint32Array(64),f=new Uint32Array(64);u[0]=0;for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;0===(8388608&e);)n-=8388608,e<<=1;e&=-8388609,n+=947912704,u[t]=e|n}for(let t=1024;t<2048;++t)u[t]=939524096+(t-1024<<13);c[0]=0;for(let t=1;t<31;++t)c[t]=t<<23;c[31]=1199570944,c[32]=2147483648;for(let t=33;t<63;++t)c[t]=2147483648+(t-32<<23);c[63]=3347054592,f[0]=0;for(let t=1;t<64;++t)f[t]=32===t?0:1024},function(t,e,n){var r=n(105),i=n(26);t.exports=function(t){return r(i(t))}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(15),i=n(109),o=n(110),a=Object.defineProperty;e.f=n(16)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(51)("keys"),i=n(52);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){var r=n(61),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(2),i=n(5),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=function(t){function e(t,n,i,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),u=t.gl;return s.buffer=u.createRenderbuffer(),u.bindRenderbuffer(r.RENDERBUFFER,s.buffer),a>1?u.renderbufferStorageMultisample(r.RENDERBUFFER,a,o,n,i):u.renderbufferStorage(r.RENDERBUFFER,o,n,i),u.bindRenderbuffer(r.RENDERBUFFER,null),s.format=o,s}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["a"]),o(e,[{key:"destroy",value:function(){this.renderer.gl.deleteRenderbuffer(this.buffer)}}]),e}()},function(t,e,n){"use strict";e.a=function(t,e){var n,u,c=function t(e){var n=0,r=0;var i=e.map(function(e){var i=s(e,3),o=i[0],u=i[1],c=i[2],h=void 0;if("string"===typeof o&&(h=o.match(/([biud]?)mat([234])(?:x([234]))?/))){var d=parseInt(h[2]),_=h[3]?parseInt(h[3]):d;o=h[1]+"vec"+_,c=(null!=c?c:1)*d}if(o in f){var p=s(f[o],3),E=p[0],g=p[1],v=p[2];null!=c&&(g=l(g,16),E=l(E,g)*c);var A=l(n,g);return r=Math.max(g,r),n=A+E,function(t,e,n){return Object.defineProperty(e,u,a({},v(t,n+A,c),{enumerable:!0}))}}if(Array.isArray(o)){var T=t(o),y=s(T,3),m=y[0],b=y[1],R=y[2];b=l(b,16),m=l(m,b);var N=l(n,b);return r=Math.max(b,r),n=N+m*(null==c?1:c),null==c?function(t,e,n){return e[u]=R(t,{},n+N)}:function(t,e,n){for(var r=e[u]=new Array(c),i=0;i<c;++i)r[i]=R(t,{},n+N+m*i)}}throw"Unknown uniform type "+o});return[n,r,function(t,e,n){return i.forEach(function(r){return r(t,e,n)}),e}]}(e),h=s(c,3),d=h[0],_=h[2],p=Symbol("buffer"),E=Symbol("data"),g=Symbol("dirty");return u=n=function(e){function n(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e||t,i)),a=o.renderer.gl;return o[p]=a.createBuffer(),o[E]=new ArrayBuffer(d),a.bindBufferBase(r.UNIFORM_BUFFER,0,o[p]),a.bufferData(r.UNIFORM_BUFFER,d,r.DYNAMIC_DRAW),_({array:o[E],view:new DataView(o[E]),invalidate:function(){return o[g]=!0}},o,0),o}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),o(n,[{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.renderer.gl;return e.bindBufferBase(r.UNIFORM_BUFFER,t,this[p]),this[g]&&(e.bufferSubData(r.UNIFORM_BUFFER,0,this[E]),this[g]=!1),this}},{key:"destroy",value:function(){this.renderer.gl.deleteBuffer(this[p])}}]),n}(i.a),n.declaration=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"{\n"+e.map(function(e){var r=s(e,3),i=r[0],o=r[1],a=r[2];return a=null!=a?"["+a+"]":"",Array.isArray(i)&&(i="struct "+t(i,n+"  ")),n+"  "+i+" "+o+a+";\n"}).join("")+n+"}"}(e),u};var r=n(2),i=n(5),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function u(t,e){return function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return{get:function(){return n.invalidate(),new window[t](n.array,r,i*e)},set:function(o){n.invalidate(),new window[t](n.array,r,i*e).set(o)}}}}function c(t){return function(e,n,r){return null!=r?u(t+"Array",r)(e,n):{get:function(){return e.view["get"+t](n,!0)},set:function(r){e.invalidate(),e.view["set"+t](n,r,!0)}}}}var f={bool:[4,4,function(t,e,n){return null!=n?u("Uint32Array",n)(t,e):{get:function(){return 0!=t.view.getUint32(e,!0)},set:function(n){t.invalidate(),t.view.setUint32(e,n?1:0,!0)}}}],int:[4,4,c("Int32")],uint:[4,4,c("Uint32")],float:[4,4,c("Float32")],double:[8,8,c("Float64")],bvec2:[8,8,u("Uint32Array",2)],bvec3:[12,16,u("Uint32Array",3)],bvec4:[16,16,u("Uint32Array",4)],ivec2:[8,8,u("Int32Array",2)],ivec3:[12,16,u("Int32Array",3)],ivec4:[16,16,u("Int32Array",4)],uvec2:[8,8,u("Uint32Array",2)],uvec3:[12,16,u("Uint32Array",3)],uvec4:[16,16,u("Uint32Array",4)],vec2:[8,8,u("Float32Array",2)],vec3:[12,16,u("Float32Array",3)],vec4:[16,16,u("Float32Array",4)],dvec2:[16,16,u("Float64Array",2)],dvec3:[24,32,u("Float64Array",3)],dvec4:[32,32,u("Float64Array",4)]};function l(t,e){var n=t%e;return t+(n?e-n:0)}},function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r=n(3),i=n.n(r),o=n(210),a=n.n(o),s=n(2),u=n(5),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=h(["\n      ","\n      ","\n    "],["\n      ","\n      ","\n    "]),l=h(["\n      ","\n      #ifdef GL_FRAGMENT_PRECISION_HIGH\n      #define PRECISION highp\n      #else\n      #define PRECISION mediump\n      #endif\n      precision PRECISION float;\n      ","\n    "],["\n      ","\n      #ifdef GL_FRAGMENT_PRECISION_HIGH\n      #define PRECISION highp\n      #else\n      #define PRECISION mediump\n      #endif\n      precision PRECISION float;\n      ","\n    "]);function h(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var d=function(t){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.uniformCache={},a.samplers={},a.samplerUnits=[],a.uboCache={},a.uboUnits=0;var u=o.version,c=void 0===u?300:u,h=o.defines,d=void 0===h?{}:h,_=o.fragments,p=void 0===_?{}:_,E="#version "+c+" es";for(var g in d)E+="\n#define "+g+" "+d[g];n=n.replace(/\${(.*?)}/g,function(t,e){return p[e]}),r=r.replace(/\${(.*?)}/g,function(t,e){return p[e]}),a.vertSource=i()(f,E,n),a.fragSource=i()(l,E,r);var v=t.gl;if(a.program=v.createProgram(),a.vertex=a.compileShader(s.VERTEX_SHADER,a.vertSource),a.fragment=a.compileShader(s.FRAGMENT_SHADER,a.fragSource),v.attachShader(a.program,a.vertex),v.attachShader(a.program,a.fragment),v.linkProgram(a.program),!v.getProgramParameter(a.program,s.LINK_STATUS))throw new Error("*** Error linking program: "+v.getProgramInfoLog(a.program));return a}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u["a"]),c(e,[{key:"destroy",value:function(){this.renderer.gl.deleteProgram(this.program),this.renderer.gl.deleteShader(this.vertex),this.renderer.gl.deleteShader(this.fragment)}},{key:"compileShader",value:function(t,e){var n=this.renderer.gl,r=n.createShader(t);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,s.COMPILE_STATUS)){var i=n.getShaderInfoLog(r),o=a()(i,e,t);throw console.warn(o.long),new Error(o.short)}return r}},{key:"use",value:function(){return this.renderer.activeProgram!==this&&(this.renderer.activeProgram=this,this.renderer.gl.useProgram(this.program)),this}},{key:"uniformLocation",value:function(t){var e=void 0;return this.uniformCache.hasOwnProperty(t)?e=this.uniformCache[t]:(e=this.uniformCache[t]=this.renderer.gl.getUniformLocation(this.program,t))||console.warn("undefined uniform "+t),e}},{key:"sampler",value:function(t,e){var n=this.samplers[t];return null==n&&(n=this.samplers[t]=this.samplerUnits.length,this.int(t,n)),e&&e.bind(n),this.samplerUnits[n]=e,this}},{key:"uniforms",value:function(t,e,n){var r=this.uboCache[t];if(null==r){r=this.uboCache[t]=this.uboUnits++;var i=this.renderer.gl.getUniformBlockIndex(this.program,t);i===s.INVALID_INDEX&&console.warn("undefined uniform block "+t),this.renderer.gl.uniformBlockBinding(this.program,i,r)}return this.use(),e.bind(r,n),this}},{key:"int",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform1i(n,e),this}},{key:"int2",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform2iv(n,e),this}},{key:"int3",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform3iv(n,e),this}},{key:"int4",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform4iv(n,e),this}},{key:"float",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform1f(n,e),this}},{key:"vec2",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform2fv(n,e),this}},{key:"vec3",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform3fv(n,e),this}},{key:"vec4",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniform4fv(n,e),this}},{key:"mat2",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniformMatrix2fv(n,!1,e),this}},{key:"mat3",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniformMatrix3fv(n,!1,e),this}},{key:"mat4",value:function(t,e){var n=this.uniformLocation(t);return this.use(),n&&this.renderer.gl.uniformMatrix4fv(n,!1,e),this}},{key:"render",value:function(t){this.use(),this.samplerUnits.forEach(function(t,e){return t&&t.bind(e)}),t.vertexArray.bind(),t.render(),this.renderer.gl.bindVertexArray(null)}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return _});var r=n(3),i=n.n(r),o=n(74),a=(n(34),Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=h(["\n                ","\n                ","\n                uniform LightBlock "," u_Light;\n                ","\n                out float v_Depth;\n              "],["\n                ","\n                ","\n                uniform LightBlock "," u_Light;\n                ","\n                out float v_Depth;\n              "]),c=h(["\n                LightInfo light;\n                ","(posW, light);\n                gl_Position = light.shadow;\n                v_Depth = light.distance;\n              "],["\n                LightInfo light;\n                ","(posW, light);\n                gl_Position = light.shadow;\n                v_Depth = light.distance;\n              "]),f=h(["\n          precision PRECISION ",";\n          uniform "," u_ShadowMap;\n        "],["\n          precision PRECISION ",";\n          uniform "," u_ShadowMap;\n        "]),l=h(["\n        ","\n        float getShadow(in LightInfo light) ","\n      "],["\n        ","\n        float getShadow(in LightInfo light) ","\n      "]);function h(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _=function(){function t(e){d(this,t),this.renderer=e}return s(t,[{key:"getShadowmapShader",value:function(t){var e=this;return this.renderer.cache("shadowmap_shader_"+e.type+"_"+t.type,function(){var n,r;return r=n=function(n){function r(n,o){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d(this,r),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,n,o,e.shadowmapFrag,{defines:a({},s,{RENDER_SHADOWMAP:1}),filter:function(t){return t.match(/POSITION|JOINTS|WEIGHTS/)},fragments:{declarations:i()(u,t.constructor.lightInfo,t.constructor.arraySize?"uniform int u_ShadowMapIndex;":"",t.constructor.declaration,t.shaderCode),output_func:i()(c,t.shaderFunc)}}))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o["a"]),r}(),n.shaderName="Shadowmap_"+e.type+"_"+t.type,n.useMaterials=!1,r})}},{key:"getLightShader",value:function(t){var e=this;return this.renderer.cache("render_shader_"+this.type+"_"+t.type,function(){var n=t.constructor.arraySize?e.constructor.shadowmapTypeArray:e.constructor.shadowmapType,r="";return n&&(r=i()(f,n,n)),e.renderer.lightPassShader(t,e,i()(l,r,e.shadowFunc))})}},{key:"type",get:function(){return this.constructor.name}}]),t}()},function(t,e,n){"use strict";e.a=function(){for(var t,e,n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"renderShadowmap",value:function(t,e){var n=this,r=this.shadow||this.renderer.noShadow;if(!(e=(e=this.prepare(t,e,{zNear:t.near,zFar:t.far,resolution:r.resolution,padding:r.padding})).filter(function(t){var e=t.primitive;return!(e.noShadow||e.noShadowFor&&e.noShadowFor.indexOf(n)>=0)})).length||!r.renderMap)return null;var i=r.getShadowmapShader(this);return this.constructor.arraySize?r.renderMapArray(function(t){e.render(i,function(e){e.int("u_ShadowMapIndex",t),e.uniforms("LightBlock",n)})},this.constructor.arraySize):r.renderMap(function(){e.render(i,function(t){t.uniforms("LightBlock",n)})})}},{key:"render",value:function(t,e){var n=this.renderShadowmap(t,e),r=n&&this.shadow||this.renderer.noShadow,i=r.getLightShader(this);this.renderer.updateLightShader(i),i.vec4("u_InvProj",t.inverseProj()),i.mat4("u_InverseViewMatrix",t.world),i.sampler("u_ShadowMap",n),i.uniforms("LightBlock",this),i.render(this.renderer.quad)}},{key:"type",get:function(){return this.constructor.type}},{key:"shaderFunc",get:function(){return this.type+"_Func"}},{key:"shaderCode",get:function(){return i()(u,this.shaderFunc,this.constructor.shaderFunc)}}]),e}(Object(o.a)(null,r)),t.lightInfo=i()(c),e};var r=n(3),i=n.n(r),o=n(33),a=n(243),s=(n.n(a),function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()),u=f(["\n        bool ","(in vec4 pos, out LightInfo info) ","\n      "],["\n        bool ","(in vec4 pos, out LightInfo info) ","\n      "]),c=f(["struct LightInfo {\n      vec4 shadow;\n      vec3 shadowDx, shadowDy;\n      int shadowLayer;\n      float distance;\n      vec4 penumbra;\n      vec3 direction;\n      vec3 color;\n    };"],["struct LightInfo {\n      vec4 shadow;\n      vec3 shadowDx, shadowDy;\n      int shadowLayer;\n      float distance;\n      vec4 penumbra;\n      vec3 direction;\n      vec3 color;\n    };"]);function f(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}},function(t,e,n){"use strict";var r=n(78);function i(){}var o=null,a={};function s(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,t!==i&&d(t,this)}function u(t,e){for(;3===t._83;)t=t._18;if(s._47&&s._47(t),0===t._83)return 0===t._75?(t._75=1,void(t._38=e)):1===t._75?(t._75=2,void(t._38=[t._38,e])):void t._38.push(e);!function(t,e){r(function(){var n=1===t._83?e.onFulfilled:e.onRejected;if(null!==n){var r=function(t,e){try{return t(e)}catch(t){return o=t,a}}(n,t._18);r===a?f(e.promise,o):c(e.promise,r)}else 1===t._83?c(e.promise,t._18):f(e.promise,t._18)})}(t,e)}function c(t,e){if(e===t)return f(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"===typeof e||"function"===typeof e)){var n=function(t){try{return t.then}catch(t){return o=t,a}}(e);if(n===a)return f(t,o);if(n===t.then&&e instanceof s)return t._83=3,t._18=e,void l(t);if("function"===typeof n)return void d(n.bind(e),t)}t._83=1,t._18=e,l(t)}function f(t,e){t._83=2,t._18=e,s._71&&s._71(t,e),l(t)}function l(t){if(1===t._75&&(u(t,t._38),t._38=null),2===t._75){for(var e=0;e<t._38.length;e++)u(t,t._38[e]);t._38=null}}function h(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function d(t,e){var n=!1,r=function(t,e,n){try{t(e,n)}catch(t){return o=t,a}}(t,function(t){n||(n=!0,c(e,t))},function(t){n||(n=!0,f(e,t))});n||r!==a||(n=!0,f(e,o))}t.exports=s,s._47=null,s._71=null,s._44=i,s.prototype.then=function(t,e){if(this.constructor!==s)return function(t,e,n){return new t.constructor(function(r,o){var a=new s(i);a.then(r,o),u(t,new h(e,n,a))})}(this,t,e);var n=new s(i);return u(this,new h(t,e,n)),n}},function(t,e,n){"use strict";e.a=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.c=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=r*n[0]+i*n[1]+o*n[2],s=1/Math.sqrt(r*r+i*i+o*o);return t[0]=r*s,t[1]=i*s,t[2]=o*s,t[3]=-a*s,t},e.b=function(t,e,n){var r=n.pos,i=n.dir,o=r[0],a=r[1],s=r[2],u=i[0],c=i[1],f=i[2],l=e[0],h=e[1],d=e[2],_=l*o+h*a+d*s+e[3],p=l*u+h*c+d*f,E=void 0;if(p>-1e-6&&p<1e-6){if(!(_>-1e-6&&_<1e-6))return!1;E=0}else if((E=-_/p)<-1e-6)return!1;return t[0]=o+u*E,t[1]=a+c*E,t[2]=s+f*E,Math.max(E,0)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new r.a(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){let e=new r.a(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,i,o,a,s,u,c){let f=new r.a(9);return f[0]=t,f[1]=e,f[2]=n,f[3]=i,f[4]=o,f[5]=a,f[6]=s,f[7]=u,f[8]=c,f},e.set=function(t,e,n,r,i,o,a,s,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){let n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],l=f*a-s*c,h=-f*o+s*u,d=c*o-a*u,_=n*l+r*h+i*d;if(!_)return null;return _=1/_,t[0]=l*_,t[1]=(-f*r+i*c)*_,t[2]=(s*r-i*a)*_,t[3]=h*_,t[4]=(f*n-i*u)*_,t[5]=(-s*n+i*o)*_,t[6]=d*_,t[7]=(-c*n+r*u)*_,t[8]=(a*n-r*o)*_,t},e.adjoint=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8];return t[0]=a*f-s*c,t[1]=i*c-r*f,t[2]=r*s-i*a,t[3]=s*u-o*f,t[4]=n*f-i*u,t[5]=i*o-n*s,t[6]=o*c-a*u,t[7]=r*u-n*c,t[8]=n*a-r*o,t},e.determinant=function(t){let e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)},e.multiply=i,e.translate=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],l=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h*r+d*a+c,t[7]=h*i+d*s+f,t[8]=h*o+d*u+l,t},e.rotate=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],l=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*a,t[1]=d*i+h*s,t[2]=d*o+h*u,t[3]=d*a-h*r,t[4]=d*s-h*i,t[5]=d*u-h*o,t[6]=c,t[7]=f,t[8]=l,t},e.scale=function(t,e,n){let r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,f=r*a,l=r*s,h=i*a,d=i*s,_=i*u,p=o*a,E=o*s,g=o*u;return t[0]=1-l-_,t[3]=f-g,t[6]=h+E,t[1]=f+g,t[4]=1-c-_,t[7]=d-p,t[2]=h-E,t[5]=d+p,t[8]=1-c-l,t},e.normalFromMat4=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],_=e[12],p=e[13],E=e[14],g=e[15],v=n*s-r*a,A=n*u-i*a,T=n*c-o*a,y=r*u-i*s,m=r*c-o*s,b=i*c-o*u,R=f*p-l*_,N=f*E-h*_,I=f*g-d*_,M=l*E-h*p,O=l*g-d*p,P=h*g-d*E,S=v*P-A*O+T*M+y*I-m*N+b*R;if(!S)return null;return S=1/S,t[0]=(s*P-u*O+c*M)*S,t[1]=(u*I-a*P-c*N)*S,t[2]=(a*O-s*I+c*R)*S,t[3]=(i*O-r*P-o*M)*S,t[4]=(n*P-i*I+o*N)*S,t[5]=(r*I-n*O-o*R)*S,t[6]=(p*b-E*m+g*y)*S,t[7]=(E*T-_*b-g*A)*S,t[8]=(_*m-p*T+g*v)*S,t},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=o,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=e[0],d=e[1],_=e[2],p=e[3],E=e[4],g=e[5],v=e[6],A=e[7],T=e[8];return Math.abs(n-h)<=r.b*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=r.b*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-_)<=r.b*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-p)<=r.b*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-E)<=r.b*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(u-g)<=r.b*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-v)<=r.b*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(f-A)<=r.b*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(l-T)<=r.b*Math.max(1,Math.abs(l),Math.abs(T))};var r=n(4);function i(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],l=e[8],h=n[0],d=n[1],_=n[2],p=n[3],E=n[4],g=n[5],v=n[6],A=n[7],T=n[8];return t[0]=h*r+d*a+_*c,t[1]=h*i+d*s+_*f,t[2]=h*o+d*u+_*l,t[3]=p*r+E*a+g*c,t[4]=p*i+E*s+g*f,t[5]=p*o+E*u+g*l,t[6]=v*r+A*a+T*c,t[7]=v*i+A*s+T*f,t[8]=v*o+A*u+T*l,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}const a=i;e.mul=a;const s=o;e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new r.a(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){let e=new r.a(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,i,o,a,s,u,c,f,l,h,d,_,p,E){let g=new r.a(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=o,g[5]=a,g[6]=s,g[7]=u,g[8]=c,g[9]=f,g[10]=l,g[11]=h,g[12]=d,g[13]=_,g[14]=p,g[15]=E,g},e.set=function(t,e,n,r,i,o,a,s,u,c,f,l,h,d,_,p,E){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=f,t[10]=l,t[11]=h,t[12]=d,t[13]=_,t[14]=p,t[15]=E,t},e.identity=i,e.transpose=function(t,e){if(t===e){let n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],_=e[12],p=e[13],E=e[14],g=e[15],v=n*s-r*a,A=n*u-i*a,T=n*c-o*a,y=r*u-i*s,m=r*c-o*s,b=i*c-o*u,R=f*p-l*_,N=f*E-h*_,I=f*g-d*_,M=l*E-h*p,O=l*g-d*p,P=h*g-d*E,S=v*P-A*O+T*M+y*I-m*N+b*R;if(!S)return null;return S=1/S,t[0]=(s*P-u*O+c*M)*S,t[1]=(i*O-r*P-o*M)*S,t[2]=(p*b-E*m+g*y)*S,t[3]=(h*m-l*b-d*y)*S,t[4]=(u*I-a*P-c*N)*S,t[5]=(n*P-i*I+o*N)*S,t[6]=(E*T-_*b-g*A)*S,t[7]=(f*b-h*T+d*A)*S,t[8]=(a*O-s*I+c*R)*S,t[9]=(r*I-n*O-o*R)*S,t[10]=(_*m-p*T+g*v)*S,t[11]=(l*T-f*m-d*v)*S,t[12]=(s*N-a*M-u*R)*S,t[13]=(n*M-r*N+i*R)*S,t[14]=(p*A-_*y-E*v)*S,t[15]=(f*y-l*A+h*v)*S,t},e.adjoint=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],_=e[12],p=e[13],E=e[14],g=e[15];return t[0]=s*(h*g-d*E)-l*(u*g-c*E)+p*(u*d-c*h),t[1]=-(r*(h*g-d*E)-l*(i*g-o*E)+p*(i*d-o*h)),t[2]=r*(u*g-c*E)-s*(i*g-o*E)+p*(i*c-o*u),t[3]=-(r*(u*d-c*h)-s*(i*d-o*h)+l*(i*c-o*u)),t[4]=-(a*(h*g-d*E)-f*(u*g-c*E)+_*(u*d-c*h)),t[5]=n*(h*g-d*E)-f*(i*g-o*E)+_*(i*d-o*h),t[6]=-(n*(u*g-c*E)-a*(i*g-o*E)+_*(i*c-o*u)),t[7]=n*(u*d-c*h)-a*(i*d-o*h)+f*(i*c-o*u),t[8]=a*(l*g-d*p)-f*(s*g-c*p)+_*(s*d-c*l),t[9]=-(n*(l*g-d*p)-f*(r*g-o*p)+_*(r*d-o*l)),t[10]=n*(s*g-c*p)-a*(r*g-o*p)+_*(r*c-o*s),t[11]=-(n*(s*d-c*l)-a*(r*d-o*l)+f*(r*c-o*s)),t[12]=-(a*(l*E-h*p)-f*(s*E-u*p)+_*(s*h-u*l)),t[13]=n*(l*E-h*p)-f*(r*E-i*p)+_*(r*h-i*l),t[14]=-(n*(s*E-u*p)-a*(r*E-i*p)+_*(r*u-i*s)),t[15]=n*(s*h-u*l)-a*(r*h-i*l)+f*(r*u-i*s),t},e.determinant=function(t){let e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],f=t[9],l=t[10],h=t[11],d=t[12],_=t[13],p=t[14],E=t[15];return(e*a-n*o)*(l*E-h*p)-(e*s-r*o)*(f*E-h*_)+(e*u-i*o)*(f*p-l*_)+(n*s-r*a)*(c*E-h*d)-(n*u-i*a)*(c*p-l*d)+(r*u-i*s)*(c*_-f*d)},e.multiply=o,e.translate=function(t,e,n){let r,i,o,a,s,u,c,f,l,h,d,_,p=n[0],E=n[1],g=n[2];e===t?(t[12]=e[0]*p+e[4]*E+e[8]*g+e[12],t[13]=e[1]*p+e[5]*E+e[9]*g+e[13],t[14]=e[2]*p+e[6]*E+e[10]*g+e[14],t[15]=e[3]*p+e[7]*E+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],_=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=f,t[8]=l,t[9]=h,t[10]=d,t[11]=_,t[12]=r*p+s*E+l*g+e[12],t[13]=i*p+u*E+h*g+e[13],t[14]=o*p+c*E+d*g+e[14],t[15]=a*p+f*E+_*g+e[15]);return t},e.scale=function(t,e,n){let r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,i){let o,a,s,u,c,f,l,h,d,_,p,E,g,v,A,T,y,m,b,R,N,I,M,O,P=i[0],S=i[1],x=i[2],w=Math.sqrt(P*P+S*S+x*x);if(w<r.b)return null;P*=w=1/w,S*=w,x*=w,o=Math.sin(n),a=Math.cos(n),s=1-a,u=e[0],c=e[1],f=e[2],l=e[3],h=e[4],d=e[5],_=e[6],p=e[7],E=e[8],g=e[9],v=e[10],A=e[11],T=P*P*s+a,y=S*P*s+x*o,m=x*P*s-S*o,b=P*S*s-x*o,R=S*S*s+a,N=x*S*s+P*o,I=P*x*s+S*o,M=S*x*s-P*o,O=x*x*s+a,t[0]=u*T+h*y+E*m,t[1]=c*T+d*y+g*m,t[2]=f*T+_*y+v*m,t[3]=l*T+p*y+A*m,t[4]=u*b+h*R+E*N,t[5]=c*b+d*R+g*N,t[6]=f*b+_*R+v*N,t[7]=l*b+p*R+A*N,t[8]=u*I+h*M+E*O,t[9]=c*I+d*M+g*O,t[10]=f*I+_*M+v*O,t[11]=l*I+p*M+A*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},e.rotateX=function(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],f=e[9],l=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*i+c*r,t[5]=a*i+f*r,t[6]=s*i+l*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=f*i-a*r,t[10]=l*i-s*r,t[11]=h*i-u*r,t},e.rotateY=function(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],f=e[9],l=e[10],h=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i-c*r,t[1]=a*i-f*r,t[2]=s*i-l*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+f*i,t[10]=s*r+l*i,t[11]=u*r+h*i,t},e.rotateZ=function(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],f=e[5],l=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i+c*r,t[1]=a*i+f*r,t[2]=s*i+l*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=f*i-a*r,t[6]=l*i-s*r,t[7]=h*i-u*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){let i,o,a,s=n[0],u=n[1],c=n[2],f=Math.sqrt(s*s+u*u+c*c);if(f<r.b)return null;return s*=f=1/f,u*=f,c*=f,i=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+c*i,t[2]=c*s*a-u*i,t[3]=0,t[4]=s*u*a-c*i,t[5]=u*u*a+o,t[6]=c*u*a+s*i,t[7]=0,t[8]=s*c*a+u*i,t[9]=u*c*a-s*i,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromXRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=a,e.fromQuat2=function(t,e){let n=new r.a(3),i=-e[0],o=-e[1],s=-e[2],u=e[3],c=e[4],f=e[5],l=e[6],h=e[7],d=i*i+o*o+s*s+u*u;d>0?(n[0]=2*(c*u+h*i+f*s-l*o)/d,n[1]=2*(f*u+h*o+l*i-c*s)/d,n[2]=2*(l*u+h*s+c*o-f*i)/d):(n[0]=2*(c*u+h*i+f*s-l*o),n[1]=2*(f*u+h*o+l*i-c*s),n[2]=2*(l*u+h*s+c*o-f*i));return a(t,e,n),t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],f=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+a*a+s*s),t[2]=Math.sqrt(u*u+c*c+f*f),t},e.getRotation=function(t,e){let n=e[0]+e[5]+e[10],r=0;n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r);return t},e.fromRotationTranslationScale=function(t,e,n,r){let i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,f=a+a,l=i*u,h=i*c,d=i*f,_=o*c,p=o*f,E=a*f,g=s*u,v=s*c,A=s*f,T=r[0],y=r[1],m=r[2];return t[0]=(1-(_+E))*T,t[1]=(h+A)*T,t[2]=(d-v)*T,t[3]=0,t[4]=(h-A)*y,t[5]=(1-(l+E))*y,t[6]=(p+g)*y,t[7]=0,t[8]=(d+v)*m,t[9]=(p-g)*m,t[10]=(1-(l+_))*m,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){let o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,f=a+a,l=s+s,h=o*c,d=o*f,_=o*l,p=a*f,E=a*l,g=s*l,v=u*c,A=u*f,T=u*l,y=r[0],m=r[1],b=r[2],R=i[0],N=i[1],I=i[2],M=(1-(p+g))*y,O=(d+T)*y,P=(_-A)*y,S=(d-T)*m,x=(1-(h+g))*m,w=(E+v)*m,L=(_+A)*b,F=(E-v)*b,U=(1-(h+p))*b;return t[0]=M,t[1]=O,t[2]=P,t[3]=0,t[4]=S,t[5]=x,t[6]=w,t[7]=0,t[8]=L,t[9]=F,t[10]=U,t[11]=0,t[12]=n[0]+R-(M*R+S*N+L*I),t[13]=n[1]+N-(O*R+x*N+F*I),t[14]=n[2]+I-(P*R+w*N+U*I),t[15]=1,t},e.fromQuat=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,f=r*a,l=r*s,h=i*a,d=i*s,_=i*u,p=o*a,E=o*s,g=o*u;return t[0]=1-l-_,t[1]=f+g,t[2]=h-E,t[3]=0,t[4]=f-g,t[5]=1-c-_,t[6]=d+p,t[7]=0,t[8]=h+E,t[9]=d-p,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,r,i,o,a){let s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},e.perspective=function(t,e,n,r,i){let o,a=1/Math.tan(e/2);t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r);return t},e.perspectiveFromFieldOfView=function(t,e,n,r){let i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},e.ortho=function(t,e,n,r,i,o,a){let s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t},e.lookAt=function(t,e,n,o){let a,s,u,c,f,l,h,d,_,p,E=e[0],g=e[1],v=e[2],A=o[0],T=o[1],y=o[2],m=n[0],b=n[1],R=n[2];if(Math.abs(E-m)<r.b&&Math.abs(g-b)<r.b&&Math.abs(v-R)<r.b)return i(t);h=E-m,d=g-b,_=v-R,p=1/Math.sqrt(h*h+d*d+_*_),a=T*(_*=p)-y*(d*=p),s=y*(h*=p)-A*_,u=A*d-T*h,(p=Math.sqrt(a*a+s*s+u*u))?(a*=p=1/p,s*=p,u*=p):(a=0,s=0,u=0);c=d*u-_*s,f=_*a-h*u,l=h*s-d*a,(p=Math.sqrt(c*c+f*f+l*l))?(c*=p=1/p,f*=p,l*=p):(c=0,f=0,l=0);return t[0]=a,t[1]=c,t[2]=h,t[3]=0,t[4]=s,t[5]=f,t[6]=d,t[7]=0,t[8]=u,t[9]=l,t[10]=_,t[11]=0,t[12]=-(a*E+s*g+u*v),t[13]=-(c*E+f*g+l*v),t[14]=-(h*E+d*g+_*v),t[15]=1,t},e.targetTo=function(t,e,n,r){let i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],c=r[2],f=i-n[0],l=o-n[1],h=a-n[2],d=f*f+l*l+h*h;d>0&&(d=1/Math.sqrt(d),f*=d,l*=d,h*=d);let _=u*h-c*l,p=c*f-s*h,E=s*l-u*f;(d=_*_+p*p+E*E)>0&&(d=1/Math.sqrt(d),_*=d,p*=d,E*=d);return t[0]=_,t[1]=p,t[2]=E,t[3]=0,t[4]=l*E-h*p,t[5]=h*_-f*E,t[6]=f*p-l*_,t[7]=0,t[8]=f,t[9]=l,t[10]=h,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=s,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],d=t[10],_=t[11],p=t[12],E=t[13],g=t[14],v=t[15],A=e[0],T=e[1],y=e[2],m=e[3],b=e[4],R=e[5],N=e[6],I=e[7],M=e[8],O=e[9],P=e[10],S=e[11],x=e[12],w=e[13],L=e[14],F=e[15];return Math.abs(n-A)<=r.b*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(i-T)<=r.b*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(o-y)<=r.b*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-m)<=r.b*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-b)<=r.b*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(u-R)<=r.b*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(c-N)<=r.b*Math.max(1,Math.abs(c),Math.abs(N))&&Math.abs(f-I)<=r.b*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(l-M)<=r.b*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(h-O)<=r.b*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(d-P)<=r.b*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(_-S)<=r.b*Math.max(1,Math.abs(_),Math.abs(S))&&Math.abs(p-x)<=r.b*Math.max(1,Math.abs(p),Math.abs(x))&&Math.abs(E-w)<=r.b*Math.max(1,Math.abs(E),Math.abs(w))&&Math.abs(g-L)<=r.b*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(v-F)<=r.b*Math.max(1,Math.abs(v),Math.abs(F))};var r=n(4);function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],_=e[11],p=e[12],E=e[13],g=e[14],v=e[15],A=n[0],T=n[1],y=n[2],m=n[3];return t[0]=A*r+T*s+y*l+m*p,t[1]=A*i+T*u+y*h+m*E,t[2]=A*o+T*c+y*d+m*g,t[3]=A*a+T*f+y*_+m*v,A=n[4],T=n[5],y=n[6],m=n[7],t[4]=A*r+T*s+y*l+m*p,t[5]=A*i+T*u+y*h+m*E,t[6]=A*o+T*c+y*d+m*g,t[7]=A*a+T*f+y*_+m*v,A=n[8],T=n[9],y=n[10],m=n[11],t[8]=A*r+T*s+y*l+m*p,t[9]=A*i+T*u+y*h+m*E,t[10]=A*o+T*c+y*d+m*g,t[11]=A*a+T*f+y*_+m*v,A=n[12],T=n[13],y=n[14],m=n[15],t[12]=A*r+T*s+y*l+m*p,t[13]=A*i+T*u+y*h+m*E,t[14]=A*o+T*c+y*d+m*g,t[15]=A*a+T*f+y*_+m*v,t}function a(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,f=r*s,l=r*u,h=r*c,d=i*u,_=i*c,p=o*c,E=a*s,g=a*u,v=a*c;return t[0]=1-(d+p),t[1]=l+v,t[2]=h-g,t[3]=0,t[4]=l-v,t[5]=1-(f+p),t[6]=_+E,t[7]=0,t[8]=h+g,t[9]=_-E,t[10]=1-(f+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}const u=o;e.mul=u;const c=s;e.sub=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=s,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=u,e.getAxisAngle=function(t,e){let n=2*Math.acos(e[3]),r=Math.sin(n/2);0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0);return n},e.multiply=c,e.rotateX=function(t,e,n){n*=.5;let r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t},e.rotateY=function(t,e,n){n*=.5;let r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t},e.rotateZ=function(t,e,n){n*=.5;let r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},e.calculateW=function(t,e){let n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},e.slerp=f,e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=l,e.fromEuler=function(t,e,n,r){let i=.5*Math.PI/180;e*=i,n*=i,r*=i;let o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),f=Math.cos(r);return t[0]=o*u*f-a*s*c,t[1]=a*s*f+o*u*c,t[2]=a*u*c-o*s*f,t[3]=a*u*f+o*s*c,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var r=n(4),i=n(39),o=n(42),a=n(43);function s(){let t=new r.a(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function u(t,e,n){n*=.5;let r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function c(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],f=n[3];return t[0]=r*f+a*s+i*c-o*u,t[1]=i*f+a*u+o*s-r*c,t[2]=o*f+a*c+r*u-i*s,t[3]=a*f-r*s-i*u-o*c,t}function f(t,e,n,r){let i,o,a,s,u,c=e[0],f=e[1],l=e[2],h=e[3],d=n[0],_=n[1],p=n[2],E=n[3];return(o=c*d+f*_+l*p+h*E)<0&&(o=-o,d=-d,_=-_,p=-p,E=-E),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*c+u*d,t[1]=s*f+u*_,t[2]=s*l+u*p,t[3]=s*h+u*E,t}function l(t,e){let n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);let i=(r+1)%3,o=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*i+i]-e[3*o+o]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*i+o]-e[3*o+i])*n,t[i]=(e[3*i+r]+e[3*r+i])*n,t[o]=(e[3*o+r]+e[3*r+o])*n}return t}const h=a.clone;e.clone=h;const d=a.fromValues;e.fromValues=d;const _=a.copy;e.copy=_;const p=a.set;e.set=p;const E=a.add;e.add=E;const g=c;e.mul=g;const v=a.scale;e.scale=v;const A=a.dot;e.dot=A;const T=a.lerp;e.lerp=T;const y=a.length;e.length=y;const m=y;e.len=m;const b=a.squaredLength;e.squaredLength=b;const R=b;e.sqrLen=R;const N=a.normalize;e.normalize=N;const I=a.exactEquals;e.exactEquals=I;const M=a.equals;e.equals=M;const O=function(){let t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(r,i,a){let s=o.dot(i,a);return s<-.999999?(o.cross(t,e,i),o.len(t)<1e-6&&o.cross(t,n,i),o.normalize(t,t),u(r,t,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+s,N(r,r))}}();e.rotationTo=O;const P=function(){let t=s(),e=s();return function(n,r,i,o,a,s){return f(t,r,a,s),f(e,i,o,s),f(n,t,e,2*s*(1-s)),n}}();e.sqlerp=P;const S=function(){let t=i.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],N(e,l(e,t))}}();e.setAxes=S},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=i,e.clone=function(t){var e=new r.a(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=o,e.fromValues=a,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=s,e.multiply=u,e.divide=c,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},e.distance=f,e.squaredDistance=l,e.squaredLength=h,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=d,e.dot=_,e.cross=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t},e.lerp=function(t,e,n,r){let i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t},e.hermite=function(t,e,n,r,i,o){let a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),f=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*f,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*f,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*f,t},e.bezier=function(t,e,n,r,i,o){let a=1-o,s=a*a,u=o*o,c=s*a,f=3*o*s,l=3*u*a,h=u*o;return t[0]=e[0]*c+n[0]*f+r[0]*l+i[0]*h,t[1]=e[1]*c+n[1]*f+r[1]*l+i[1]*h,t[2]=e[2]*c+n[2]*f+r[2]*l+i[2]*h,t},e.random=function(t,e){e=e||1;let n=2*r.c()*Math.PI,i=2*r.c()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t},e.transformMat4=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t},e.transformMat3=function(t,e,n){let r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},e.transformQuat=function(t,e,n){let r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],f=i*c-o*u,l=o*s-r*c,h=r*u-i*s,d=i*h-o*l,_=o*f-r*h,p=r*l-i*f,E=2*a;return f*=E,l*=E,h*=E,d*=2,_*=2,p*=2,t[0]=s+f+d,t[1]=u+l+_,t[2]=c+h+p,t},e.rotateX=function(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.rotateY=function(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.rotateZ=function(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.angle=function(t,e){let n=a(t[0],t[1],t[2]),r=a(e[0],e[1],e[2]);d(n,n),d(r,r);let i=_(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){let n=t[0],i=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=r.b*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r.b*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-u)<=r.b*Math.max(1,Math.abs(o),Math.abs(u))};var r=n(4);function i(){let t=new r.a(3);return t[0]=0,t[1]=0,t[2]=0,t}function o(t){let e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function a(t,e,n){let i=new r.a(3);return i[0]=t,i[1]=e,i[2]=n,i}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function u(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function c(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function f(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function l(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function h(t){let e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function d(t,e){let n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function _(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}const p=s;e.sub=p;const E=u;e.mul=E;const g=c;e.div=g;const v=f;e.dist=v;const A=l;e.sqrDist=A;const T=o;e.len=T;const y=h;e.sqrLen=y;const m=function(){let t=i();return function(e,n,r,i,o,a){let s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}();e.forEach=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=i,e.clone=function(t){let e=new r.a(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,i){let o=new r.a(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=o,e.multiply=a,e.divide=s,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.distance=u,e.squaredDistance=c,e.length=f,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a);return t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,r){let i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t},e.random=function(t,e){var n,i,o,a,s,u;e=e||1;do{n=2*r.c()-1,i=2*r.c()-1,s=n*n+i*i}while(s>=1);do{o=2*r.c()-1,a=2*r.c()-1,u=o*o+a*a}while(u>=1);var c=Math.sqrt((1-s)/u);return t[0]=e*n,t[1]=e*i,t[2]=e*o*c,t[3]=e*a*c,t},e.transformMat4=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t},e.transformQuat=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],f=c*r+s*o-u*i,l=c*i+u*r-a*o,h=c*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=f*c+d*-a+l*-u-h*-s,t[1]=l*c+d*-s+h*-a-f*-u,t[2]=h*c+d*-u+f*-s-l*-a,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){let n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],c=e[2],f=e[3];return Math.abs(n-s)<=r.b*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.b*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.b*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-f)<=r.b*Math.max(1,Math.abs(a),Math.abs(f))};var r=n(4);function i(){let t=new r.a(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function a(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function s(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function u(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function c(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function f(t){let e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function l(t){let e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}const h=o;e.sub=h;const d=a;e.mul=d;const _=s;e.div=_;const p=u;e.dist=p;const E=c;e.sqrDist=E;const g=f;e.len=g;const v=l;e.sqrLen=v;const A=function(){let t=i();return function(e,n,r,i,o,a){let s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();e.forEach=A},function(t,e,n){n(102);for(var r=n(8),i=n(12),o=n(10),a=n(6)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],f=r[c],l=f&&f.prototype;l&&!l[a]&&i(l,a,c),o[c]=o.Array}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){"use strict";var r=n(47),i=n(106),o=n(111),a=n(12),s=n(10),u=n(112),c=n(54),f=n(121),l=n(6)("iterator"),h=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,_,p,E,g){u(n,e,_);var v,A,T,y=function(t){if(!h&&t in N)return N[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},m=e+" Iterator",b="values"==p,R=!1,N=t.prototype,I=N[l]||N["@@iterator"]||p&&N[p],M=I||y(p),O=p?b?y("entries"):M:void 0,P="Array"==e&&N.entries||I;if(P&&(T=f(P.call(new t)))!==Object.prototype&&T.next&&(c(T,m,!0),r||"function"==typeof T[l]||a(T,l,d)),b&&I&&"values"!==I.name&&(R=!0,M=function(){return I.call(this)}),r&&!g||!h&&!R&&N[l]||a(N,l,M),s[e]=M,s[m]=d,p)if(v={values:b?M:y("values"),keys:E?M:y("keys"),entries:O},g)for(A in v)A in N||o(N,A,v[A]);else i(i.P+i.F*(h||R),e,v);return v}},function(t,e){t.exports=!0},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(28),i=n(8).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(11),i=n(8),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(47)?"pure":"global",copyright:"\xa9 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(27).f,i=n(17),o=n(6)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){"use strict";var r=n(123)(!0);n(46)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){var r=n(45),i=n(6)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){"use strict";function r(t){return 0===t&&1/t===1/0}Object.defineProperty(e,"__esModule",{value:!0}),e.ToInteger=function(t){"number"!==typeof t&&(t=Number(t));Number.isNaN(t)&&(t=0);return Math.trunc(t)},e.defaultCompareFunction=function(t,e){var n=[Number.isNaN(t),Number.isNaN(e)];const i=n[0],o=n[1];if(i&&o)return 0;if(i)return 1;if(o)return-1;if(t<e)return-1;if(t>e)return 1;if(0===t&&0===e){var a=[r(t),r(e)];const n=a[0],i=a[1];if(!n&&i)return-1;if(n&&!i)return 1}return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isArrayBuffer=void 0;var r=n(129);Object.defineProperty(e,"isArrayBuffer",{enumerable:!0,get:function(){return(t=r,t&&t.__esModule?t:{default:t}).default;var t}}),e.isDataView=function(t){return t instanceof DataView},e.isStringNumberKey=function(t){return"string"===typeof t&&t===(0,i.ToInteger)(t)+""};var i=n(57)},function(t,e,n){var r=n(60),i=n(131),o=n(132),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?i(t):o(t)}},function(t,e,n){var r=n(31).Symbol;t.exports=r},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(e,n(21))},function(t,e,n){var r=n(143),i=n(148);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){"use strict";e.a=function(t,e){if(t.sleeping&&e.sleeping)return!1;t.moves&&e.moves&&(t.motion>r.a.sleepWakeThreshold&&e.wake(),e.motion>r.a.sleepWakeThreshold&&t.wake());return!0};var r=n(1)},function(t,e,n){"use strict";var r=n(174);n.d(e,"a",function(){return r.a});var i=n(175);n.d(e,"b",function(){return i.a});var o=n(176);n.d(e,"c",function(){return o.a})},function(t,e,n){"use strict";e.a=function(t,e,n,_,p,E){var g=r.g.subtract(o,_,n),v=r.g.length(g),A=t.radius+p;if(v<i.a.delta)return!1;r.g.scale(g,g,1/v);var T=r.g.subtract(a,t.start,n),y=r.g.subtract(s,t.end,n),m=r.g.length(r.g.cross(u,g,T)),b=r.g.length(r.g.cross(u,g,y));if(Math.abs(m-b)>Math.max(.1,.1*m))return!1;var R=T,N=r.g.dot(T,g),I=y,M=r.g.dot(y,g),O=void 0;M<N&&(O=R,R=I,I=O,O=N,N=M,M=O,O=m,m=b,b=O);var P=Math.max(N,0),S=Math.min(M,v);if(S-P<i.a.delta)return!1;var x=(P-N)/(M-N),w=(S-N)/(M-N),L=r.g.lerp(f,R,I,x),F=r.g.lerp(l,R,I,w),U=m+(b-m)*x,C=m+(b-m)*w;if(U<A+i.a.delta||C<A+i.a.delta){var D=r.g.scaleAndAdd(u,L,g,-P),B=r.g.scaleAndAdd(c,F,g,-S);return U>C&&U>1e-4?r.g.normalize(this.normal,D):C>1e-4?r.g.normalize(this.normal,B):r.g.set(this.normal,0,0,1),r.g.copy(h,this.normal),this.sync(t,e),U<A+i.a.delta&&(r.g.add(d,n,L),r.g.scaleAndAdd(d,d,h,-.5*(U-p+(p?t.radius:U))),this.add(d,A-U,E+"a")),C<A+i.a.delta&&(r.g.add(d,n,F),r.g.scaleAndAdd(d,d,h,-.5*(C-p+(p?t.radius:C))),this.add(d,A-C,E+"b")),!0}};var r=n(0),i=n(1),o=new Float32Array(3),a=new Float32Array(3),s=new Float32Array(3),u=new Float32Array(3),c=new Float32Array(3),f=new Float32Array(3),l=new Float32Array(3),h=new Float32Array(3),d=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e,n){n?u.g.copy(y,n):u.g.set(y,1,0,0);i=t.support(y);var a=e.support(y);u.g.negate(y,y),o=t.support(y);var l=e.support(y);u.g.subtract(v,i,l),u.g.subtract(A,o,a),u.g.squaredDistance(v,A)>.01?(b(y,u.g.subtract(c,A,v),u.g.negate(f,v)),s=2):(u.g.negate(y,v),s=1);u.g.normalize(y,y);for(var h=20;h--;){r=t.support(y),u.g.negate(c,y);var d=e.support(c);if(u.g.subtract(g,r,d),s&&u.g.dot(g,y)<u.g.dot(v,y)+.01)return I();if(N())return null;u.g.normalize(y,y)}return null};var r,i,o,a,s,u=n(0),c=u.g.create(),f=u.g.create(),l=u.g.create(),h=u.g.create(),d=u.g.create(),_=u.g.create(),p=u.g.create(),E=new Float32Array(9),g=u.g.create(),v=u.g.create(),A=u.g.create(),T=u.g.create(),y=u.g.create(),m=[u.g.create(),u.g.create()];function b(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=i*u-o*s,f=o*a-r*u,l=r*s-i*a;return t[0]=f*o-l*i,t[1]=l*r-c*o,t[2]=c*i-f*r,t}function R(t,e,n){var r=t[0],i=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return n[0]*(i*u-o*s)+n[1]*(o*a-r*u)+n[2]*(r*s-i*a)}function N(){switch(s){case 0:var t=v;return v=g,g=t,i=r,s=1,u.g.negate(y,v),!1;case 1:var e=u.g.negate(c,g),n=u.g.subtract(f,v,g);if(u.g.dot(n,e)>0){t=A;A=v,v=g,g=t,o=i,i=r,b(y,n,e),s=2}else{t=v;v=g,g=t,i=r,u.g.copy(y,e)}return!1;case 2:e=u.g.negate(c,g),n=u.g.subtract(f,v,g);var E=u.g.subtract(l,A,g);if(R(n,N=u.g.cross(h,n,E),e)<0&&R(N,E,e)<0){if(u.g.dot(N,e)>0){t=T;T=A,A=v,v=g,g=t,a=o,o=i,i=r,u.g.copy(y,N)}else{t=T;T=v,v=g,g=t,a=i,i=r,u.g.negate(y,N)}s=3}else if(u.g.dot(n,e)>0){t=A;A=v,v=g,g=t,o=i,i=r,b(y,n,e)}else if(u.g.dot(E,e)>0){t=v;v=g,g=t,i=r,b(y,E,e)}else{t=v;v=g,g=t,i=r,u.g.copy(y,e),s=1}return!1;case 3:e=u.g.negate(c,g),n=u.g.subtract(f,v,g),E=u.g.subtract(l,A,g);var m=u.g.subtract(d,T,g),N=u.g.cross(h,n,E),I=u.g.cross(_,E,m),M=u.g.cross(p,m,n),O=u.g.dot(N,e),P=u.g.dot(I,e),S=u.g.dot(M,e);if(O<0&&P<0&&S<0)return!0;if(O>=0&&R(n,N,e)<0&&R(N,E,e)<0){t=T;return T=A,A=v,v=g,g=t,a=o,o=i,i=r,u.g.copy(y,N),!1}if(P>=0&&R(E,I,e)<0&&R(I,m,e)<0){t=v;return v=g,g=t,i=r,u.g.copy(y,I),!1}if(S>=0&&R(m,M,e)<0&&R(M,n,e)<0){t=A;return A=T,T=v,v=g,g=t,o=a,a=i,i=r,u.g.copy(y,M),!1}if(u.g.dot(n,e)>0){t=A;A=v,v=g,g=t,o=i,i=r,b(y,n,e),s=2}else if(u.g.dot(E,e)>0){t=v;v=g,g=t,i=r,b(y,E,e),s=2}else if(u.g.dot(m,e)>0){t=v;v=g,g=t,t=A,A=T,T=t,i=r,o=a,b(y,m,e),s=2}else{t=v;v=g,g=t,i=r,u.g.copy(y,e),s=1}return!1}return!1}function I(){switch(u.g.scale(g,y,u.g.dot(v,y)),s){case 3:if(E.set(v,0),E.set(A,3),E.set(T,6),Math.abs(u.d.determinant(E))>1e-4){u.d.invert(E,E),u.g.transformMat3(c,g,E);var t=c[0],e=c[1],n=c[2];m[0][0]=i[0]*t+o[0]*e+a[0]*n,m[0][1]=i[1]*t+o[1]*e+a[1]*n,m[0][2]=i[2]*t+o[2]*e+a[2]*n;break}case 2:var r=u.g.subtract(c,A,v),l=u.g.subtract(f,g,v),h=u.g.dot(r,r);if(h>1e-4){(h=u.g.dot(l,r)/h)<0&&(h=0),h>1&&(h=1),u.g.lerp(m[0],i,o,h);break}case 1:u.g.copy(m[0],i)}return u.g.subtract(m[1],m[0],g),m}},function(t,e,n){"use strict";var r,i,o=n(0),a=n(13),s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var c=o.g.create(),f=o.g.create(),l=o.g.create(),h=o.d.create(),d=(i=r=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.vertices=[],t.faces=[],t.edges={},t.verticesLocal=t.vertices,t}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a["a"]),u(e,[{key:"_edge",value:function(t,e){var n=t+"_"+e;return this.edges[n]?this.edges[n]:this.edges[n]={a:this.vertices[t],b:this.vertices[e]}}},{key:"updateNormal",value:function(t){var e=this.vertices,n=t.vertices,r=n.length;o.g.copy(f,e[n[r-1]]),o.g.cross(t.plane,f,e[n[0]]);for(var i=0;i<r-1;++i)o.g.add(t.plane,t.plane,o.g.cross(c,e[n[i]],e[n[i+1]])),o.g.add(f,f,e[n[i]]);o.g.scale(f,f,1/r),o.g.normalize(t.plane,t.plane),t.plane[3]=-o.g.dot(t.plane,f),t.planeLocal=o.h.clone(t.plane)}},{key:"addFace",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n.length&&"object"!==s(n[0])){var i={vertices:[].concat(n)};i.plane=o.h.create(),this.updateNormal(i),this.faces.push(i);for(var a=n.length,u=0;u<a;++u){var c=n[u],f=n[u===a-1?0:u+1];c<f?this._edge(c,f).n1=i.plane:this._edge(f,c).n2=i.plane}}else n.forEach(function(e){return t.addFace.apply(t,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(e))})}},{key:"updateCenter",value:function(){this.center||(this.centerLocal=this.verticesLocal.reduce(function(t,e){return o.g.add(t,t,e)},o.g.create()),o.g.scale(this.centerLocal,this.centerLocal,1/this.verticesLocal.length),this.center=o.g.clone(this.centerLocal)),this.body&&o.g.transformMat4(this.center,this.centerLocal,this.body.transform)}},{key:"update",value:function(){var t=this.aabb,e=this.vertices,n=this.verticesLocal;if(this.updateCenter(),this.body){var r=this.body.transform;n===e&&(n=this.verticesLocal=e.map(function(t){return o.g.clone(t)}));for(var i=0;i<e.length;++i)o.g.transformMat4(e[i],n[i],r);o.d.normalFromMat4(h,r);var a=r.subarray(12,15);this.faces.forEach(function(t){var e=t.plane,n=t.planeLocal;o.g.transformMat3(e,n,h),e[3]=n[3]-o.g.dot(a,e),o.h.scale(e,e,1/o.g.length(e))})}o.a.setVec3(t,e[0]);for(var s=1;s<e.length;++s)o.a.combineVec3(t,t,e[s])}},{key:"support",value:function(t){for(var e=this.vertices,n=e[0],r=o.g.dot(n,t),i=1;i<e.length;++i){var a=o.g.dot(t,e[i]);a>r&&(r=a,n=e[i])}return n}},{key:"getInfo",value:function(t,e){var n=this.verticesLocal,r=0,i=0,o=0,a=0,s=0,u=0,c=0,f=0,l=0,h=0,d=void 0,_=void 0,p=void 0;this.this.faces.forEach(function(t){for(var e=t.vertices,E=e[0],g=n[E][0],v=n[E][1],A=n[E][2],T=1;T+2<=e.length;++T){var y=e[T],m=e[T+1],b=n[y][0],R=n[y][1],N=n[y][2],I=n[m][0],M=n[m][1],O=n[m][2],P=b-g,S=R-v,x=N-A,w=I-g,L=M-v,F=O-A,U=S*F-L*x,C=w*x-P*F,D=P*L-w*S,B=(d=g+b)+I,X=(p=(_=g*g)+b*d)+I*B,j=g*_+b*p+I*X,k=(d=v+R)+M,Y=(p=(_=v*v)+R*d)+M*k,V=v*_+R*p+M*Y,H=(d=A+N)+O,G=(p=(_=A*A)+N*d)+O*H;r+=U*B,i+=U*X,o+=C*Y,a+=D*G,s+=U*j,u+=C*V,c+=D*(A*_+N*p+O*G),f+=U*(v*(X+g*(B+g))+R*(X+b*(B+b))+M*(X+I*(B+I))),l+=C*(A*(Y+v*(k+v))+N*(Y+R*(k+R))+O*(Y+M*(k+M))),h+=D*(g*(G+A*(H+A))+b*(G+N*(H+N))+I*(G+O*(H+O)))}}),r/=6,i/=24,o/=24,a/=24,s/=60,u/=60,c/=60,f/=120,l/=120,h/=120;var E=this.material.density,g=E*r;t[0]=i/r,t[1]=o/r,t[2]=a/r;var v=t[0]*t[0],A=t[1]*t[1],T=t[2]*t[2];return e[0]=E*(u+c-r*(A+T)),e[4]=E*(s+c-r*(T+v)),e[8]=E*(s+u-r*(v+A)),e[1]=e[3]=-E*(f-r*t[0]*t[1]),e[5]=e[7]=-E*(l-r*t[1]*t[2]),e[2]=e[6]=-E*(h-r*t[2]*t[0]),g}},{key:"intersect",value:function(t){for(var e=0;e<this.faces.length;++e){var n=this.faces[e],r=o.g.dot(t.pos,n.plane)+n.plane[3],i=o.g.dot(t.dir,n.plane);if(!(i>-1e-4||r<-1e-4)){var a=Math.max(0,-r/i);o.g.scaleAndAdd(c,t.pos,t.dir,a);for(var s=n.vertices.length,u=!0,h=0;h<s;++h){var d=this.vertices[n.vertices[h]],_=this.vertices[n.vertices[h==s-1?0:h+1]];if(o.g.subtract(f,_,d),o.g.subtract(l,c,d),o.g.cross(f,f,l),o.g.dot(f,n.plane)<0){u=!1;break}}if(u)return a}}return!1}}]),e}(),r.type="Hull",i);e.a=d},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(2),i=n(5),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=function(t){function e(t,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=t.gl;return i.array=o.createVertexArray(),i.setAttributes(n,r),i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["a"]),o(e,[{key:"getAttributes",value:function(){var t=this.renderer.gl,e={};return t.bindVertexArray(this.array),this.attributes.forEach(function(n,i){e[n]={buffer:t.getVertexAttrib(i,r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING),size:t.getVertexAttrib(i,r.VERTEX_ATTRIB_ARRAY_SIZE),type:t.getVertexAttrib(i,r.VERTEX_ATTRIB_ARRAY_TYPE),normalized:t.getVertexAttrib(i,r.VERTEX_ATTRIB_ARRAY_NORMALIZED),stride:t.getVertexAttrib(i,r.VERTEX_ATTRIB_ARRAY_STRIDE),offset:t.getVertexAttribOffset(i,r.VERTEX_ATTRIB_ARRAY_POINTER)}}),t.bindVertexArray(null),e}},{key:"getIndices",value:function(){var t=this.renderer.gl;t.bindVertexArray(this.array);var e=t.getParameter(r.ELEMENT_ARRAY_BUFFER_BINDING);return t.bindVertexArray(null),e}},{key:"setAttributes",value:function(t,e){var n=this.renderer.gl;n.bindVertexArray(this.array);var i=this.attributes&&this.attributes.length||0;this.attributes=Object.keys(t).sort();for(var o=this.attributes.length;o<i;++o)n.enableVertexAttribArray(o);this.attributes.forEach(function(e,i){var o=t[e],a=o.buffer,s=o.size,u=o.type,c=o.normalized,f=void 0!==c&&c,l=o.stride,h=void 0===l?0:l,d=o.offset,_=void 0===d?0:d;n.bindBuffer(r.ARRAY_BUFFER,a),n.enableVertexAttribArray(i),e.match(/^JOINTS_\d+$/)?n.vertexAttribIPointer(i,s,u,h,_):n.vertexAttribPointer(i,s,u,f,h,_)}),n.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),n.bindVertexArray(null)}},{key:"bind",value:function(){return this.renderer.gl.bindVertexArray(this.array),this}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(3),i=(n.n(r),n(2)),o=n(5),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.TEXTURE_2D;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));r.unit=0;var o=t.gl;return r.texture=o.createTexture(),r.target=n,r}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o["a"]),a(e,[{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.unit=t,this.renderer.activeTexture[t]!==this){this.renderer.activeTexture[t]=this;var e=this.renderer.gl;e.activeTexture(i.TEXTURE0+t),e.bindTexture(this.target,this.texture)}return this}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.RGBA,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.UNSIGNED_BYTE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return this.bind(this.unit),this.renderer.gl.texImage2D(this.target,o,r,e,n,t),this.format=r,this}},{key:"loadPixels",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.RGBA,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.UNSIGNED_BYTE,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return this.bind(this.unit),this.renderer.gl.texImage2D(this.target,s,a,t,e,0,r,o,n),this.format=a,this}},{key:"create",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.bind(this.unit),this.renderer.gl.texStorage2D(this.target,r,n,t,e),this.format=n,this}},{key:"loadPixels3D",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.RGBA,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:i.UNSIGNED_BYTE,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return this.bind(this.unit),this.renderer.gl.texImage3D(this.target,u,s,t,e,n,0,o,a,r),this.format=s,this.depth=n,this}},{key:"create3D",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return this.bind(this.unit),this.renderer.gl.texStorage3D(this.target,i,r,t,e,n),this.format=r,this.depth=n,this}},{key:"generateMipmap",value:function(){return this.bind(this.unit),this.renderer.gl.generateMipmap(this.target),this}},{key:"destroy",value:function(){this.renderer.gl.deleteTexture(this.texture)}},{key:"filter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.bind(this.unit);var n=this.renderer.gl;return n.texParameteri(this.target,i.TEXTURE_MAG_FILTER,t===i.NEAREST?i.NEAREST:i.LINEAR),n.texParameteri(this.target,i.TEXTURE_MIN_FILTER,e),this}},{key:"wrap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.bind(this.unit);var r=this.renderer.gl;return r.texParameteri(this.target,i.TEXTURE_WRAP_S,t),r.texParameteri(this.target,i.TEXTURE_WRAP_T,e),this.target===i.TEXTURE_3D&&r.texParameteri(this.target,i.TEXTURE_WRAP_R,n),this}},{key:"mipmapLevels",value:function(t,e){this.bind(this.unit);var n=this.renderer.gl;return n.texParameteri(this.target,i.TEXTURE_BASE_LEVEL,t),n.texParameteri(this.target,i.TEXTURE_MAX_LEVEL,e),this}},{key:"clampLod",value:function(t,e){this.bind(this.unit);var n=this.renderer.gl;return n.texParameteri(this.target,i.TEXTURE_MIN_LOD,t),n.texParameteri(this.target,i.TEXTURE_MAX_LOD,e),this}},{key:"compareMode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.LEQUAL;this.bind(this.unit);var n=this.renderer.gl;return n.texParameteri(this.target,i.TEXTURE_COMPARE_MODE,t),n.texParameteri(this.target,i.TEXTURE_COMPARE_FUNC,e),this}},{key:"getPixels",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=new this.renderer.FrameBuffer;o.bind(),this.target===i.TEXTURE_2D_ARRAY?o.textureLayer(i.COLOR_ATTACHMENT0,this,r):o.texture(i.COLOR_ATTACHMENT0,this),this.renderer.gl.readBuffer(i.COLOR_ATTACHMENT0);var a=new(n===i.FLOAT?Float32Array:Uint8Array)(t*e*4);return this.renderer.gl.readPixels(0,0,t,e,i.RGBA,n,a),o.unbind(),o.destroy(),a}},{key:"getDepth",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new this.renderer.RenderTarget(t,e,{color:i.R32F},{depthTest:!1,depthMask:!1,blend:!1});(this.target===i.TEXTURE_2D_ARRAY?new this.renderer.Filters.Local("return texelFetch(u_Source,ivec3(ivec2(gl_FragCoord.xy), "+n+"), 0).r","float","sampler2DArray"):new this.renderer.Filters.Local("return get(0, 0).r","float")).apply(this,r);var o=r.color.getPixels(t,e,i.FLOAT);return r.destroy(),o}},{key:"download",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=function(o){var a=n<0?r.getDepth(t,e,o):r.getPixels(t,e,n,o);if(n===i.FLOAT||n<0){for(var s=new Uint8ClampedArray(a.length),u=0;u<a.length;++u)s[u]=255*a[u];a=s}else a=new Uint8ClampedArray(a);return new ImageData(a,t,e)},s=t;this.target===i.TEXTURE_2D_ARRAY&&(s*=o);var u=document.createElement("canvas");u.width=s,u.height=e;var c=u.getContext("2d");if(this.target===i.TEXTURE_2D_ARRAY)for(var f=0;f<o;++f)c.putImageData(a(f),f*t,0);else c.putImageData(a(0),0,0);var l=u.toDataURL("image/png"),h=document.createElement("a");h.setAttribute("href",l),h.setAttribute("download","image.png"),h.style.display="none",document.body.appendChild(h),h.click(),document.body.removeChild(h)}}]),e}()},function(t,e){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},function(t,e){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(3),i=n.n(r),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=u(["\n  layout(location=0) in vec2 a_Position;\n  out vec2 v_Position;\n  void main() {\n    gl_Position = vec4(a_Position, 0.0, 1.0);\n    v_Position = a_Position * 0.5 + 0.5;\n  }\n"],["\n  layout(location=0) in vec2 a_Position;\n  out vec2 v_Position;\n  void main() {\n    gl_Position = vec4(a_Position, 0.0, 1.0);\n    v_Position = a_Position * 0.5 + 0.5;\n  }\n"]),s=u(["\n  in vec2 v_Position;\n  ","\n  void main() {\n    o_Color = func();\n  }\n"],["\n  in vec2 v_Position;\n  ","\n  void main() {\n    o_Color = func();\n  }\n"]);function u(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var c=i()(a),f=function(t){return i()(s,t)},l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,this.shader=new e.Shader(c,f(n))}return o(t,[{key:"apply",value:function(t,e){return e&&(e.bind(),e.clear()),this.shader.sampler("u_Source",t),this.shader.render(this.renderer.quad),e&&e.unbind(),e}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(34),i=n(238),o=n.n(i),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};var s=function(t){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=i.defines,u=void 0===s?{}:s,c=i.filter,f=i.fragments,l=void 0===f?{}:f,h=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(i,["defines","filter","fragments"]);return u=a({},u),n.forEach(function(t,e){c&&!c(t)||(u["ATTRIBUTE_"+t]=e)}),(l=a({},l)).declarations||(l.declarations="uniform mat4 u_ViewProjectionMatrix;"),l.output_func||(l.output_func="gl_Position = u_ViewProjectionMatrix * posW;"),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o.a,r,a({defines:u,fragments:l},h)))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r["a"]),e}()},function(t,e,n){n(76),t.exports=n(82)},function(t,e,n){"use strict";"undefined"===typeof Promise&&(n(77).enable(),window.Promise=n(79)),n(80),Object.assign=n(81)},function(t,e,n){"use strict";var r=n(37),i=[ReferenceError,TypeError,RangeError],o=!1;function a(){o=!1,r._47=null,r._71=null}function s(t,e){return e.some(function(e){return t instanceof e})}e.disable=a,e.enable=function(t){t=t||{},o&&a();o=!0;var e=0,n=0,u={};function c(e){(t.allRejections||s(u[e].error,t.whitelist||i))&&(u[e].displayId=n++,t.onUnhandled?(u[e].logged=!0,t.onUnhandled(u[e].displayId,u[e].error)):(u[e].logged=!0,function(t,e){console.warn("Possible Unhandled Promise Rejection (id: "+t+"):"),((e&&(e.stack||e))+"").split("\n").forEach(function(t){console.warn("  "+t)})}(u[e].displayId,u[e].error)))}r._47=function(e){var n;2===e._83&&u[e._56]&&(u[e._56].logged?(n=e._56,u[n].logged&&(t.onHandled?t.onHandled(u[n].displayId,u[n].error):u[n].onUnhandled||(console.warn("Promise Rejection Handled (id: "+u[n].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+u[n].displayId+".")))):clearTimeout(u[e._56].timeout),delete u[e._56])},r._71=function(t,n){0===t._75&&(t._56=e++,u[t._56]={displayId:null,error:n,timeout:setTimeout(c.bind(null,t._56),s(n,i)?100:2e3),logged:!1})}}},function(t,e,n){"use strict";(function(e){function n(t){i.length||(r(),!0),i[i.length]=t}t.exports=n;var r,i=[],o=0,a=1024;function s(){for(;o<i.length;){var t=o;if(o+=1,i[t].call(),o>a){for(var e=0,n=i.length-o;e<n;e++)i[e]=i[e+o];i.length-=o,o=0}}i.length=0,o=0,!1}var u,c,f,l="undefined"!==typeof e?e:self,h=l.MutationObserver||l.WebKitMutationObserver;function d(t){return function(){var e=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(e),clearInterval(n),t()}}}"function"===typeof h?(u=1,c=new h(s),f=document.createTextNode(""),c.observe(f,{characterData:!0}),r=function(){u=-u,f.data=u}):r=d(s),n.requestFlush=r,n.makeRequestCallFromTimer=d}).call(e,n(21))},function(t,e,n){"use strict";var r=n(37);t.exports=r;var i=f(!0),o=f(!1),a=f(null),s=f(void 0),u=f(0),c=f("");function f(t){var e=new r(r._44);return e._83=1,e._18=t,e}r.resolve=function(t){if(t instanceof r)return t;if(null===t)return a;if(void 0===t)return s;if(!0===t)return i;if(!1===t)return o;if(0===t)return u;if(""===t)return c;if("object"===typeof t||"function"===typeof t)try{var e=t.then;if("function"===typeof e)return new r(e.bind(t))}catch(t){return new r(function(e,n){n(t)})}return f(t)},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){if(0===e.length)return t([]);var i=e.length;function o(a,s){if(s&&("object"===typeof s||"function"===typeof s)){if(s instanceof r&&s.then===r.prototype.then){for(;3===s._83;)s=s._18;return 1===s._83?o(a,s._18):(2===s._83&&n(s._18),void s.then(function(t){o(a,t)},n))}var u=s.then;if("function"===typeof u)return void new r(u.bind(s)).then(function(t){o(a,t)},n)}e[a]=s,0===--i&&t(e)}for(var a=0;a<e.length;a++)o(a,e[a])})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){t.forEach(function(t){r.resolve(t).then(e,n)})})},r.prototype.catch=function(t){return this.then(null,t)}},function(t,e){!function(t){"use strict";if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(t){return t&&DataView.prototype.isPrototypeOf(t)},i=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};f.prototype.append=function(t,e){t=s(t),e=u(e);var n=this.map[t];this.map[t]=n?n+","+e:e},f.prototype.delete=function(t){delete this.map[s(t)]},f.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},f.prototype.set=function(t,e){this.map[s(t)]=u(e)},f.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},f.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),c(t)},f.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),c(t)},f.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),c(t)},e.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},p.call(E.prototype),p.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},v.error=function(){var t=new v(null,{status:0,statusText:""});return t.type="error",t};var a=[301,302,303,307,308];v.redirect=function(t,e){if(-1===a.indexOf(e))throw new RangeError("Invalid status code");return new v(null,{status:e,headers:{location:t}})},t.Headers=f,t.Request=E,t.Response=v,t.fetch=function(t,n){return new Promise(function(r,i){var o=new E(t,n),a=new XMLHttpRequest;a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new f,t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new v(i,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials&&(a.withCredentials=!0),"responseType"in a&&e.blob&&(a.responseType="blob"),o.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),a.send("undefined"===typeof o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}function s(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!==typeof t&&(t=String(t)),t}function c(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(n[Symbol.iterator]=function(){return n}),n}function f(t){this.map={},t instanceof f?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function l(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function h(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function d(t){var e=new FileReader,n=h(e);return e.readAsArrayBuffer(t),n}function _(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"===typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&r(t))this._bodyArrayBuffer=_(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!i(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=_(t)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=l(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t,e,n,r=l(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=h(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function E(t,e){var n,r,i=(e=e||{}).body;if(t instanceof E){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),o.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function v(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!==typeof self?self:this)},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,s=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))i.call(n,c)&&(s[c]=n[c]);if(r){a=r(n);for(var f=0;f<a.length;f++)o.call(n,a[f])&&(s[a[f]]=n[a[f]])}}return s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(83),i=(n.n(r),n(84));Object(i.a)(document.getElementById("root"))},function(t,e){},function(t,e,n){"use strict";e.a=function(t){var e=document.createElement("canvas");function n(){e.width=window.innerWidth,e.height=window.innerHeight}t.appendChild(e),n(),window.addEventListener("resize",n);var r=new B(e,t);requestAnimationFrame(function t(e){r.update(e),requestAnimationFrame(t)})};var r=n(0),i=n(94),o=(n.n(i),n(95)),a=n(168),s=n(201),u=n(257),c=n(258),f=n(259),l=(n(2),function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()),h=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _=-5,p=-8,E=5,g=-20,v=20,A=-10,T=15,y=0,m=1-2*y,b=_,R=E-_,N=p,I=20,M=function(t){return t/2e3+1},O=[[1,0,0],[0,1,0],[0,0,1],[.5,1,0],[1,1,0],[0,1,1],[1,0,1],[.7,.7,.7],[0,0,0]],P=null,S=null,x=[" ###  ##  #   # ####      ##  #  # #### ### ","#    #  # ## ## #        #  # #  # #    #  #","#  # #### # # # ###      #  # #  # ###  ### ","#  # #  # #   # #        #  #  # # #    #  #"," ##  #  # #   # ####      ##    ## #### #  #"],w=[[[0,0],[1,0],[2,0],[3,0]],[[0,0],[1,0],[0,1],[1,1]],[[0,0],[1,0],[2,0],[1,1]],[[0,0],[1,0],[2,0],[2,1]],[[0,0],[1,0],[2,0],[0,1]],[[1,0],[2,0],[0,1],[1,1]],[[0,0],[1,0],[1,1],[2,1]]];function L(t,e){return t.map(function(t){var n=h(t,2),r=n[0],i=n[1];switch(e){case 0:return[r,i];case 1:return[i,-r-1];case 2:return[-r-1,-i-1];case 3:return[-i-1,r]}})}function F(t){var e=10,n=10,r=-10,i=-10;return t.forEach(function(t){var o=h(t,2),a=o[0],s=o[1];e=Math.min(e,a),n=Math.min(n,s),r=Math.max(r,a+1),i=Math.max(i,s+1)}),[(e+r)/2,(n+i)/2]}function U(t,e){return new f.a("box",[t.clone(P[e])])}function C(t,e,n,i,o,a,s){var u=(t+i)/2,f=(e+o)/2,l=(n+a)/2,h=(i-t)/2,d=(o-e)/2,_=(a-n)/2,p=new c.a;return p.matrix=r.e.fromValues(h,0,0,0,0,d,0,0,0,0,_,0,u,f,l,1),p.mesh=s,p}var D=function(){function t(e,n,r,i,o){d(this,t),this.x0=e,this.y0=n,this.width=r,this.height=i,this.world=o,this.grid=[];for(var a=0;a<i;++a)this.grid[a]=[];this.dropped=[],this.bodies=[],this.node=new c.a}return l(t,[{key:"addBlock",value:function(t,e,n){if(e>=this.height)return!1;var i=new c.a;return i.translation=r.g.fromValues(this.x0+t+.5,this.y0+e+.5,.5),i.scale=r.g.fromValues(.5-y,.5-y,.5-y),i.mesh=U(S,n),this.node.addChild(i),this.grid[e][t]=i,!0}},{key:"dropRows",value:function(t){this.bodies=[];var e=0,n=0,i=0;this.dropStart=this.world.frame;for(var o=0;o<=this.height;++o)if(o>=this.height||t.indexOf(o)>=0){if(n){var s=new a.a.RigidBody("slice");r.g.set(s.position,this.x0,this.y0,0),s.calculateTransform(),s.lockAxis(r.g.posY),s.setMoves(!0,!1),this.world.addBody(s),this.bodies.push(s);for(var u=e;u<o;++u)for(var c=0;c<this.width;++c){var f=this.grid[u][c];if(f){i&&(this.grid[u][c]=null,this.grid[u-i][c]=f);var l=new a.a.shapes.Box(c+y,u+y,y,m,m,m);s.addShape(l),delete f.translation,delete f.scale,f.matrix=l.transform}}}if(o<this.height){for(var h=0;h<this.width;++h){var d=this.grid[o][h];if(d){if(this.dropped.length>=100){var _=this.dropped.shift();this.world.removeBody(_.body),this.node.removeChild(_.node)}var p=new a.a.RigidBody("dropped");r.g.set(p.position,this.x0+h,this.y0+o,0),r.g.set(p.velocity,0,0,3*Math.random()+3),p.calculateTransform(),p.addShape(new a.a.shapes.Box(y,y,y,m,m,m)),p.shapes[0].material.friction=.5,this.world.addBody(p),delete d.translation,delete d.scale,d.matrix=p.shapes[0].transform,this.dropped.push({node:d,body:p}),this.grid[o][h]=null}}++i}e=o+1,n=0}else for(var E=0;E<this.width;++E)this.grid[o][E]&&++n}},{key:"stopDrop",value:function(){var t=this;if(this.bodies.length){for(var e=0;e<this.height;++e)for(var n=0;n<this.width;++n){var i=this.grid[e][n];i&&(delete i.matrix,i.translation=r.g.fromValues(this.x0+n+.5,this.y0+e+.5,.5),i.scale=r.g.fromValues(.5-y,.5-y,.5-y))}this.bodies.forEach(function(e){return t.world.removeBody(e)}),this.bodies=[]}}},{key:"isDropping",value:function(){return!!(this.bodies.length&&this.world.frame<this.dropStart+50)||!(this.world.frame-this.dropStart>180)&&this.bodies.some(function(t){return r.g.length(t.velocity)>.05})}},{key:"pieceFits",value:function(t,e,n,r){var i=this;return L(w[t],r).every(function(t){var r=h(t,2),o=r[0],a=r[1];return!(n+a<0)&&(!i.grid[n+a]||!i.grid[n+a][e+o])})}},{key:"needsStop",value:function(t,e,n,r,i){for(var o=n;o>=r;--o)if(!this.pieceFits(t,e,o,i)){do{++o}while(!this.pieceFits(t,e,o,i));return o}}},{key:"addPiece",value:function(t,e,n,r){var i=this;return L(w[t],r).every(function(r){var o=h(r,2),a=o[0],s=o[1];return i.addBlock(e+a,n+s,t)})}},{key:"fullRows",value:function(){for(var t=[],e=0;e<this.height;++e){for(var n=!0,r=0;r<this.width;++r)if(!this.grid[e][r]){n=!1;break}n&&t.push(e)}return t}},{key:"reset",value:function(){for(var t=this,e=0;e<this.height;++e)this.grid[e]=[];this.dropped.forEach(function(e){return t.world.removeBody(e.body)}),this.node.children=[]}}]),t}(),B=function(){function t(e,n){var i=this;d(this,t),this.scene=new c.a,this.world=new a.a.World,this.score=0,this.gameOver=!1,this.camera=new u.a({xfov:100*Math.PI/180,znear:.5},r.e.fromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,28,1)),this.onKeyDown=function(t){i.curPiece?"ArrowLeft"===t.key?i.movePiece(-1):"ArrowRight"===t.key?i.movePiece(1):"ArrowUp"===t.key?i.rotatePiece(1):"ArrowDown"===t.key?i.rotatePiece(-1):" "===t.key&&(i.fastDrop=!0):i.gameOver&&" "===t.key&&(i.gameOver=!1,i.score=0,i.scoreDiv.innerText="Score: 0",i.scene.removeChild(i.gameOverNode),r.g.set(i.bigLight.light.color,.7,.7,.7),i.board.reset())},this.canvas=e,this.root=n;var l=this.renderer=new s.a(e);l.reflection=!0,S=Object(o.a)(l),P=O.map(function(t){var e,n=(e=new l.Material).setColor.apply(e,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t));return n.metallicFactor=.7,n.roughnessFactor=.4,n}),this.shadow=l.extension("OES_texture_float_linear")?new l.Shadows.VSM(256,4,!0):new l.Shadows.PCF(256,1),a.a.config.defaultMaterial.friction=0,a.a.config.defaultMaterial.frictionCombine=a.a.config.combiners.minimum,r.g.set(a.a.config.defaultGravity,0,-5,0);var h=new a.a.RigidBody("ground");h.setMoves(!1),this.world.addBody(h),h.addShape(new a.a.shapes.Box(g,p,0,_-g,T-p,1)),h.addShape(new a.a.shapes.Box(E,p,0,v-E,T-p,1)),h.addShape(new a.a.shapes.Box(g,A,0,v-g,p-A,1));var m=new a.a.shapes.Plane([0,1,0],p-1);m.material.friction=.5,h.addShape(m);var M=U(l.primitives.Box,7);this.scene.addChild(C(g,A,-1,v,T,0,M),C(g,p,0,_,T,1,M),C(E,p,0,v,T,1,M),C(g,A,0,v,p,1,M),C(g,A,1,v,p-1,10,M)),this.board=new D(b,N,R,I,this.world),this.scene.addChild(this.board.node),this.offsetNode=new c.a,this.offsetNode.translation=r.g.fromValues(this.board.x0,this.board.y0,0),this.scene.addChild(this.offsetNode),this.bigLight=new c.a;var w=this.bigLight.light=new l.Lights.Spot(this.bigLight.worldMatrix,[.7,.7,.7]);w.shadow=this.shadow,w.minAngle=60,w.maxAngle=120,this.bigLight.translation=r.g.fromValues(0,0,12),this.bigLight.rotation=r.f.create(),document.addEventListener("keydown",this.onKeyDown,!0),this.scoreDiv=document.createElement("div"),this.scoreDiv.className="score",n.appendChild(this.scoreDiv),this.scoreDiv.innerText="Score: 0";var L=(new l.Material).setColor(1,0,0);r.g.set(L.emissiveFactor,.4,0,0),L.metallicFactor=0,L.roughnessFactor=0;for(var F=new f.a("box",[S.clone(L)]),B=this.gameOverNode=new c.a,X=0;X<x.length;++X)for(var j=0;j<x[X].length;++j)if("#"===x[X][j]){var k=new c.a;k.mesh=F,k.translation=r.g.fromValues(j,x.length-X-1,0),k.scale=r.g.fromValues(.5-y,.5-y,.5-y),B.addChild(k)}B.scale=r.g.fromValues(.25,.25,.25),B.translation=r.g.fromValues(.125*-x[0].length,.125*-x.length,2)}return l(t,[{key:"update",value:function(t){this.canvas.width/this.canvas.height<1?(delete this.camera.props.yfov,this.camera.props.xfov=Math.PI/4):(delete this.camera.props.xfov,this.camera.props.yfov=Math.PI/4),this.lastTime||(this.lastTime=t);var e=t-this.lastTime;if(this.curPiece){var n=this.curPiece,i=n.index,o=n.rotation,a=h(n.position,2),s=a[0],u=a[1],c=u-(this.fastDrop?.02:.002*M(this.score))*e,f=this.board.needsStop(i,s,Math.floor(u),Math.floor(c),o);if(null!=f)if(this.offsetNode.removeChild(this.curPiece.node),this.curPiece=null,this.board.addPiece(i,s,f,o)){var l=this.board.fullRows();l.length&&(this.board.dropRows(l),this.score+=l.length*(l.length+1)/2*100,this.scoreDiv.innerText="Score: "+this.score)}else this.gameOver=!0,this.scene.addChild(this.gameOverNode),r.g.set(this.bigLight.light.color,1,0,0);else this.curPiece.position[1]=c}this.gameOver||this.board.isDropping()?this.scene.addChild(this.bigLight):(this.board.stopDrop(),this.curPiece||this.startPiece(Math.floor(7*Math.random())%7,0),this.scene.removeChild(this.bigLight)),this.world.update(t/1e3),this.renderer.render(this.camera,this.scene),this.lastTime=t}},{key:"adjustX",value:function(t,e,n){var r=L(w[e],n),i=r.reduce(function(t,e){var n=h(e,1)[0];return Math.min(t,n)},10),o=r.reduce(function(t,e){var n=h(e,1)[0];return Math.max(t,n+1)},0);return t+i<0?t=-i:t+o>this.board.width&&(t=this.board.width-o),t}},{key:"movePiece",value:function(t){var e=this.curPiece,n=this.adjustX(e.position[0]+t,e.index,e.rotation);this.board.pieceFits(e.index,n,Math.floor(e.position[1]),e.rotation)&&(e.position[0]=n)}},{key:"rotatePiece",value:function(t){var e=this.curPiece,n=(e.rotation+t+4)%4,i=F(L(w[e.index],e.rotation)),o=F(L(w[e.index],n)),a=1&n?.1:-.1,s=this.adjustX(Math.round(e.position[0]+i[0]-o[0]+a),e.index,n);this.board.pieceFits(e.index,s,Math.floor(e.position[1]+i[1]-o[1]),n)&&(e.position[0]=s,e.position[1]+=i[1]-o[1],e.rotation=n,r.f.identity(e.node.rotation),r.f.rotateZ(e.node.rotation,e.node.rotation,-n*Math.PI/2))}},{key:"startPiece",value:function(t,e){var n=F(L(w[t],e)),i=Math.round(this.board.width/2-n[0]),o=this.board.height-n[1],a=U(S,t),s=new c.a;s.translation=r.g.fromValues(i,o,0),s.rotation=r.f.create(),s.children=w[t].map(function(t){var e=h(t,2),n=e[0],i=e[1],o=new c.a;return o.translation=r.g.fromValues(n+.5,i+.5,.5),o.scale=r.g.fromValues(.5-y,.5-y,.5-y),o.mesh=a,o}),this.offsetNode.addChild(s),r.f.rotateZ(s.rotation,s.rotation,-e*Math.PI/2);var u=F(w[t]),f=new c.a;f.translation=r.g.fromValues(u[0],u[1],Math.max(2,6/M(this.score))),s.children.push(f);var l=new this.renderer.Lights.Spot(f.worldMatrix,[.7,.7,.7]);l.shadow=this.shadow,f.light=l,l.maxAngle=50,l.maxAngle=140,this.fastDrop=!1,this.curPiece={node:s,position:s.translation,rotation:e,index:t}}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){return new Float32Array(6)},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.clone=function(t){return new Float32Array(t)},e.set=function(t,e,n,r,i,o,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t},e.setVec3=function(t,e){return t[0]=t[3]=e[0],t[1]=t[4]=e[1],t[2]=t[5]=e[2],t},e.fromValues=function(t,e,n,r,i,o){var a=new Float32Array(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a},e.combine=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t[4]=Math.max(e[4],n[4]),t[5]=Math.max(e[5],n[5]),t},e.intersect=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t[4]=Math.min(e[4],n[4]),t[5]=Math.min(e[5],n[5]),t},e.empty=function(t){return t[0]>=t[3]||t[1]>=t[4]||t[2]>=t[5]},e.containsVec3=function(t,e){return e[0]>=t[0]&&e[0]<t[3]&&e[1]>=t[1]&&e[1]<t[4]&&e[2]>=t[2]&&e[2]<t[5]},e.contains=function(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[3]<=t[3]&&e[4]<=t[4]&&e[5]<=t[5]},e.intersects=function(t,e){return e[3]>t[0]&&e[0]<t[3]&&e[4]>t[1]&&e[1]<t[4]&&e[5]>t[2]&&e[2]<t[5]},e.combineVec3=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.max(e[3],n[0]),t[4]=Math.max(e[4],n[1]),t[5]=Math.max(e[5],n[2]),t},e.grow=function(t,e,n){return t[0]=e[0]-n,t[1]=e[1]-n,t[2]=e[2]-n,t[3]=e[3]+n,t[4]=e[4]+n,t[5]=e[5]+n,t},e.area=function(t){var e=t[3]-t[0],n=t[4]-t[1],r=t[5]-t[2];return 2*(e*(n+r)+n*r)},e.extents=function(t,e,n){var r=n[0],i=n[1],o=n[2];r>0?(t[0]=e[0]*r,t[1]=e[3]*r):(t[0]=e[3]*r,t[1]=e[0]*r);i>0?(t[0]+=e[0]*i,t[1]+=e[3]*i):(t[0]+=e[3]*i,t[1]+=e[0]*i);o>0?(t[0]+=e[0]*o,t[1]+=e[3]*o):(t[0]+=e[3]*o,t[1]+=e[0]*o);return t},e.fromMat4=function(t,e){var n=e[12],r=e[13],i=e[14],o=Math.abs(e[0])+Math.abs(e[4])+Math.abs(e[8]),a=Math.abs(e[1])+Math.abs(e[5])+Math.abs(e[9]),s=Math.abs(e[2])+Math.abs(e[6])+Math.abs(e[10]);return t[0]=n-o,t[1]=r-a,t[2]=i-s,t[3]=n+o,t[4]=r+a,t[5]=i+s,t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new r.a(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){let e=new r.a(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,i){let o=new r.a(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.transpose=function(t,e){if(t===e){let n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;if(!a)return null;return a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t},e.adjoint=function(t,e){let n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=i,e.rotate=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t},e.scale=function(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t},e.fromRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=o,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){let n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],c=e[2],f=e[3];return Math.abs(n-s)<=r.b*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.b*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.b*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-f)<=r.b*Math.max(1,Math.abs(a),Math.abs(f))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t};var r=n(4);function i(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],f=n[3];return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*c+o*f,t[3]=i*c+a*f,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}const a=i;e.mul=a;const s=o;e.sub=s},function(t,e,n){"use strict";n(4)},function(t,e,n){"use strict";n(4);var r=n(41);n(40);r.copy;r.copy;r.dot;r.length,r.squaredLength},function(t,e,n){"use strict";var r=n(4);!function(){let t=function(){let t=new r.a(2);return t[0]=0,t[1]=0,t}()}()},function(t,e,n){"use strict";var r=n(23);n.d(e,"a",function(){return r.a}),n.d(e,"b",function(){return r.b}),n.d(e,"c",function(){return r.c}),r.b.makeBasis=function(t){var e=t[0],n=t[1],r=t[2];if(Math.abs(e)>Math.abs(n)){var i=1/Math.sqrt(e*e+r*r);t[6]=-r*i,t[7]=0,t[8]=e*i,t[3]=-n*t[8],t[4]=e*t[8]-r*t[6],t[5]=n*t[6]}else{var o=1/Math.sqrt(n*n+r*r);t[6]=0,t[7]=r*o,t[8]=-n*o,t[3]=r*t[7]-n*t[8],t[4]=e*t[8],t[5]=-e*t[7]}},r.b.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t},r.b.diagonal=function(t,e,n,r){return t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=r,t},r.b.transform=function(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],f=n[7],l=n[8],h=e[0],d=e[1],_=e[2],p=e[3],E=e[4],g=e[5],v=e[6],A=e[7],T=e[8],y=r*h+a*p+c*v,m=r*d+a*E+c*A,b=r*_+a*g+c*T,R=i*h+s*p+f*v,N=i*d+s*E+f*A,I=i*_+s*g+f*T,M=o*h+u*p+l*v,O=o*d+u*E+l*A,P=o*_+u*g+l*T;return t[0]=y*r+m*a+b*c,t[1]=y*i+m*s+b*f,t[2]=y*o+m*u+b*l,t[3]=R*r+N*a+I*c,t[4]=R*i+N*s+I*f,t[5]=R*o+N*u+I*l,t[6]=M*r+O*a+P*c,t[7]=M*i+O*s+P*f,t[8]=M*o+O*u+P*l,t},r.b.transformInv=function(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],f=n[7],l=n[8],h=e[0],d=e[1],_=e[2],p=e[3],E=e[4],g=e[5],v=e[6],A=e[7],T=e[8],y=r*h+i*p+o*v,m=r*d+i*E+o*A,b=r*_+i*g+o*T,R=a*h+s*p+u*v,N=a*d+s*E+u*A,I=a*_+s*g+u*T,M=c*h+f*p+l*v,O=c*d+f*E+l*A,P=c*_+f*g+l*T;return t[0]=y*r+m*i+b*o,t[1]=y*a+m*s+b*u,t[2]=y*c+m*f+b*l,t[3]=R*r+N*i+I*o,t[4]=R*a+N*s+I*u,t[5]=R*c+N*f+I*l,t[6]=M*r+O*i+P*o,t[7]=M*a+O*s+P*u,t[8]=M*c+O*f+P*l,t},r.b.multiplyT=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],l=e[8],h=n[0],d=n[1],_=n[2],p=n[3],E=n[4],g=n[5],v=n[6],A=n[7],T=n[8];return t[0]=h*r+p*a+v*c,t[1]=h*i+p*s+v*f,t[2]=h*o+p*u+v*l,t[3]=d*r+E*a+A*c,t[4]=d*i+E*s+A*f,t[5]=d*o+E*u+A*l,t[6]=_*r+g*a+T*c,t[7]=_*i+g*s+T*f,t[8]=_*o+g*u+T*l,t},r.b.vectorT=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=r*a,t[1]=i*a,t[2]=o*a,t[3]=r*s,t[4]=i*s,t[5]=o*s,t[6]=r*u,t[7]=i*u,t[8]=o*u,t},r.c.multiplyMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[4],s=e[5],u=e[6],c=e[8],f=e[9],l=e[10],h=n[0],d=n[1],_=n[2],p=n[3],E=n[4],g=n[5],v=n[6],A=n[7],T=n[8];return t[0]=h*r+d*a+_*c,t[1]=h*i+d*s+_*f,t[2]=h*o+d*u+_*l,t[3]=p*r+E*a+g*c,t[4]=p*i+E*s+g*f,t[5]=p*o+E*u+g*l,t[6]=v*r+A*a+T*c,t[7]=v*i+A*s+T*f,t[8]=v*o+A*u+T*l,t},r.b.copyTo4x3=function(t,e){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[4]=e[3],t[5]=e[4],t[6]=e[5],t[8]=e[6],t[9]=e[7],t[10]=e[8]},r.c.fromAABB=function(t,e){var n=(e[3]-e[0])/2,r=(e[4]-e[1])/2,i=(e[5]-e[2])/2,o=e[0]+n,a=e[1]+r,s=e[2]+i;return t[0]=n,t[1]=0,t[2]=0,t[3]=o,t[4]=0,t[5]=r,t[6]=0,t[7]=a,t[8]=0,t[9]=0,t[10]=i,t[11]=s,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.c.fromColumns=function(t,e,n,r){var i=new Float32Array(16);return i.set(t,0),i.set(e,4),i.set(n,8),r&&i.set(r,11),i[15]=1,i},r.c.fromRows=function(t,e,n,r){var i=new Float32Array(16);return i[0]=t[0],i[4]=t[1],i[8]=t[2],i[1]=e[0],i[5]=e[1],i[9]=e[2],i[2]=n[0],i[6]=n[1],i[10]=n[2],r&&(i[3]=r[0],i[7]=r[1],i[11]=r[2]),i[15]=1,i}},function(t,e,n){"use strict";var r=n(23);n.d(e,"a",function(){return r.d}),r.d.adjustVec3=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=e[0],a=e[1],s=e[2],u=e[3],c=n[0]*i*.5,f=n[1]*i*.5,l=n[2]*i*.5;return t[0]=o+u*c+s*f-a*l,t[1]=a+o*l+u*f-s*c,t[2]=s+a*c-o*f+u*l,t[3]=u-o*c-a*f-s*l,r.d.normalize(t,t),t}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(22),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=r.a.create(),a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos=e,this.dir=n}return i(t,[{key:"distance",value:function(t){var e=r.a.subtract(o,t,this.pos),n=r.a.length(e),i=r.a.dot(this.dir,e);return i<0?n:Math.sqrt(n*n-i*i)}},{key:"along",value:function(t){var e=r.a.subtract(o,t,this.pos);return r.a.dot(this.dir,e)}}]),t}()},function(t,e,n){"use strict";var r=n(22),i=n(38),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=r.a.create();!function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rays=e,this.near=n,this.far=r}o(t,[{key:"numPlanes",value:function(){return this.rays.length+2}},{key:"getPlane",value:function(t,e){if(0===e)i.a(t,this.near);else if(1===e)i.a(t,this.far);else{var n=e-2,o=(n+1)%this.rays.length,s=this.rays[n].dir,u=this.rays[o].dir,c=this.rays[n].pos;r.a.cross(a,s,u),i.c(t,a,c)}return t}},{key:"numPoints",value:function(){return 2*this.rays.length}},{key:"getPoint",value:function(t,e){return e<this.rays.length?i.b(t,this.near,this.rays[e]):i.b(t,this.far,this.rays[e-this.rays.length]),t}},{key:"origin",get:function(){return this.rays[0].pos}}])}()},function(t,e){},function(t,e,n){"use strict";e.a=function(t){for(var e=[],n=0;n<4;++n){var i=n/4*Math.PI/2,o=Math.cos(i)-.001;e.push(Math.ceil(4*o))}e.push(0);var u=8*e.reduce(function(t,e){return t+e+1},0),c=new r.a(144+u,s),f=a.g.create(),l=a.g.create(),h=[],d=function(t,e,n,r){if(0===n)return t;if(n===r)return e;var i=n/r*Math.PI/2,o=a.g.scale(new Float32Array(3),t,Math.cos(i));return a.g.scaleAndAdd(o,o,e,Math.sin(i))},_=function(t,e,n,r){for(var i=[],o=[],s=0;s<=4;++s){var u=d(n,r,s,4);a.g.scaleAndAdd(l,t,u,.2),i.push(c.add({POSITION:l,NORMAL:u})),a.g.scaleAndAdd(l,e,u,.2),o.push(c.add({POSITION:l,NORMAL:u}))}for(var f=0;f<4;++f){var _=i[f],p=i[f+1],E=o[f],g=o[f+1];h.push(_,p,g,_,g,E)}},p=function(t,e,n,r,i){a.g.subtract(f,e,t),a.g.subtract(l,n,t),a.g.cross(f,f,l),a.g.dot(f,i),a.g.scaleAndAdd(f,t,i,.2);var o=c.add({POSITION:f,NORMAL:i});a.g.scaleAndAdd(f,e,i,.2);var s=c.add({POSITION:f,NORMAL:i});a.g.scaleAndAdd(f,n,i,.2);var u=c.add({POSITION:f,NORMAL:i});a.g.scaleAndAdd(f,r,i,.2);var d=c.add({POSITION:f,NORMAL:i});h.push(o,s,d,o,d,u)},E=function(t,n,r,i){for(var o=[],s=0;s<=4;++s){o[s]=[];for(var u=e[s],f=0;f<=u;++f){var _=d(d(n,r,f,u),i,s,4);a.g.scaleAndAdd(l,t,_,.2),o[s].push({index:c.add({POSITION:l,NORMAL:_}),t:f/u})}}for(var p=0;p<4;++p)for(var E=o[p],g=o[p+1],v=1,A=1,T=E[0].index,y=g[0].index;v<E.length||A<g.length;)A>=g.length||v<E.length&&E[v].t<g[A].t?(h.push(T,E[v].index,y),T=E[v++].index):(h.push(T,g[A].index,y),y=g[A++].index)},g=-.8,v=[g,g,g],A=[.8,g,g],T=[g,.8,g],y=[.8,.8,g],m=[g,g,.8],b=[.8,g,.8],R=[g,.8,.8],N=[.8,.8,.8];return p(T,v,R,m,a.g.negX),p(A,y,b,N,a.g.posX),p(v,A,m,b,a.g.negY),p(y,T,N,R,a.g.posY),p(A,v,y,T,a.g.negZ),p(m,b,R,N,a.g.posZ),_(v,A,a.g.negY,a.g.negZ),_(T,y,a.g.negZ,a.g.posY),_(m,b,a.g.posZ,a.g.negY),_(R,N,a.g.posY,a.g.posZ),_(v,T,a.g.negZ,a.g.negX),_(A,y,a.g.posX,a.g.negZ),_(m,R,a.g.negX,a.g.posZ),_(b,N,a.g.posZ,a.g.posX),_(v,m,a.g.negX,a.g.negY),_(A,b,a.g.negY,a.g.posX),_(T,R,a.g.posY,a.g.negX),_(y,N,a.g.posX,a.g.posY),E(v,a.g.negX,a.g.negZ,a.g.negY),E(A,a.g.posX,a.g.negY,a.g.negZ),E(T,a.g.negX,a.g.posY,a.g.negZ),E(y,a.g.posX,a.g.negZ,a.g.posY),E(m,a.g.negX,a.g.negY,a.g.posZ),E(b,a.g.posX,a.g.posZ,a.g.negY),E(R,a.g.negX,a.g.posZ,a.g.posY),E(N,a.g.posX,a.g.posY,a.g.posZ),c.build(t,h)};var r=n(7),i=n(14),o=n(2),a=n(0),s=new i.a({POSITION:o.FLOAT,NORMAL:o.FLOAT})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(97);Object.defineProperty(e,"hfround",{enumerable:!0,get:function(){return a(r).default}});var i=n(98);Object.defineProperty(e,"Float16Array",{enumerable:!0,get:function(){return a(i).default}});var o=n(167);function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"getFloat16",{enumerable:!0,get:function(){return o.getFloat16}}),Object.defineProperty(e,"setFloat16",{enumerable:!0,get:function(){return o.setFloat16}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(t=Number(t),!Number.isFinite(t)||0===t)return t;const e=(0,r.roundToFloat16Bits)(t);return(0,r.convertToNumber)(e)};var r=n(24);t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(99)),i=n(57),o=n(58),a=n(137),s=f(n(138)),u=n(24),c=n(166);function f(t){return t&&t.__esModule?t:{default:t}}const l=(0,a.createPrivateStorage)(),h=Symbol("target");function d(t){return t instanceof v}function _(t){if(!d(t))throw new TypeError("This is not a Float16Array")}function p(t){const e=t.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=(0,u.convertToNumber)(t[r]);return n}const E={apply(t,e,n){return d(e)&&("function"===typeof(r=t)&&T.has(r))?Reflect.apply(t,c.isProxyAbleToBeWeakMapKey?l(e).target:e[h],n):Reflect.apply(t,e,n);var r}},g={get(t,e){let n=null;if(c.isTypedArrayIndexedPropertyWritable||(t=l(n=t).target),(0,o.isStringNumberKey)(e))return Reflect.has(t,e)?(0,u.convertToNumber)(Reflect.get(t,e)):void 0;{const r=null!==n&&Reflect.has(n,e)?Reflect.get(n,e):Reflect.get(t,e);if("function"!==typeof r)return r;let i=l(r).proxy;return void 0===i&&(i=l(r).proxy=new Proxy(r,E)),i}},set(t,e,n){let r=null;return c.isTypedArrayIndexedPropertyWritable||(t=l(r=t).target),(0,o.isStringNumberKey)(e)?Reflect.set(t,e,(0,u.roundToFloat16Bits)(n)):null===r||Reflect.has(t,e)&&!Object.isFrozen(r)?Reflect.set(t,e,n):Reflect.set(r,e,n)}};c.isTypedArrayIndexedPropertyWritable||(g.getPrototypeOf=(t=>Reflect.getPrototypeOf(l(t).target)),g.setPrototypeOf=((t,e)=>Reflect.setPrototypeOf(l(t).target,e)),g.defineProperty=((t,e,n)=>{const r=l(t).target;return!Reflect.has(r,e)||Object.isFrozen(t)?Reflect.defineProperty(t,e,n):Reflect.defineProperty(r,e,n)}),g.deleteProperty=((t,e)=>{const n=l(t).target;return Reflect.has(t,e)?Reflect.deleteProperty(t,e):Reflect.deleteProperty(n,e)}),g.has=((t,e)=>Reflect.has(t,e)||Reflect.has(l(t).target,e)),g.isExtensible=(t=>Reflect.isExtensible(t)),g.preventExtensions=(t=>Reflect.preventExtensions(t)),g.getOwnPropertyDescriptor=((t,e)=>Reflect.getOwnPropertyDescriptor(t,e)),g.ownKeys=(t=>Reflect.ownKeys(t)));class v extends Uint16Array{constructor(t,e,n){if(d(t))super(c.isProxyAbleToBeWeakMapKey?l(t).target:t[h]);else if(null===t||"object"!==typeof t||(0,o.isArrayBuffer)(t))switch(arguments.length){case 0:super();break;case 1:super(t);break;case 2:super(t,e);break;case 3:super(t,e,n);break;default:super(...arguments)}else{const e=Reflect.has(t,"length")||void 0===t[Symbol.iterator]?t:[...t],n=e.length;super(n);for(let t=0;t<n;++t)this[t]=(0,u.roundToFloat16Bits)(e[t])}let r;if(c.isTypedArrayIndexedPropertyWritable)r=new Proxy(this,g);else{const t=Object.create(null);l(t).target=this,r=new Proxy(t,g)}return c.isProxyAbleToBeWeakMapKey?l(r).target=this:this[h]=this,l(this).proxy=r,r}static from(t){if(0===(arguments.length<=1?0:arguments.length-1))return new v(Uint16Array.from(t,u.roundToFloat16Bits).buffer);const e=arguments.length<=1?void 0:arguments[1],n=arguments.length<=2?void 0:arguments[2];return new v(Uint16Array.from(t,function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(0,u.roundToFloat16Bits)(e.call(this,t,...r))},n).buffer)}static of(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new v(e)}*[Symbol.iterator](){var t=!0,e=!1,n=void 0;try{for(var r,i=super[Symbol.iterator]()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){const t=r.value;yield(0,u.convertToNumber)(t)}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}keys(){return super.keys()}*values(){var t=!0,e=!1,n=void 0;try{for(var r,i=super.values()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){const t=r.value;yield(0,u.convertToNumber)(t)}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}*entries(){var t=!0,e=!1,n=void 0;try{for(var i,o=super.entries()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){const t=i.value;var a=(0,r.default)(t,2);const e=a[0],n=a[1];yield[e,(0,u.convertToNumber)(n)]}}catch(t){e=!0,n=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw n}}}map(t){_(this);const e=arguments.length<=1?void 0:arguments[1],n=[];for(let r=0,i=this.length;r<i;++r){const i=(0,u.convertToNumber)(this[r]);n.push(t.call(e,i,r,l(this).proxy))}return new v(n)}filter(t){_(this);const e=arguments.length<=1?void 0:arguments[1],n=[];for(let r=0,i=this.length;r<i;++r){const i=(0,u.convertToNumber)(this[r]);t.call(e,i,r,l(this).proxy)&&n.push(i)}return new v(n)}reduce(t){let e,n;_(this),0===(arguments.length<=1?0:arguments.length-1)?(e=(0,u.convertToNumber)(this[0]),n=1):(e=arguments.length<=1?void 0:arguments[1],n=0);for(let r=n,i=this.length;r<i;++r)e=t(e,(0,u.convertToNumber)(this[r]),r,l(this).proxy);return e}reduceRight(t){let e,n;_(this);const r=this.length;0===(arguments.length<=1?0:arguments.length-1)?(e=(0,u.convertToNumber)(this[r-1]),n=r-1):(e=arguments.length<=1?void 0:arguments[1],n=r);for(let r=n;r--;)e=t(e,(0,u.convertToNumber)(this[r]),r,l(this).proxy);return e}forEach(t){_(this);const e=arguments.length<=1?void 0:arguments[1];for(let n=0,r=this.length;n<r;++n)t.call(e,(0,u.convertToNumber)(this[n]),n,l(this).proxy)}find(t){_(this);const e=arguments.length<=1?void 0:arguments[1];for(let n=0,r=this.length;n<r;++n){const r=(0,u.convertToNumber)(this[n]);if(t.call(e,r,n,l(this).proxy))return r}}findIndex(t){_(this);const e=arguments.length<=1?void 0:arguments[1];for(let n=0,r=this.length;n<r;++n){const r=(0,u.convertToNumber)(this[n]);if(t.call(e,r,n,l(this).proxy))return n}return-1}every(t){_(this);const e=arguments.length<=1?void 0:arguments[1];for(let n=0,r=this.length;n<r;++n)if(!t.call(e,(0,u.convertToNumber)(this[n]),n,l(this).proxy))return!1;return!0}some(t){_(this);const e=arguments.length<=1?void 0:arguments[1];for(let n=0,r=this.length;n<r;++n)if(t.call(e,(0,u.convertToNumber)(this[n]),n,l(this).proxy))return!0;return!1}set(t){_(this);const e=arguments.length<=1?void 0:arguments[1];let n;if(d(t))n=c.isProxyAbleToBeWeakMapKey?l(t).target:t[h];else{const e=Reflect.has(t,"length")||void 0===t[Symbol.iterator]?t:[...t],r=e.length;n=new Uint16Array(r);for(let t=0,r=e.length;t<r;++t)n[t]=(0,u.roundToFloat16Bits)(e[t])}super.set(n,e)}reverse(){return _(this),super.reverse(),l(this).proxy}fill(t){_(this);for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return super.fill((0,u.roundToFloat16Bits)(t),...n),l(this).proxy}copyWithin(t,e){_(this);for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return super.copyWithin(t,e,...r),l(this).proxy}sort(){_(this);let t=arguments.length<=0?void 0:arguments[0];void 0===t&&(t=i.defaultCompareFunction);const e=(0,s.default)(u.convertToNumber);return super.sort((n,r)=>t(e(n),e(r))),l(this).proxy}slice(){let t;_(this);try{t=super.slice(...arguments)}catch(e){if(!(e instanceof TypeError))throw e;t=new Uint16Array(this.buffer,this.byteOffset,this.length).slice(...arguments)}return new v(t.buffer)}subarray(){let t;_(this);try{t=super.subarray(...arguments)}catch(e){if(!(e instanceof TypeError))throw e;t=new Uint16Array(this.buffer,this.byteOffset,this.length).subarray(...arguments)}return new v(t.buffer,t.byteOffset,t.length)}indexOf(t){_(this);const e=this.length;let n=(0,i.ToInteger)(arguments.length<=1?void 0:arguments[1]);n<0&&(n+=e)<0&&(n=0);for(let r=n,i=e;r<i;++r)if((0,u.convertToNumber)(this[r])===t)return r;return-1}lastIndexOf(t){_(this);const e=this.length;let n=(0,i.ToInteger)(arguments.length<=1?void 0:arguments[1]);(n=0===n?e:n+1)>=0?n=n<e?n:e:n+=e;for(let e=n;e--;)if((0,u.convertToNumber)(this[e])===t)return e;return-1}includes(t){_(this);const e=this.length;let n=(0,i.ToInteger)(arguments.length<=1?void 0:arguments[1]);n<0&&(n+=e)<0&&(n=0);const r=Number.isNaN(t);for(let i=n,o=e;i<o;++i){const e=(0,u.convertToNumber)(this[i]);if(r&&Number.isNaN(e))return!0;if(e===t)return!0}return!1}join(){return _(this),p(this).join(...arguments)}toLocaleString(){return _(this),p(this).toLocaleString(...arguments)}get[Symbol.toStringTag](){if(d(this))return"Float16Array"}}e.default=v;const A=v.prototype,T=new WeakSet;var y=!0,m=!1,b=void 0;try{for(var R,N=Reflect.ownKeys(A)[Symbol.iterator]();!(y=(R=N.next()).done);y=!0){const t=A[R.value];"function"===typeof t&&T.add(t)}}catch(t){m=!0,b=t}finally{try{!y&&N.return&&N.return()}finally{if(m)throw b}}t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r=o(n(100)),i=o(n(125));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,r.default)(Object(t)))return function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var s,u=(0,i.default)(t);!(r=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,n){t.exports={default:n(101),__esModule:!0}},function(t,e,n){n(44),n(55),t.exports=n(124)},function(t,e,n){"use strict";var r=n(103),i=n(104),o=n(10),a=n(25);t.exports=n(46)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var r=n(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(8),i=n(11),o=n(107),a=n(12),s=n(17),u=function(t,e,n){var c,f,l,h=t&u.F,d=t&u.G,_=t&u.S,p=t&u.P,E=t&u.B,g=t&u.W,v=d?i:i[e]||(i[e]={}),A=v.prototype,T=d?r:_?r[e]:(r[e]||{}).prototype;for(c in d&&(n=e),n)(f=!h&&T&&void 0!==T[c])&&s(v,c)||(l=f?T[c]:n[c],v[c]=d&&"function"!=typeof T[c]?n[c]:E&&f?o(l,r):g&&T[c]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):p&&"function"==typeof l?o(Function.call,l):l,p&&((v.virtual||(v.virtual={}))[c]=l,t&u.R&&A&&!A[c]&&a(A,c,l)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){var r=n(108);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){t.exports=!n(16)&&!n(48)(function(){return 7!=Object.defineProperty(n(49)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(28);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){t.exports=n(12)},function(t,e,n){"use strict";var r=n(113),i=n(50),o=n(54),a={};n(12)(a,n(6)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(15),i=n(114),o=n(53),a=n(30)("IE_PROTO"),s=function(){},u=function(){var t,e=n(49)("iframe"),r=o.length;for(e.style.display="none",n(120).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(27),i=n(15),o=n(115);t.exports=n(16)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var r=n(116),i=n(53);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(17),i=n(25),o=n(117)(!1),a=n(30)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(25),i=n(118),o=n(119);t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),f=o(a,c);if(t&&n!=n){for(;c>f;)if((s=u[f++])!=s)return!0}else for(;c>f;f++)if((t||f in u)&&u[f]===n)return t||f||0;return!t&&-1}}},function(t,e,n){var r=n(29),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){var r=n(29),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(8).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(17),i=n(122),o=n(30)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var r=n(26);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(29),i=n(26);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){var r=n(56),i=n(6)("iterator"),o=n(10);t.exports=n(11).isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},function(t,e,n){t.exports={default:n(126),__esModule:!0}},function(t,e,n){n(44),n(55),t.exports=n(127)},function(t,e,n){var r=n(15),i=n(128);t.exports=n(11).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},function(t,e,n){var r=n(56),i=n(6)("iterator"),o=n(10);t.exports=n(11).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(130),i=n(134),o=n(135),a=o&&o.isArrayBuffer,s=a?i(a):r;t.exports=s},function(t,e,n){var r=n(59),i=n(133),o="[object ArrayBuffer]";t.exports=function(t){return i(t)&&r(t)==o}},function(t,e,n){var r=n(60),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var r=n(61),i="object"==typeof e&&e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i&&r.process,s=function(){try{var t=o&&o.require&&o.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(e,n(136)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createPrivateStorage=function(){const t=new WeakMap;return e=>{let n=t.get(e);return n||(n=Object.create(null),t.set(e,n),n)}}},function(t,e,n){var r=n(139),i="Expected a function";function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(i);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},function(t,e,n){var r=n(140),i=n(161),o=n(163),a=n(164),s=n(165);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(141),i=n(153),o=n(160);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(t,e,n){var r=n(142),i=n(149),o=n(150),a=n(151),s=n(152);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(18);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e,n){var r=n(144),i=n(145),o=n(63),a=n(147),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,f=u.toString,l=c.hasOwnProperty,h=RegExp("^"+f.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?h:s).test(a(t))}},function(t,e,n){var r=n(59),i=n(63),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";t.exports=function(t){if(!i(t))return!1;var e=r(t);return e==a||e==s||e==o||e==u}},function(t,e,n){var r,i=n(146),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},function(t,e,n){var r=n(31)["__core-js_shared__"];t.exports=r},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(18),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===i?void 0:n}return o.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(18),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(18),i="__lodash_hash_undefined__";t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?i:e,this}},function(t,e,n){var r=n(154),i=n(155),o=n(157),a=n(158),s=n(159);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(19),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():i.call(e,n,1),--this.size,!0)}},function(t,e){t.exports=function(t,e){return t===e||t!==t&&e!==e}},function(t,e,n){var r=n(19);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(19);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(19);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(62)(n(31),"Map");t.exports=r},function(t,e,n){var r=n(20);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(20);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(20);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(20);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.isTypedArrayIndexedPropertyWritable=Object.getOwnPropertyDescriptor(new Uint8Array(1),0).writable;const r=new Proxy({},{});e.isProxyAbleToBeWeakMapKey=1===(new WeakMap).set(r,1).get(r)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getFloat16=function(t,e){if(!(0,r.isDataView)(t))throw new TypeError("First argument to getFloat16 function must be a DataView");for(var n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];return(0,i.convertToNumber)(t.getUint16(e,...o))},e.setFloat16=function(t,e,n){if(!(0,r.isDataView)(t))throw new TypeError("First argument to setFloat16 function must be a DataView");for(var o=arguments.length,a=Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];t.setUint16(e,(0,i.roundToFloat16Bits)(n),...a)};var r=n(58),i=n(24)},function(t,e,n){"use strict";var r=n(1),i=n(169),o=n(191),a=n(192),s=n(197),u=n(199);e.a={config:r.a,World:i.a,RigidBody:o.a,shapes:a,constraints:u,generators:s}},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(1),i=n(64),o=n(170),a=n(171),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function u(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bodies=[],this.generators=[],this.constraints=[],this.awake=[],this.broadPhase=new a.a,this.frame=0,this.perf=new o.a}return s(t,[{key:"addBody",value:function(t){var e=this;this.bodies.push(t),t.world=this,t.shapes.forEach(function(t){return e.addShape(t)})}},{key:"removeBody",value:function(t){var e=this;t.shapes.forEach(function(t){return e.removeShape(t)}),this.constraints=this.constraints.filter(function(e){return e.body1!==t&&e.body2!==t}),this.bodies.splice(this.bodies.indexOf(t),1),delete t.world}},{key:"addShape",value:function(t){this.broadPhase.addShape(t)}},{key:"removeShape",value:function(t){this.broadPhase.removeShape(t)}},{key:"addConstraint",value:function(t){this.constraints.push(t)}},{key:"removeConstraint",value:function(t){this.constraints.splice(this.constraints.indexOf(t),1)}},{key:"addGenerator",value:function(t){this.generators.push(t)}},{key:"removeGenerator",value:function(t){this.generators.splice(this.generators.indexOf(t),1)}},{key:"beginStep",value:function(t){var e=this;this.frame+=1,this.bodies.forEach(function(e){return e.beginFrame(t)}),this.generators.forEach(function(t){return Object(i.a)(t.body1,t.body2)&&t.resolve()}),this.bodies.forEach(function(e){return e.applyForces(t)});var n=performance.now();this.contacts=this.broadPhase.run(),this.perf.add("broad",performance.now()-n);var o=[].concat(u(this.contacts),u(this.constraints));this.awake.length=0;for(var a=0;a<r.a.iterations;++a)o=o.filter(function(t){return!Object(i.a)(t.body1,t.body2)||(t.init(),e.awake.push(t),!1)}),this.awake.forEach(function(t){t.body1.moves&&t.body2.moves&&(t.body1.motion>r.a.sleepWakeThreshold&&t.body2.sleeping||t.body2.motion>r.a.sleepWakeThreshold&&t.body1.sleeping)||t.resolve()});this.perf.add("resolve",performance.now()-n)}},{key:"endStep",value:function(t){var e=performance.now();if(r.a.positionIterations){var n=[],i=new Set;this.awake.forEach(function(t){t.initPosition(),n.push(t),i.add(t.body1),i.add(t.body2)});for(var o=0;o<r.a.positionIterations;++o)n.forEach(function(t){return t.resolvePosition()});i.forEach(function(t){return t.calculateTransform()})}this.perf.add("position",performance.now()-e),this.bodies.forEach(function(e){return e.endFrame(t)})}},{key:"update",value:function(t){var e=performance.now();this.time=t,this.frame&&this.endStep(r.a.step),this.beginStep(r.a.step),this.perf.add("total",performance.now()-e)}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.total=0,this.broad=0,this.narrow=0,this.resolve=0,this.position=0}return r(t,[{key:"add",value:function(t,e){this[t]=.9*this[t]+.1*e}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(0),i=n(172),o=n(64),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u=function(){function t(e,n,i){s(this,t),this.parent=e,i?(this.left=n,this.right=i,this.aabb=r.a.create(),n.parent=this,i.parent=this,this.update()):(this.shape=n,this.aabb=r.a.clone(n.aabb),r.a.grow(this.aabb,this.aabb,.1),this.area=0,this.height=0)}return a(t,[{key:"update",value:function(){var t=this.left,e=this.right;r.a.combine(this.aabb,t.aabb,e.aabb),this.area=r.a.area(this.aabb),this.height=Math.max(t.height,e.height)+1}}]),t}(),c=r.a.create(),f=function(){function t(){s(this,t),this.root=null,this.shapeId=0,this.shapes=new Map,this.stack=[]}return a(t,[{key:"addShape",value:function(t){var e=new u(null,t);this.shapes.set(t,{id:++this.shapeId,contacts:[],node:e}),this.insertLeaf(e),this.contacts&&this.collide(e)}},{key:"removeShape",value:function(t){this.removeLeaf(this.shapes.get(t).node),this.shapes.delete(t);for(var e=0;e<this.contacts.length;++e){var n=this.contacts[e];if(n.shape1===t||n.shape2===t){var r=this.contacts.pop();r!==n&&(this.contacts[e--]=r)}}}},{key:"allowed",value:function(t,e){return!(!t.body.moves&&!e.body.moves)&&(t.body!==e.body&&(t.body.parent!==e.body&&e.body.parent!==t.body))}},{key:"addPair",value:function(t,e){if(this.allowed(t,e)){var n=this.shapes.get(t),r=this.shapes.get(e),o=void 0;n.id>r.id&&(o=t,t=e,e=o,o=n,n=r,r=o);var a=n.contacts,s=r.contacts;if(a.length<s.length){if(a.some(function(t){return t.shape2===e}))return}else if(s.some(function(e){return e.shape1===t}))return;var u=new i.a(t,e);this.contacts.push(u),a.push(u),s.push(u)}}},{key:"run",value:function(){var t=this;if(this.contacts){this.shapes.forEach(function(t){return t.contacts.length=0});for(var e=0;e<this.contacts.length;++e){var n=this.contacts[e],i=this.shapes.get(n.shape1),a=this.shapes.get(n.shape2);if(i.node&&a.node&&r.a.intersects(i.node.aabb,a.node.aabb))i.contacts.push(n),a.contacts.push(n);else{Object(o.a)(n.body1,n.body2);var s=this.contacts.pop();s!=n&&(this.contacts[e--]=s)}}this.shapes.forEach(function(e,n){var i=e.node;r.a.contains(i.aabb,n.aabb)||(t.removeLeaf(i),r.a.grow(i.aabb,n.aabb,.1),t.insertLeaf(i),t.collide(i))})}else this.contacts=[],this.collideAll();return this.contacts}},{key:"collide",value:function(t){for(this.stack.push(this.root);this.stack.length;){var e=this.stack.pop();e.shape?e.shape!==t.shape&&r.a.intersects(e.aabb,t.aabb)&&this.addPair(t.shape,e.shape):r.a.intersects(e.aabb,t.aabb)&&(this.stack.push(e.left),this.stack.push(e.right))}}},{key:"collideAll",value:function(){if(this.root)for(this.stack.push(this.root),this.stack.push(this.root);this.stack.length;){var t=this.stack.pop(),e=this.stack.pop();t.shape&&e.shape?t.shape!==e.shape&&r.a.intersects(t.aabb,e.aabb)&&this.addPair(t.shape,e.shape):r.a.intersects(t.aabb,e.aabb)&&(e.shape||!t.shape&&t.area>e.area?(this.stack.push(t.left),this.stack.push(e),this.stack.push(t.right),this.stack.push(e)):(this.stack.push(t),this.stack.push(e.left),this.stack.push(t),this.stack.push(e.right)))}}},{key:"insertLeaf",value:function(t){if(this.root){for(var e=this.root;!e.shape;){var n=-2*e.area,i=n;if(n+=r.a.area(r.a.combine(c,e.left.aabb,t.aabb)),i+=r.a.area(r.a.combine(c,e.right.aabb,t.aabb)),e.left.shape||(n-=e.left.area),e.right.shape||(i-=e.right.area),n<i){if(n>0)break;e=e.left}else{if(i>0)break;e=e.right}}var o=e.parent,a=new u(o,t,e);e===this.root?this.root=a:o.left===e?o.left=a:o.right=a;do{(a=this.balance(a)).update(),a=a.parent}while(a)}else this.root=t}},{key:"removeLeaf",value:function(t){if(t!==this.root){var e=t.parent,n=e.left===t?e.right:e.left;if(e===this.root)return this.root=n,void(n.parent=null);var r=e.parent;n.parent=r,r.left===e?r.left=n:r.right=n;do{(r=this.balance(r)).update(),r=r.parent}while(r)}else this.root=null}},{key:"balance",value:function(t){if(t.height<2)return t;var e=t.left,n=t.right,r=t.parent,i=e.height-n.height;if(i>1){var o=e.left,a=e.right;return o.height>a.height?(e.right=t,t.parent=e,t.left=a,a.parent=t):(e.left=t,t.parent=e,t.left=o,o.parent=t),t.update(),e.update(),r?r.left===t?r.left=e:r.right=e:this.root=e,e.parent=r,e}if(i<-1){var s=n.left,u=n.right;return s.height>u.height?(n.right=t,t.parent=n,t.right=u,u.parent=t):(n.left=t,t.parent=n,t.right=s,s.parent=t),t.update(),n.update(),r?r.left===t?r.left=n:r.right=n:this.root=n,n.parent=r,n}return t}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(0),i=n(173),o=n(177),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function s(t,e){var n=function(t,e){return o[t+e]||function(t){if(t)return function(e,n){return t.call(this,n,e)}}(o[e+t])}(t,e);return n||("Box"===t?s("Hull",e):"Box"===e?s(t,"Hull"):void 0)}var u=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.inverted=!1,this.normal=r.g.fromValues(1,0,0),this.contacts={},this.shape1=e,this.body1=e.body,this.shape2=n,this.body2=n.body,this.generator=s(e.type,n.type)}return a(t,[{key:"sync",value:function(t){var e=t!==this.shape1;e!==this.inverted&&(this.contacts={},this.inverted=e),e&&r.g.negate(this.normal,this.normal)}},{key:"add",value:function(t,e,n){if(this.contacts[n]){var o=this.newContacts[n]=this.contacts[n];return r.g.copy(o.pos,t),o.penetration=e,r.g.copy(o.normal,this.normal),o.cached=!0,o.init(),o}return this.newContacts[n]=new i.a(this.shape1,this.shape2,t,e,this.normal)}},{key:"init",value:function(){this.generator&&(this.newContacts={},this.generator(this.shape1,this.shape2),this.contacts=this.newContacts)}},{key:"resolve",value:function(){for(var t in this.contacts)this.contacts[t].resolve()}},{key:"initPosition",value:function(){for(var t in this.contacts)this.contacts[t].initPosition()}},{key:"resolvePosition",value:function(){for(var t in this.contacts)this.contacts[t].resolvePosition()}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return E});var r=n(0),i=n(65),o=n(1),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=r.g.dot,u=new Float32Array(3),c=new Float32Array(3),f=new Float32Array(3),l=new Float32Array(3),h=new Float32Array(3),d=new Float32Array(3),_=new Float32Array(3),p=new Float32Array(3),E=function(){function t(e,n,o,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape1=e,this.shape2=n,this.pos=r.g.clone(o),this.penetration=a,this.normal=r.g.clone(s),this.body1=e.body,this.body2=n.body,this.jac1=new i.a(e.body,n.body),this.jac1.lower=0,this.jac2=new i.b(e.body,n.body),this.init()}return a(t,[{key:"init",value:function(){this.jac1.linear(this.pos,this.pos,this.normal),this.friction>1e-4&&(r.g.makeBasis(this.normal,f,l),this.jac2.linear(this.pos,this.pos,f,l)),this.body1.lastVelocityAt(u,this.pos),this.body2.lastVelocityAt(c,this.pos);var t=s(r.g.sub(u,u,c),this.normal);return this.jac1.bias=t<-.5?this.restitution*t:0,o.a.positionIterations||(this.jac1.bias=Math.min(-.2*Math.max(0,this.penetration-o.a.delta)/o.a.step,this.jac1.bias)),!0}},{key:"resolve",value:function(){this.jac1.resolve(),this.friction>1e-4&&this.jac2.resolve(this.jac1.lambda*this.friction)}},{key:"force",value:function(t){this.jac1.force(t),this.friction>1e-4&&(this.jac2.force(u),r.g.add(t,t,u))}},{key:"initPosition",value:function(){this.pos1||(this.pos1=r.g.create()),this.pos2||(this.pos2=r.g.create()),r.g.inverseMat4(this.pos1,this.pos,this.body1.transform),r.g.subtract(this.pos1,this.pos1,this.body1.center),r.g.inverseMat4(this.pos2,this.pos,this.body2.transform),r.g.subtract(this.pos2,this.pos2,this.body2.center)}},{key:"resolvePosition",value:function(){r.g.transformQuat(u,this.pos1,this.body1.orientation),r.g.cross(h,u,this.normal),r.g.add(u,u,this.body1.position),r.g.transformQuat(c,this.pos2,this.body2.orientation),r.g.cross(d,c,this.normal),r.g.add(c,c,this.body2.position),r.g.subtract(f,u,c);var t=this.penetration-r.g.dot(f,this.normal);if(t<o.a.delta)return t;r.g.transformMat3(f,h,this.body1.invInertia),r.g.transformMat3(l,d,this.body2.invInertia),r.g.transformMat3(_,this.normal,this.body1.invMass),r.g.transformMat3(p,this.normal,this.body2.invMass);var e=r.g.dot(_,this.normal)+r.g.dot(p,this.normal)+r.g.dot(f,h)+r.g.dot(l,d),n=.2*(t-o.a.delta)/e;return r.g.scaleAndAdd(this.body1.position,this.body1.position,_,n),r.f.adjustVec3(this.body1.orientation,this.body1.orientation,f,n),r.g.scaleAndAdd(this.body2.position,this.body2.position,p,-n),r.f.adjustVec3(this.body2.orientation,this.body2.orientation,l,-n),this.body1.calculateInertia(),this.body2.calculateInertia(),t}},{key:"friction",get:function(){return this.shape1.material.frictionCombine(this.shape1.material.friction,this.shape2.material.friction)}},{key:"restitution",get:function(){return this.shape1.material.restitutionCombine(this.shape1.material.restitution,this.shape2.material.restitution)}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=r.g.dot,a=new Float32Array(3),s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.v1=new Float32Array(3),this.w1=new Float32Array(3),this.v2=new Float32Array(3),this.w2=new Float32Array(3),this.v1a=new Float32Array(3),this.w1a=new Float32Array(3),this.v2a=new Float32Array(3),this.w2a=new Float32Array(3),this.bias=0,this.restitution=0,this.lower=-1e9,this.upper=1e9,this.ok=!0,this.body1=e,this.body2=n}return i(t,[{key:"apply",value:function(t){var e=this.body1.velocity,n=this.body1.angVelocity,r=this.body2.velocity,i=this.body2.angVelocity,o=this.v1a,a=this.w1a,s=this.v2a,u=this.w2a;e[0]+=o[0]*t,e[1]+=o[1]*t,e[2]+=o[2]*t,n[0]+=a[0]*t,n[1]+=a[1]*t,n[2]+=a[2]*t,r[0]+=s[0]*t,r[1]+=s[1]*t,r[2]+=s[2]*t,i[0]+=u[0]*t,i[1]+=u[1]*t,i[2]+=u[2]*t}},{key:"force",value:function(t){r.g.scale(t,this.v1a,this.lambda*this.body1.mass)}},{key:"linear",value:function(t,e,n){r.g.copy(this.v1,n),r.g.subtract(a,t,this.body1.position),r.g.cross(this.w1,a,n),r.g.negate(this.v2,n),r.g.subtract(a,e,this.body2.position),r.g.cross(this.w2,n,a),r.g.transformMat3(this.v1a,this.v1,this.body1.invMass),r.g.transformMat3(this.w1a,this.w1,this.body1.invInertia),r.g.transformMat3(this.v2a,this.v2,this.body2.invMass),r.g.transformMat3(this.w2a,this.w2,this.body2.invInertia);var i=o(this.v1a,this.v1)+o(this.w1a,this.w1)+o(this.v2a,this.v2)+o(this.w2a,this.w2);i<1e-6&&(this.ok=!1),this.mass=1/i,void 0!==this.lambda?this.apply(this.lambda):this.lambda=0}},{key:"angular",value:function(t){r.g.copy(this.w1,t),r.g.negate(this.w2,t),r.g.transformMat3(this.w1a,this.w1,this.body1.invInertia),r.g.transformMat3(this.w2a,this.w2,this.body2.invInertia),this.mass=1/(o(this.w1a,this.w1)+o(this.w2a,this.w2)),void 0!==this.lambda?this.apply(this.lambda):this.lambda=0}},{key:"resolve",value:function(){if(this.ok){var t=o(this.v1,this.body1.velocity)+o(this.w1,this.body1.angVelocity)+o(this.v2,this.body2.velocity)+o(this.w2,this.body2.angVelocity)+this.bias,e=this.lambda;this.lambda-=this.mass*t,this.lambda<this.lower&&(this.lambda=this.lower),this.lambda>this.upper&&(this.lambda=this.upper),this.apply(this.lambda-e)}}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=r.g.dot,a=new Float32Array(3),s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.v11=new Float32Array(3),this.w11=new Float32Array(3),this.v21=new Float32Array(3),this.w21=new Float32Array(3),this.v11a=new Float32Array(3),this.w11a=new Float32Array(3),this.v21a=new Float32Array(3),this.w21a=new Float32Array(3),this.v12=new Float32Array(3),this.w12=new Float32Array(3),this.v22=new Float32Array(3),this.w22=new Float32Array(3),this.v12a=new Float32Array(3),this.w12a=new Float32Array(3),this.v22a=new Float32Array(3),this.w22a=new Float32Array(3),this.mass=new Float32Array(4),this.body1=e,this.body2=n}return i(t,[{key:"apply",value:function(t,e){var n=this.body1.velocity,r=this.body1.angVelocity,i=this.body2.velocity,o=this.body2.angVelocity,a=this.v11a,s=this.w11a,u=this.v21a,c=this.w21a,f=this.v12a,l=this.w12a,h=this.v22a,d=this.w22a;n[0]+=a[0]*t+f[0]*e,n[1]+=a[1]*t+f[1]*e,n[2]+=a[2]*t+f[2]*e,r[0]+=s[0]*t+l[0]*e,r[1]+=s[1]*t+l[1]*e,r[2]+=s[2]*t+l[2]*e,i[0]+=u[0]*t+h[0]*e,i[1]+=u[1]*t+h[1]*e,i[2]+=u[2]*t+h[2]*e,o[0]+=c[0]*t+d[0]*e,o[1]+=c[1]*t+d[1]*e,o[2]+=c[2]*t+d[2]*e}},{key:"force",value:function(t){r.g.scale(t,this.v11a,this.lambda1*this.body1.mass),r.g.scaleAndAdd(t,t,this.v12a,this.lambda2*this.body1.mass)}},{key:"linear",value:function(t,e,n,i){r.g.copy(this.v11,n),r.g.copy(this.v12,i),r.g.subtract(a,t,this.body1.position),r.g.cross(this.w11,a,n),r.g.cross(this.w12,a,i),r.g.negate(this.v21,n),r.g.negate(this.v22,i),r.g.subtract(a,e,this.body2.position),r.g.cross(this.w21,n,a),r.g.cross(this.w22,i,a),r.g.transformMat3(this.v11a,this.v11,this.body1.invMass),r.g.transformMat3(this.v12a,this.v12,this.body1.invMass),r.g.transformMat3(this.w11a,this.w11,this.body1.invInertia),r.g.transformMat3(this.w12a,this.w12,this.body1.invInertia),r.g.transformMat3(this.v21a,this.v21,this.body2.invMass),r.g.transformMat3(this.v22a,this.v22,this.body2.invMass),r.g.transformMat3(this.w21a,this.w21,this.body2.invInertia),r.g.transformMat3(this.w22a,this.w22,this.body2.invInertia),this.mass[0]=o(this.v11a,this.v11)+o(this.w11a,this.w11)+o(this.v21a,this.v21)+o(this.w21a,this.w21),this.mass[1]=o(this.v11a,this.v12)+o(this.w11a,this.w12)+o(this.v21a,this.v22)+o(this.w21a,this.w22),this.mass[2]=o(this.v12a,this.v11)+o(this.w12a,this.w11)+o(this.v22a,this.v21)+o(this.w22a,this.w21),this.mass[3]=o(this.v12a,this.v12)+o(this.w12a,this.w12)+o(this.v22a,this.v22)+o(this.w22a,this.w22),r.c.invert(this.mass,this.mass),void 0!==this.lambda1?this.apply(this.lambda1,this.lambda2):(this.lambda1=0,this.lambda2=0)}},{key:"resolve",value:function(t){var e=o(this.v11,this.body1.velocity)+o(this.w11,this.body1.angVelocity)+o(this.v21,this.body2.velocity)+o(this.w21,this.body2.angVelocity),n=o(this.v12,this.body1.velocity)+o(this.w12,this.body1.angVelocity)+o(this.v22,this.body2.velocity)+o(this.w22,this.body2.angVelocity),r=this.lambda1,i=this.lambda2;this.lambda1-=this.mass[0]*e+this.mass[1]*n,this.lambda2-=this.mass[2]*e+this.mass[3]*n;var a=Math.sqrt(this.lambda1*this.lambda1+this.lambda2*this.lambda2);a>1e-4&&a>t&&(a=t/a,this.lambda1*=a,this.lambda2*=a),this.apply(this.lambda1-r,this.lambda2-i)}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=new Float32Array(3),a=new Float32Array(3),s=new Float32Array(9);function u(t,e,n){var r=e[0],i=e[1],o=e[2];t[0]+=r*n[0]+i*n[3]+o*n[6],t[1]+=r*n[1]+i*n[4]+o*n[7],t[2]+=r*n[2]+i*n[5]+o*n[8]}var c=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.w1=new Float32Array(9),this.w2=new Float32Array(9),this.w1a=new Float32Array(9),this.w2a=new Float32Array(9),this.bias=r.g.create(),this.mass=new Float32Array(9),this.body1=e,this.body2=n}return i(t,[{key:"apply",value:function(t){var e,n,r,i,o,a,s=this.body1.velocity,c=this.body2.velocity;u(s,t,this.body1.invMass),u(this.body1.angVelocity,t,this.w1a),e=c,n=t,r=this.body2.invMass,i=n[0],o=n[1],a=n[2],e[0]-=i*r[0]+o*r[3]+a*r[6],e[1]-=i*r[1]+o*r[4]+a*r[7],e[2]-=i*r[2]+o*r[5]+a*r[8],u(this.body2.angVelocity,t,this.w2a)}},{key:"force",value:function(t){r.g.copy(t,this.lambda)}},{key:"linear",value:function(t,e){r.g.subtract(o,t,this.body1.position),this.w1[5]=-(this.w1[7]=o[0]),this.w1[6]=-(this.w1[2]=o[1]),this.w1[1]=-(this.w1[3]=o[2]),r.g.subtract(o,e,this.body2.position),this.w2[7]=-(this.w2[5]=o[0]),this.w2[2]=-(this.w2[6]=o[1]),this.w2[3]=-(this.w2[1]=o[2]),r.d.multiplyT(this.w1a,this.body1.invInertia,this.w1),r.d.multiplyT(this.w2a,this.body2.invInertia,this.w2),r.d.multiply(this.mass,this.w1,this.w1a),r.d.multiply(s,this.w2,this.w2a),r.d.add(this.mass,this.mass,s),r.d.add(this.mass,this.mass,this.body1.invMass),r.d.add(this.mass,this.mass,this.body2.invMass),r.d.invert(this.mass,this.mass),void 0!==this.lambda?this.apply(this.lambda):this.lambda=r.g.create()}},{key:"resolve",value:function(){if(r.g.subtract(a,this.body1.velocity,this.body2.velocity),u(a,this.body1.angVelocity,this.w1),u(a,this.body2.angVelocity,this.w2),r.g.add(a,a,this.bias),r.g.transformMat3(a,a,this.mass),r.g.negate(a,a),this.limit){var t=r.g.length(this.lambda);t>this.limit&&r.g.scale(this.lambda,this.lambda,t,this.limit/t)}r.g.add(this.lambda,this.lambda,a),this.apply(a)}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(178);n.d(e,"BoxSphere",function(){return r.a});var i=n(179);n.d(e,"CapsuleCapsule",function(){return i.a});var o=n(180);n.d(e,"CapsuleHull",function(){return o.a});var a=n(181);n.d(e,"CapsulePlane",function(){return a.a});var s=n(182);n.d(e,"CapsuleSphere",function(){return s.a});var u=n(183);n.d(e,"HullHull",function(){return u.a});var c=n(187);n.d(e,"HullPlane",function(){return c.a});var f=n(188);n.d(e,"HullSphere",function(){return f.a});var l=n(189);n.d(e,"PlaneSphere",function(){return l.a});var h=n(190);n.d(e,"SphereSphere",function(){return h.a})},function(t,e,n){"use strict";e.a=function(t,e){r.g.subtract(o,e.center,t.center);var n=r.g.inverseMat3(a,o,t.orient),u=Math.abs(n[0]),c=Math.abs(n[1]),f=Math.abs(n[2]);if(u<t.halfSize[0]+i.a.delta&&c<t.halfSize[1]+i.a.delta&&f<t.halfSize[2]+i.a.delta){var l=void 0,h=l=u>c&&u>f?0:c>f?1:2;r.g.copy(this.normal,t.axes[l]),n[l]<0&&(r.g.negate(this.normal,this.normal),h+=3),this.sync(e,t),r.g.scaleAndAdd(s,e.center,this.normal,1-Math.abs(n[l])),this.add(s,1-Math.abs(n[l])+e.radius,h)}else{var d=0;n[0]<-t.halfSize[0]&&(n[0]=-t.halfSize[0],d+=1),n[0]>t.halfSize[0]&&(n[0]=t.halfSize[0],d+=2),n[1]<-t.halfSize[1]&&(n[1]=-t.halfSize[1],d+=4),n[1]>t.halfSize[1]&&(n[1]=t.halfSize[1],d+=8),n[2]<-t.halfSize[2]&&(n[2]=-t.halfSize[2],d+=16),n[2]>t.halfSize[2]&&(n[2]=t.halfSize[2],d+=32);var _=r.g.transformMat3(s,n,t.orient);r.g.add(_,_,t.center);var p=r.g.distance(_,e.center);if(p>e.radius+i.a.delta)return;r.g.subtract(this.normal,_,e.center),r.g.scale(this.normal,this.normal,1/p),this.sync(t,e),this.add(_,e.radius-p,d)}};var r=n(0),i=n(1),o=new Float32Array(3),a=new Float32Array(3),s=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e){if(a.a.call(this,t,e,e.start,e.end,e.radius,""))return;var n=Object(o.a)(t.start,t.end,e.start,e.end),c=t.radius+e.radius,f=r.g.subtract(s,n[0],n[1]),l=r.g.length(f);if(l>c+i.a.delta)return;l>i.a.delta?r.g.scale(this.normal,f,1/l):r.g.set(this.normal,0,0,1);r.g.scaleAndAdd(u,n[1],this.normal,.5*(e.radius+l-t.radius)),this.sync(t,e),this.add(u,c-l,0)};var r=n(0),i=n(1),o=n(9),a=n(66),s=new Float32Array(3),u=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e){_.set(t.start,t.end);var n=Object(o.a)(e,_);if(n){var u=r.g.subtract(h,n[1],n[0]),p=r.g.length(u);if(p>i.a.delta&&p<t.radius+i.a.delta){r.g.scale(this.normal,u,1/p);for(var E=0;E<e.faces.length;++E)if(r.g.dot(this.normal,e.faces[E].plane)>.99&&d.call(this,e,e.faces[E],t))return;for(var g in e.edges){var v=e.edges[g];if(r.g.dot(n[1],v.n1)+v.n1[3]>-i.a.delta&&r.g.dot(n[1],v.n2)+v.n2[3]>-i.a.delta&&a.a.call(this,t,e,v.a,v.b,0,g))return}this.sync(t,e),this.add(n[0],t.radius-p,0)}if(p>i.a.delta)return}for(var A=void 0,T=void 0,y=-1e9,m=l,b=0;b<e.faces.length;++b){var R=e.faces[b].plane,N=Math.min(r.g.dot(R,t.start),r.g.dot(R,t.end))+R[3];N>y&&(A=e.faces[b],y=N)}var I=_.dir;for(var M in e.edges){var O=e.edges[M];if(r.g.dot(I,O.n1)*r.g.dot(I,O.n2)<0){r.g.cross(c,I,r.g.subtract(f,O.b,O.a));var P=r.g.length(c);if(P<1e-4)continue;r.g.scale(c,c,1/P),r.g.dot(c,r.g.subtract(f,O.a,e.center))<0&&r.g.negate(c,c);var S=r.g.dot(r.g.subtract(f,t.start,O.a),c);S>y&&(A=void 0,T=M,y=S,r.g.copy(m,c))}}if((y-=t.radius)>i.a.delta)return;if(A)d.call(this,e,A,t);else if(T){r.g.copy(this.normal,m),this.sync(t,e);var x=e.edges[T],w=Object(s.a)(t.start,t.end,x.a,x.b);this.add(w[1],-y,T)}};var r=n(0),i=n(1),o=n(67),a=n(66),s=n(9),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var c=new Float32Array(3),f=new Float32Array(3),l=new Float32Array(3),h=new Float32Array(3);function d(t,e,n){for(var o=0,a=1,s=t.vertices,u=e.vertices,l=u.length,h=e.plane,d=0;d<l;++d){var _=u[d],p=u[d===l-1?0:d+1];r.g.subtract(f,s[p],s[_]);var E=r.g.cross(c,h,f),g=r.g.dot(E,s[_])-i.a.delta,v=r.g.dot(E,n.start)-g,A=r.g.dot(E,n.end)-g;if(v<i.a.delta&&A<i.a.delta)return;if(!(v>0&&A>0)){var T=-v/(A-v);if(v<A?T>o&&(o=T):T<a&&(a=T),o>=a)return}}r.g.lerp(c,n.start,n.end,o),r.g.lerp(f,n.start,n.end,a);var y=r.g.dot(h,c)+h[3],m=r.g.dot(h,f)+h[3];if(!(y>=n.radius+i.a.delta&&m>=n.radius+i.a.delta))return r.g.copy(this.normal,h),this.sync(n,t),y<n.radius+i.a.delta&&(r.g.scaleAndAdd(c,c,h,-y),this.add(c,-y+n.radius,0)),m<n.radius+i.a.delta&&(r.g.scaleAndAdd(f,f,h,-m),this.add(f,-m+n.radius,1)),!0}var _=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dir=r.g.create()}return u(t,[{key:"set",value:function(t,e){this.a=t,this.b=e,r.g.subtract(this.dir,e,t)}},{key:"support",value:function(t){return r.g.dot(t,this.dir)>0?this.b:this.a}}]),t}())},function(t,e,n){"use strict";e.a=function(t,e){var n=r.g.dot(e.normal,t.start)-e.offset-t.radius;n<i.a.delta&&(r.g.copy(this.normal,e.normal),this.sync(t,e),this.add(r.g.scaleAndAdd(o,t.start,e.normal,-t.radius),-n,0));(n=r.g.dot(e.normal,t.end)-e.offset-t.radius)<i.a.delta&&(r.g.copy(this.normal,e.normal),this.sync(t,e),this.add(r.g.scaleAndAdd(o,t.end,e.normal,-t.radius),-n,1))};var r=n(0),i=n(1),o=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e){var n=Object(o.a)(t.start,t.end,e.center,e.center),s=t.radius+e.radius,u=r.g.subtract(a,n[0],n[1]),c=r.g.length(u);if(c>s+i.a.delta)return;c>i.a.delta?r.g.scale(this.normal,u,1/c):r.g.set(this.normal,0,0,1);r.g.scaleAndAdd(a,n[1],this.normal,.5*(e.radius+c-t.radius)),this.sync(t,e),this.add(a,s-c,0)};var r=n(0),i=n(1),o=n(9),a=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e){if(this.cacheAxis){var n=this.cache1.support(this.cacheAxis);r.g.negate(c,this.cacheAxis);var o=this.cache2.support(c);if(r.g.dot(r.g.subtract(f,o,n),this.cacheAxis)>i.a.delta)return}if(null!=this.cacheFace){var E=p(this.cache1,this.cache2,this.cacheFace);if(E&&E.pos.length){r.g.copy(this.cacheAxis,this.cache1.faces[this.cacheFace].plane),r.g.negate(this.normal,this.cacheAxis),this.sync(this.cache1,this.cache2);for(var g=0;g<E.pos.length;++g)this.add(E.pos[g],E.dist[g],E.id[g]);return}delete this.cacheFace}if(null!=this.cacheEdge1){var v=this.cache1.edges[this.cacheEdge1],A=this.cache2.edges[this.cacheEdge2],T=Object(a.a)(v.a,v.b,A.a,A.b);if(T[2]>i.a.delta&&T[2]<1-i.a.delta&&T[3]>i.a.delta&&T[3]<1-i.a.delta){r.g.cross(this.cacheAxis,r.g.subtract(l,v.b,v.a),r.g.subtract(h,A.b,A.a)),r.g.normalize(this.cacheAxis,this.cacheAxis),r.g.dot(r.g.subtract(d,this.cache2.center,this.cache1.center),this.cacheAxis)<0&&r.g.negate(this.cacheAxis,this.cacheAxis);var y=r.g.dot(r.g.subtract(d,T[1],T[0]),this.cacheAxis);if(y<i.a.delta)return r.g.negate(this.normal,this.cacheAxis),this.sync(this.cache1,this.cache2),void this.add(r.g.lerp(_,T[0],T[1],.5),-y,this.cacheEdge1+"+"+this.cacheEdge2)}delete this.cacheEdge1,delete this.cacheEdge2}var m=void 0;m="Box"===t.type&&"Box"===e.type?Object(u.a)(t,e):Object(s.a)(t,e);this.cacheAxis||(this.cacheAxis=new Float32Array(3));if(this.cache1=m.shape1,this.cache2=m.shape2,r.g.copy(this.cacheAxis,m.normal),m.distance>i.a.delta)return;if(r.g.negate(this.normal,m.normal),this.sync(m.shape1,m.shape2),null!=m.face){this.cacheFace=m.face;var b=p(this.cache1,this.cache2,this.cacheFace);if(!b)return;for(var R=0;R<b.pos.length;++R)this.add(b.pos[R],b.dist[R],b.id[R])}else this.cacheEdge1=m.edge1,this.cacheEdge2=m.edge2,this.add(m.point,-m.distance,m.edge1+"+"+m.edge2)};var r=n(0),i=n(1),o=n(184),a=n(9),s=n(185),u=n(186),c=new Float32Array(3),f=new Float32Array(3),l=new Float32Array(3),h=new Float32Array(3),d=new Float32Array(3),_=new Float32Array(3);function p(t,e,n){for(var i=t.faces[n],a=void 0,s=0,u=0;u<e.faces.length;++u){var c=e.faces[u],f=r.g.dot(c.plane,i.plane);f<s&&(s=f,a=c)}if(a)return Object(o.a)(t,i,e,a,1439*n)}},function(t,e,n){"use strict";e.a=function(t,e,n,E,g){var v=e.vertices,A=v.length,T=E.vertices,y=T.length,m=t.vertices,b=n.vertices,R=e.plane;for(;s.length<A+y;)s.push(r.g.create()),u.push(r.g.create());for(var N=y,I=void 0,M=0;M<y;++M)r.g.copy(s[M],b[T[M]]),c[M]=g+M;for(var O=0;O<A&&N;++O){var P=v[O],S=v[O===A-1?0:O+1],x=3221*(P+2351*S);r.g.subtract(a,m[S],m[P]);var w=r.g.cross(o,R,a),L=r.g.dot(w,m[P])-i.a.delta,F=N-1,U=r.g.dot(s[F],w)-L;I=0;for(var C=0;C<N;++C){var D=r.g.dot(s[C],w)-L;U*D<0&&(Math.abs(U-D)>1e-4?r.g.lerp(u[I],s[F],s[C],U/(U-D)):r.g.copy(u[I],s[F]),f[I++]=c[F]+1877*c[C]+x&4294967295),D>=0&&(r.g.copy(u[I],s[C]),f[I++]=c[C]),F=C,U=D}l=s,s=u,u=l,l=c,c=f,f=l,N=I}I=0;for(var B=0;B<N;++B){var X=r.g.dot(s[B],R)+R[3];X<i.a.delta&&(r.g.scaleAndAdd(u[I],s[B],R,-X),d[I]=-X,f[I++]=c[B])}l=s,s=u,u=l,l=c,c=f,f=l,N=I;var j=h.pos,k=h.id,Y=h.dist;if(j.length=0,k.length=0,Y.length=0,N>4){var V=0,H=r.g.dot(s[0],p);_[0]=s[0];for(var G=1;G<N;++G){var z=r.g.dot(s[G],p);z>H&&(V=G,H=z),_[G]=s[G]}j.push(s[V]),k.push(c[V]),Y.push(d[V]),_[V]=_[--N],c[V]=c[N],d[V]=d[N],V=0,H=r.g.squaredDistance(_[0],j[0]);for(var Q=1;Q<N;++Q){var W=r.g.squaredDistance(_[Q],j[0]);W>H&&(V=Q,H=W)}j.push(_[V]),k.push(c[V]),Y.push(d[V]),_[V]=_[--N],c[V]=c[N],d[V]=d[N],r.g.cross(o,R,r.g.subtract(a,j[1],j[0])),V=0,H=r.g.dot(o,_[0]);for(var K=V,q=H,Z=1;Z<N;++Z){var J=r.g.dot(o,_[Z]);J>H&&(V=Z,H=J),J<q&&(K=Z,q=J)}j.push(_[V]),k.push(c[V]),Y.push(d[V]),K!==V&&(j.push(_[K]),k.push(c[K]),Y.push(d[K]))}else for(var $=0;$<N;++$)j.push(s[$]),k.push(c[$]),Y.push(d[$]);return h};var r=n(0),i=n(1),o=new Float32Array(3),a=new Float32Array(3),s=[],u=[],c=[],f=[],l=void 0,h={pos:[],id:[],dist:[]},d=[],_=[],p=r.g.fromValues(1,2,3)},function(t,e,n){"use strict";e.a=function(t,e){var n={},h=-1e9;if(t.faces.forEach(function(i,o){var s=i.plane;r.g.negate(a,s);var u=e.support(a),c=r.g.dot(s,u)+s[3];c>h&&(n.shape1=t,n.shape2=e,n.normal=s,n.point=u,n.face=o,n.distance=h=c)}),(h+=2*o.a.delta)>o.a.delta)return n;if(e.faces.forEach(function(i,o){var s=i.plane;r.g.negate(a,s);var u=t.support(a),c=r.g.dot(s,u)+s[3];c>h&&(n.shape1=e,n.shape2=t,n.normal=s,n.point=u,n.face=o,n.distance=h=c)}),(h+=2*o.a.delta)>o.a.delta)return n;for(var d in t.edges){var _=t.edges[d];r.g.subtract(a,_.b,_.a);var p=r.g.subtract(l,_.a,t.center);for(var E in e.edges){var g=e.edges[E];r.g.subtract(s,g.b,g.a);var v=r.g.dot(g.n1,a),A=r.g.dot(g.n2,a),T=-r.g.dot(_.n1,s),y=-r.g.dot(_.n2,s);if(v*A<0&&T*y<0&&v*y>0){r.g.cross(u,a,s);var m=r.g.length(u);if(m>.01){r.g.scale(u,u,1/m),r.g.dot(u,p)<0&&r.g.negate(u,u);var b=r.g.dot(g.a,u)-r.g.dot(_.a,u);if(b>h){delete n.face,n.shape1=t,n.shape2=e,n.edge1=d,n.edge2=E,n.normal=r.g.copy(f,u);var R=Object(i.a)(_.a,_.b,g.a,g.b);n.point=r.g.lerp(c,R[0],R[1],.5),n.distance=h=b}}}}}return n};var r=n(0),i=n(9),o=n(1),a=r.g.create(),s=r.g.create(),u=r.g.create(),c=r.g.create(),f=r.g.create(),l=r.g.create()},function(t,e,n){"use strict";e.a=function(t,e){for(var n={},c=-1e9,f=r.g.subtract(a,e.center,t.center),l=0;l<3;++l){var h=t.axes[l],d=r.g.dot(f,h),_=Math.abs(d)-t.extentsAlong(h)-e.extentsAlong(h);if(_>c){n.shape1=t,n.shape2=e,n.normal=h;var p=2*l+1;d<0&&(n.normal=r.g.negate(s,h),p-=1),r.g.negate(u,n.normal),n.point=e.support(u),n.face=p,n.distance=c=_}}if((c+=2*i.a.delta)>i.a.delta)return n;for(var E=0;E<3;++E){var g=e.axes[E],v=-r.g.dot(f,g),A=Math.abs(v)-t.extentsAlong(g)-e.extentsAlong(g);if(A>c){n.shape1=e,n.shape2=t,n.normal=g;var T=2*E+1;v<0&&(n.normal=r.g.negate(s,g),T-=1),r.g.negate(u,n.normal),n.point=t.support(u),n.face=T,n.distance=c=A}}if((c+=2*i.a.delta)>i.a.delta)return n;for(var y=0;y<3;++y)for(var m=t.axes[y],b=0;b<3;++b){var R=e.axes[b],N=r.g.cross(u,m,R);if(!(r.g.squaredLength(N)<i.a.delta)){r.g.normalize(N,N);var I=r.g.dot(f,N);I<0&&r.g.negate(N,N);var M=Math.abs(I)-t.extentsAlong(N)-e.extentsAlong(N);if(M>c){for(var O=0,P=0,S=0;S<3;++S)S!=y&&r.g.dot(t.axes[S],N)>0&&(O+=1<<S),S!=b&&r.g.dot(e.axes[S],N)<0&&(P+=1<<S);var x=Object(o.a)(t.vertices[O],t.vertices[O+(1<<y)],e.vertices[P],e.vertices[P+(1<<b)]);delete n.face,n.shape1=t,n.shape2=e,n.edge1=O+"_"+(O+(1<<y)),n.edge2=P+"_"+(P+(1<<b)),n.normal=r.g.copy(s,N),n.point=r.g.lerp(u,x[0],x[1],.5),n.distance=c=M}}}return n};var r=n(0),i=n(1),o=n(9),a=new Float32Array(3),s=new Float32Array(3),u=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e){var n=this;r.g.copy(this.normal,e.normal),this.sync(t,e),t.vertices.forEach(function(t,o){var a=r.g.dot(e.normal,t)-e.offset;a<i.a.delta&&n.add(t,-a,o)})};var r=n(0),i=n(1)},function(t,e,n){"use strict";e.a=function(t,e){e.support=function(){return this.center};var n=Object(o.a)(t,e);if(n){var s=r.g.squaredDistance(n[0],n[1]);if(s>i.a.delta&&s<e.radius*e.radius+i.a.delta&&(r.g.subtract(this.normal,n[0],n[1]),r.g.normalize(this.normal,this.normal),this.sync(t,e),this.add(n[0],e.radius-Math.sqrt(s),0)),s>i.a.delta)return}for(var u=0,c=t.faces[0].plane,f=r.g.dot(c,e.center)+c[3],l=1;l<t.faces.length;++l){c=t.faces[l].plane;var h=r.g.dot(c,e.center)+c[3];h>f&&(u=l,f=h)}r.g.copy(this.normal,t.faces[u].plane),this.sync(e,t),this.add(r.g.scaleAndAdd(a,e.center,t.faces[u].plane,-f),-f,1234+u)};var r=n(0),i=n(1),o=n(67),a=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e){var n=r.g.dot(t.normal,e.center)-t.offset-e.radius;if(n>i.a.delta)return;r.g.copy(this.normal,t.normal),this.sync(e,t),this.add(r.g.scaleAndAdd(o,e.center,t.normal,-e.radius),-n,0)};var r=n(0),i=n(1),o=new Float32Array(3)},function(t,e,n){"use strict";e.a=function(t,e){r.g.subtract(o,t.center,e.center);var n=r.g.length(o),s=n-t.radius-e.radius;if(s>i.a.delta)return;n<1e-4?r.g.set(this.normal,1,0,0):r.g.scale(this.normal,o,1/n);r.g.scaleAndAdd(a,e.center,this.normal,.5*(n+e.radius-t.radius)),this.sync(t,e),this.add(a,-s,0)};var r=n(0),i=n(1),o=new Float32Array(3),a=new Float32Array(3)},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(0),i=n(1),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function a(t,e,n){var r=n[0],i=n[1],o=n[2];t[0]+=e*(i*i+o*o),t[1]-=2*e*r*i,t[2]-=2*e*r*o,t[3]-=2*e*r*i,t[4]+=e*(r*r+o*o),t[5]-=2*e*i*o,t[6]-=2*e*r*o,t[7]-=2*e*i*o,t[8]+=e*(r*r+i*i)}var s=r.g.create(),u=r.d.create(),c=new Float32Array(9),f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moveEnabled=!0,this.rotateEnabled=!0,this.lockAxis_=null,this.shapes=[],this.needRecomputeShape=!1,this.mass=0,this.invMass_=r.d.create(),this.center=r.g.create(),this.position=r.g.create(),this.orientation=r.f.create(),this.localInvInertia=r.d.create(),this.sleepTime=0,this.motion_=0,this.velocity=r.g.create(),this.angVelocity=r.g.create(),this.invInertia_=r.d.create(),this.lastVelocity=r.g.create(),this.lastAngVelocity=r.g.create(),this.force=r.g.create(),this.torque=r.g.create(),this.localInertia=r.d.create(),this.inertia=r.d.create(),this.angMomentum=r.g.create(),this.gravity=i.a.defaultGravity,this.name=e,this.transform=n||r.e.create()}return o(t,[{key:"setMoves",value:function(t,e){this.moveEnabled=t,this.rotateEnabled=void 0===e?t:e,this.needRecomputeShape=!0}},{key:"lockAxis",value:function(t){this.lockAxis_=t?r.g.clone(t):null,this.needRecomputeShape=!0}},{key:"addShape",value:function(t){t.body=this,this.shapes.push(t),this.needRecomputeShape=!0,this.world&&this.world.addShape(t),t.update()}},{key:"removeShape",value:function(t){this.world&&this.world.removeShape(t),delete t.body,this.shapes.splice(this.shapes.indexOf(t),1),this.needRecomputeShape=!0}},{key:"updateShape",value:function(){if(this.needRecomputeShape){if(this.needRecomputeShape=!1,this.mass=0,!this.moves)return r.g.set(this.center,0,0,0),r.d.zero(this.localInvInertia),r.d.zero(this.invInertia_),void r.g.transformMat4(this.position,this.center,this.transform);var t=this.localInertia;if(this.mass=this.shapes[0].getInfo(this.center,t),this.shapes.length>1){a(t,this.mass,this.center),r.g.scale(this.center,this.center,this.mass);for(var e=1;e<this.shapes.length;++e){var n=this.shapes[e].getInfo(s,u);this.mass+=n,r.d.add(t,t,u),r.g.scaleAndAdd(this.center,this.center,s,n),a(t,n,s)}}if(!this.mass)return r.d.zero(this.localInvInertia),r.d.zero(this.invInertia_),void r.g.transformMat4(this.position,this.center,this.transform);var i=1/this.mass;this.lockAxis_?(r.d.vectorT(this.invMass_,this.lockAxis_,this.lockAxis_),r.d.multiplyScalar(this.invMass_,this.invMass_,i)):r.d.diagonal(this.invMass_,i,i,i),this.shapes.length>1&&(r.g.scale(this.center,this.center,i),a(t,-this.mass,this.center)),r.g.transformMat4(this.position,this.center,this.transform),this.rotates?r.d.invert(this.localInvInertia,t):(r.d.zero(this.localInvInertia),r.d.zero(this.invInertia_))}}},{key:"beginFrame",value:function(t){if(this.updateShape(),this.moves)this.sleeping||(r.g.copy(this.lastVelocity,this.velocity),r.g.copy(this.lastAngVelocity,this.angVelocity),r.g.scaleAndAdd(this.force,this.force,this.gravity,this.mass)),this.calculateInertia();else if(this.animated){if(this.prevPosition&&(r.g.copy(this.prevPosition,this.position),r.f.copy(this.prevOrientation,this.orientation)),r.g.transformMat4(this.position,this.center,this.transform),r.f.fromMat3(this.orientation,r.d.fromMat4(u,this.transform)),r.f.normalize(this.orientation,this.orientation),t>1e-6&&this.prevPosition){r.g.subtract(this.velocity,this.position,this.prevPosition);var e=r.f.conjugate(r.f.create(),this.prevOrientation);r.f.multiply(e,this.orientation,e),r.g.fromQuat(this.angVelocity,e),r.g.scale(this.velocity,this.velocity,1/t),r.g.scale(this.angVelocity,this.angVelocity,1/t)}else r.g.set(this.velocity,0,0,0),r.g.set(this.angVelocity,0,0,0);this.prevPosition||(this.prevPosition=r.g.clone(this.position),this.prevOrientation=r.f.clone(this.orientation)),r.g.copy(this.lastVelocity,this.velocity),r.g.copy(this.lastAngVelocity,this.angVelocity)}}},{key:"applyForces",value:function(t){this.moves&&!this.sleeping&&(r.g.transformMat3(s,this.force,this.invMass_),r.g.scaleAndAdd(this.velocity,this.velocity,s,t),r.g.transformMat3(s,this.torque,this.invInertia_),r.g.scaleAndAdd(this.angVelocity,this.angVelocity,s,t))}},{key:"endFrame",value:function(t){r.g.set(this.force,0,0,0),r.g.set(this.torque,0,0,0),this.moves&&!this.sleeping?(this.linDamping&&r.g.scale(this.velocity,this.velocity,Math.pow(this.linDamping,t)),this.angDamping&&r.g.scale(this.angVelocity,this.angVelocity,Math.pow(this.angDamping,t)),r.g.scaleAndAdd(this.position,this.position,this.velocity,t),r.f.adjustVec3(this.orientation,this.orientation,this.angVelocity,t),this.calculateTransform(),this.calculateInertia(),this.motion_=this.motion,this.motion_<i.a.sleepThreshold?(this.sleepTime+=t,!1!==this.canSleep&&i.a.sleepTime&&this.sleepTime>i.a.sleepTime&&(this.motion_=0,this.sleeping=!0,r.g.set(this.velocity,0,0,0),r.g.set(this.angVelocity,0,0,0))):this.wake()):this.moves||this.animated||(this.motion_=0,this.sleeping=!0)}},{key:"wake",value:function(){if(this.sleepTime=0,this.sleeping)return this.sleeping=!1,!0}},{key:"addImpulse",value:function(t){r.g.transformMat3(s,t,this.invMass),r.g.add(this.velocity,this.velocity,s)}},{key:"addImpulseAt",value:function(t,e){r.g.transformMat3(s,t,this.invMass),r.g.add(this.velocity,this.velocity,s),r.g.subtract(s,e,this.position),r.g.cross(s,s,t),r.g.transformMat3(s,s,this.invInertia),r.g.add(this.angVelocity,this.angVelocity,s)}},{key:"addForce",value:function(t){r.g.add(this.force,this.force,t)}},{key:"addForceAt",value:function(t,e){var n=r.g.subtract(s,e,this.position);r.g.cross(n,n,t),r.g.add(this.force,this.force,t),r.g.add(this.torque,this.torque,n)}},{key:"localToWorld",value:function(t,e){return r.g.transformMat4(t,e,this.transform)}},{key:"velocityAt",value:function(t,e){return r.g.subtract(t,e,this.position),r.g.cross(t,this.angVelocity,t),r.g.add(t,t,this.velocity),t}},{key:"lastVelocityAt",value:function(t,e){return r.g.subtract(t,e,this.position),r.g.cross(t,this.lastAngVelocity,t),r.g.add(t,t,this.lastVelocity),t}},{key:"calculateInertia",value:function(){i.a.angularMomentum&&(r.d.invert(u,this.invInertia_),r.g.transformMat3(this.angMomentum,this.angVelocity,u)),r.d.fromQuat(u,this.orientation),r.d.transformInv(this.invInertia_,this.localInvInertia,u),i.a.angularMomentum&&r.g.transformMat3(this.angVelocity,this.angMomentum,this.invInertia_)}},{key:"calculateTransform",value:function(){r.e.fromQuat(this.transform,this.orientation);var t=r.g.transformMat4(s,this.center,this.transform);r.g.subtract(t,this.position,t),this.transform[12]=t[0],this.transform[13]=t[1],this.transform[14]=t[2],this.shapes.forEach(function(t){return t.update()})}},{key:"unitImpulseMatrix",value:function(t,e){var n=this.invInertia,r=this.invMass,i=e[0]-this.position[0],o=e[1]-this.position[1],a=e[2]-this.position[2],s=n[0],u=n[1],c=n[2],f=n[3],l=n[4],h=n[5],d=n[6],_=n[7],p=n[8],E=a*f-o*d,g=a*l-o*_,v=a*h-o*p,A=i*d-a*s,T=i*_-a*u,y=i*p-a*c,m=o*s-i*f,b=o*u-i*l,R=o*c-i*h;return t[0]=g*a-v*o+r[0],t[1]=v*i-E*a+r[1],t[2]=E*o-g*i+r[2],t[3]=T*a-y*o+r[3],t[4]=y*i-A*a+r[4],t[5]=A*o-T*i+r[5],t[6]=b*a-R*o+r[6],t[7]=R*i-m*a+r[7],t[8]=m*o-b*i+r[8],t}},{key:"moves",get:function(){return this.moveEnabled&&0!==this.shapes.length}},{key:"rotates",get:function(){return this.rotateEnabled&&0!==this.shapes.length}},{key:"invMass",get:function(){return this.sleeping?c:this.invMass_}},{key:"invInertia",get:function(){return this.sleeping?c:this.invInertia_}},{key:"motion",get:function(){var t=r.g.squaredLength(this.velocity)+r.g.squaredLength(this.angVelocity);return.9*this.motion_+.1*t}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(13);n.d(e,"Shape",function(){return r.a});var i=n(193);n.d(e,"Plane",function(){return i.a});var o=n(194);n.d(e,"Sphere",function(){return o.a});var a=n(195);n.d(e,"Capsule",function(){return a.a});var s=n(68);n.d(e,"Hull",function(){return s.a});var u=n(196);n.d(e,"Box",function(){return u.a})},function(t,e,n){"use strict";var r,i,o=n(0),a=n(13),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var u=(i=r=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));r.renderSize=25,r.normal=o.g.clone(t),o.g.normalize(r.normal,r.normal),r.offset=n,o.a.set(r.aabb,-1e4,-1e4,-1e4,1e4,1e4,1e4);for(var i=0;i<3;++i){if(r.normal[i]>.9999){r.aabb[i+3]=r.normal[i]*n;break}if(r.normal[i]<-.9999){r.aabb[i]=r.normal[i]*n;break}}return r}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a["a"]),s(e,[{key:"intersect",value:function(t){var e=o.g.dot(t.pos,this.normal)-this.offset,n=o.g.dot(t.dir,this.normal);if(n>-1e-4&&n<1e-4)return!1;var r=-e/n;return!(r<0)&&r}}]),e}(),r.type="Plane",i);e.a=u},function(t,e,n){"use strict";var r,i,o=n(0),a=n(13),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var u=o.g.create(),c=(i=r=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.localCenter=o.g.clone(t),r.radius=n,r.center=o.g.clone(t),r}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a["a"]),s(e,[{key:"update",value:function(){this.body&&o.g.transformMat4(this.center,this.localCenter,this.body.transform),o.a.setVec3(this.aabb,this.center),o.a.grow(this.aabb,this.aabb,this.radius)}},{key:"getInfo",value:function(t,e){o.g.copy(t,this.localCenter);var n=this.radius*this.radius,r=Math.PI*this.radius*n*4/3*this.material.density,i=.4*r*n;return o.d.diagonal(e,i,i,i),r}},{key:"intersect",value:function(t){var e=o.g.subtract(u,this.center,t.pos),n=o.g.length(e),r=o.g.dot(t.dir,e),i=n*n-r*r,a=this.radius*this.radius;if(a-i<0)return!1;var s=Math.sqrt(a-i);return!(r-s<0)&&r-s}}]),e}(),r.type="Sphere",i);e.a=c},function(t,e,n){"use strict";var r,i,o=n(0),a=n(13),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var u=o.d.create(),c=(i=r=function(t){function e(t,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.localStart=o.g.clone(t),i.localEnd=o.g.clone(n),i.radius=r,i.start=o.g.clone(t),i.end=o.g.clone(n),i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a["a"]),s(e,[{key:"update",value:function(){this.body&&(o.g.transformMat4(this.start,this.localStart,this.body.transform),o.g.transformMat4(this.end,this.localEnd,this.body.transform)),o.a.setVec3(this.aabb,this.start),o.a.combineVec3(this.aabb,this.aabb,this.end),o.a.grow(this.aabb,this.aabb,this.radius)}},{key:"getInfo",value:function(t,e){o.g.lerp(t,this.localStart,this.localEnd,.5);var n=this.radius*this.radius,r=o.g.distance(this.localStart,this.localEnd),i=Math.PI*r*n,a=2*Math.PI*n*this.radius/3,s=n*i*.5,c=.5*s+i*r*r/12,f=c,l=a*n*.4;s+=2*l;var h=.5*r,d=l+a*(h*h+3*r*this.radius/8);c+=2*d,f+=2*d;var _=(i+2*a)*this.material.density;c*=this.material.density,s*=this.material.density,f*=this.material.density;var p=u,E=p.subarray(0,3),g=p.subarray(3,6),v=p.subarray(6,9);return o.g.subtract(g,this.localEnd,this.localStart),o.g.scale(g,g,1/r),o.g.makeBasis(g,E,v),o.d.diagonal(e,c,s,f),o.d.transformInv(e,e,p),_}}]),e}(),r.type="Capsule",i);e.a=c},function(t,e,n){"use strict";var r,i,o=n(0),a=n(68),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var u=o.g.create(),c=(i=r=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=t.transformLocal=o.e.create(),r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];if(3===i.length){var s=.5*i[0],c=.5*i[1],f=.5*i[2];n[0]=s,n[5]=c,n[10]=f,n[12]=s,n[13]=c,n[14]=f}else if(6===i.length){var l=i[0],h=i[1],d=i[2],_=.5*i[3],p=.5*i[4],E=.5*i[5];n[0]=_,n[5]=p,n[10]=E,n[12]=l+_,n[13]=h+p,n[14]=d+E}else 4===i.length?(n.set(i[0],12),n.set(i[1],0),n.set(i[2],4),n.set(i[3],8)):(n.set(i.slice(0,3),12),n.set(i.slice(3,6),0),n.set(i.slice(6,9),4),n.set(i.slice(9,12),8));var g=n.subarray(0,3),v=n.subarray(4,7),A=n.subarray(8,11);o.g.dot(o.g.cross(u,g,v),A)<0&&(o.g.copy(u,v),o.g.copy(v,A),o.g.copy(A,u)),t.orientLocal=o.d.create(),o.d.fromMat4(t.orientLocal,n);var T=t.orientLocal.subarray(0,3),y=o.g.length(T);o.g.scale(T,T,1/y);var m=t.orientLocal.subarray(3,6),b=o.g.length(m);o.g.scale(m,m,1/b);var R=t.orientLocal.subarray(6,9),N=o.g.length(R);o.g.scale(R,R,1/N),t.halfSize=o.g.fromValues(y,b,N),t.transform=o.e.clone(n),t.center=t.transform.subarray(12,15),t.dx=t.transform.subarray(0,3),t.dy=t.transform.subarray(4,7),t.dz=t.transform.subarray(8,11),t.orient=o.d.clone(t.orientLocal),t.nx=t.orient.subarray(0,3),t.ny=t.orient.subarray(3,6),t.nz=t.orient.subarray(6,9),t.axes=[t.nx,t.ny,t.nz],t.extents=[t.dx,t.dy,t.dz];var I,M=t.vertices,O=t.center;return I=M[0]=o.g.clone(O),o.g.sub(I,I,g),o.g.sub(I,I,v),o.g.sub(I,I,A),I=M[1]=o.g.clone(O),o.g.add(I,I,g),o.g.sub(I,I,v),o.g.sub(I,I,A),I=M[2]=o.g.clone(O),o.g.sub(I,I,g),o.g.add(I,I,v),o.g.sub(I,I,A),I=M[3]=o.g.clone(O),o.g.add(I,I,g),o.g.add(I,I,v),o.g.sub(I,I,A),I=M[4]=o.g.clone(O),o.g.sub(I,I,g),o.g.sub(I,I,v),o.g.add(I,I,A),I=M[5]=o.g.clone(O),o.g.add(I,I,g),o.g.sub(I,I,v),o.g.add(I,I,A),I=M[6]=o.g.clone(O),o.g.sub(I,I,g),o.g.add(I,I,v),o.g.add(I,I,A),I=M[7]=o.g.clone(O),o.g.add(I,I,g),o.g.add(I,I,v),o.g.add(I,I,A),t.addFace([0,4,6,2],[1,3,7,5],[0,1,5,4],[2,6,7,3],[0,2,3,1],[4,5,7,6]),t}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a["a"]),s(e,[{key:"updateCenter",value:function(){}},{key:"update",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.body&&(o.e.multiply(this.transform,this.body.transform,this.transformLocal),o.e.multiplyMat3(this.orient,this.body.transform,this.orientLocal))}},{key:"getInfo",value:function(t,e){o.g.copy(t,this.transformLocal.subarray(12,15));var n=this.halfSize[0],r=this.halfSize[1],i=this.halfSize[2],a=8*n*r*i*this.material.density,s=a*(r*r+i*i)/3,u=a*(n*n+i*i)/3,c=a*(n*n+r*r)/3;return o.d.diagonal(e,s,u,c),o.d.transform(e,e,this.orientLocal),a}},{key:"extentsAlong",value:function(t){return Math.abs(o.g.dot(t,this.dx))+Math.abs(o.g.dot(t,this.dy))+Math.abs(o.g.dot(t,this.dz))}},{key:"support",value:function(t){var e=0;return o.g.dot(t,this.dx)>0&&(e+=1),o.g.dot(t,this.dy)>0&&(e+=2),o.g.dot(t,this.dz)>0&&(e+=4),this.vertices[e]}}]),e}(),r.type="Box",i);e.a=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(198);n.d(e,"Spring",function(){return r.default})},function(t,e,n){"use strict";var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=r.g.create(),a=r.g.create(),s=r.g.create();!function(){function t(e,n,i,o,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.body1=e,this.body2=n,this.pos1=r.g.clone(i),this.pos2=r.g.clone(o),this.restLength=a,this.stiffness=s}i(t,[{key:"resolve",value:function(){var t=this.body1.localToWorld(o,this.pos1),e=this.body2.localToWorld(a,this.pos2),n=r.g.subtract(s,o,a),i=r.g.length(n),u=this.stiffness*(this.restLength-i);i>1e-4?r.g.scale(n,n,u/i):r.g.set(n,0,0,u),this.body1.addForceAt(n,t),r.g.negate(n,n),this.body2.addForceAt(n,e)}}])}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(200);n.d(e,"Point",function(){return r.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return v});var r=n(0),i=n(1),o=n(65),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=r.g.create(),u=r.g.create(),c=r.g.create(),f=r.g.create(),l=r.g.create(),h=r.g.create(),d=r.g.create(),_=r.g.create(),p=r.g.create(),E=r.d.create(),g=r.d.create(),v=function(){function t(e,n,i,o,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos1=r.g.create(),this.pos2=r.g.create(),this.massTensor=r.d.create(),this.biasVector=r.g.create(),this.normal=r.g.create(),this.mode=-1,this.body1=e,this.body2=n,this.pos1_local=r.g.clone(i),this.pos2_local=r.g.clone(o),this.minDistance=a||0,this.maxDistance=s||this.minDistance}return a(t,[{key:"init",value:function(){this.body1.localToWorld(this.pos1,this.pos1_local),this.body2.localToWorld(this.pos2,this.pos2_local),r.g.subtract(s,this.pos1,this.pos2);var t=r.g.length(s);if(this.maxDistance>1e-4){var e=this.minDistance>1e-4&&t<this.minDistance+i.a.delta,n=t>this.maxDistance-i.a.delta;if(!e&&!n)return void(this.mode=-1);this.maxDistance-this.minDistance<2*i.a.delta&&(e=!0,n=!0),t>1e-4?r.g.scale(this.normal,s,1/t):r.g.set(this.normal,0,0,1),this.jac1||(this.jac1=new o.a(this.body1,this.body2)),this.jac1.linear(this.pos1,this.pos2,this.normal);var a=this.maxDistance;e&&n?(this.jac1.lower=-1e9,this.jac1.upper=1e9,this.mode=1):e?(this.jac1.lower=0,this.jac1.upper=1e9,this.mode=2,a=this.minDistance):n&&(this.jac1.lower=-1e9,this.jac1.upper=0,this.mode=3);var u=t-a;u>i.a.delta?this.jac1.bias=.2*(u-i.a.delta)/i.a.step:u<-i.a.delta?this.jac1.bias=.2*(u+i.a.delta)/i.a.step:this.jac1.bias=0}else this.mode=0,this.jac3||(this.jac3=new o.c(this.body1,this.body2)),this.jac3.linear(this.pos1,this.pos2),t>i.a.delta?r.g.scale(this.jac3.bias,s,.2*(t-i.a.delta)/t/i.a.step):r.g.set(this.jac3.bias,0,0,0)}},{key:"resolve",value:function(){0===this.mode?this.jac3.resolve():this.mode>0&&this.jac1.resolve()}},{key:"force",value:function(t){0===this.mode?this.jac3.force(t):this.mode>0?this.jac1.force(t):r.g.set(t,0,0,0)}},{key:"initPosition",value:function(){}},{key:"resolvePosition",value:function(){r.g.subtract(f,this.pos1_local,this.body1.center),r.g.subtract(l,this.pos2_local,this.body2.center),r.g.transformQuat(f,f,this.body1.orientation),r.g.transformQuat(l,l,this.body2.orientation),r.g.add(s,f,this.body1.position),r.g.add(u,l,this.body2.position),r.g.subtract(c,s,u);var t=r.g.length(c),e=null;if(this.maxDistance<1e-4){if(t<i.a.delta)return;this.body1.unitImpulseMatrix(E,s),this.body2.unitImpulseMatrix(g,u),r.d.add(E,E,g),r.d.invert(E,E),r.g.scale(c,c,-.2*(t-i.a.delta)/t),e=r.g.transformMat3(c,c,E),r.g.transformMat3(_,e,this.body1.invMass),r.g.transformMat3(p,e,this.body2.invMass),r.g.cross(h,f,e),r.g.cross(d,l,e),r.g.transformMat3(f,h,this.body1.invInertia),r.g.transformMat3(l,d,this.body2.invInertia),r.g.add(this.body1.position,this.body1.position,_),r.g.subtract(this.body2.position,this.body2.position,p),r.f.adjustVec3(this.body1.orientation,this.body1.orientation,f,1),r.f.adjustVec3(this.body2.orientation,this.body2.orientation,l,-1)}else{if(!(t>this.maxDistance+i.a.delta||t<this.minDistance-i.a.delta))return;t<1e-4?r.g.set(c,0,0,1):r.g.scale(c,c,1/t),r.g.transformMat3(_,c,this.body1.invMass),r.g.transformMat3(p,c,this.body2.invMass),r.g.cross(h,f,c),r.g.cross(d,l,c),r.g.transformMat3(f,h,this.body1.invInertia),r.g.transformMat3(l,d,this.body2.invInertia);var n=r.g.dot(c,_)+r.g.dot(c,p)+r.g.dot(f,h)+r.g.dot(l,d),o=void 0;o=t>this.maxDistance?-.2*(t-this.maxDistance-i.a.delta)/n:.2*(this.minDistance-t-i.a.delta)/n,r.g.scaleAndAdd(this.body1.position,this.body1.position,_,o),r.f.adjustVec3(this.body1.orientation,this.body1.orientation,f,o),r.g.scaleAndAdd(this.body2.position,this.body2.position,p,-o),r.f.adjustVec3(this.body2.orientation,this.body2.orientation,l,-o)}this.body1.calculateInertia(),this.body2.calculateInertia()}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return O});var r,i,o=n(3),a=n.n(o),s=n(0),u=n(2),c=n(202),f=n(231),l=n(235),h=n(236),d=n(241),_=n(249),p=n(250),E=n.n(p),g=n(251),v=n.n(g),A=n(252),T=n.n(A),y=n(253),m=n.n(y),b=n(254),R=n.n(b),N=n(255),I=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),M=(r=["\n          ","\n          uniform LightBlock "," u_Light;\n          ","\n        "],i=["\n          ","\n          uniform LightBlock "," u_Light;\n          ","\n        "],Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(i)}})));var O=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));for(var r in n.globalTransform=s.e.create(),n.vpMatrix=s.e.create(),n.invVpMatrix=s.e.create(),n.viewNormalMatrix=s.d.create(),n.Lights={},n.Shadows={},d)n.Lights[r]=d[r].bind(null,n);for(var i in h)n.Shadows[i]=h[i].bind(null,n);if(!n.gl.getExtension("EXT_color_buffer_float"))throw"FLOAT color buffer not available";n.noShadow=new h.None(n),n.quad=Object(_.a)(n,-1,-1,1,1),n.gbuffer=new n.RenderTarget(n.width,n.height,{color:{attachment:u.COLOR_ATTACHMENT0,format:u.RGBA16F,filter:u.NEAREST,wrap:u.CLAMP_TO_EDGE,clear:[0,0,0,0]},normal:{attachment:u.COLOR_ATTACHMENT1,format:u.RGBA32F,filter:u.NEAREST,wrap:u.CLAMP_TO_EDGE,clear:[0,0,0,0]},emissive:{attachment:u.COLOR_ATTACHMENT2,format:u.RGBA8,filter:u.NEAREST,wrap:u.CLAMP_TO_EDGE,clear:[0,0,0,0]},depth:{format:u.DEPTH_COMPONENT32F,filter:u.NEAREST,wrap:u.CLAMP_TO_EDGE,clear:1}},{depthTest:!0,depthMask:!0,blend:!1,cull:!0}),n.accumBuffer=new n.RenderTarget(n.width,n.height,{color:{format:u.RGBA16F,filter:u.NEAREST,wrap:u.CLAMP_TO_EDGE,clear:[0,0,0,0]}},{depthTest:!1,depthMask:!1,blend:!0,blendFunc:[u.ONE,u.ONE]}),n.ssrBuffer=new n.RenderTarget(n.width,n.height,{color:{format:u.RGBA16F,filter:u.NEAREST,wrap:u.CLAMP_TO_EDGE,clear:[0,0,0,0]}},{depthTest:!1,depthMask:!1,blend:!1}),n.screenBuffer=new n.RenderTarget(n.width,n.height,{color:{format:u.RGBA8,filter:u.LINEAR,wrap:u.CLAMP_TO_EDGE}},{depthTest:!1,depthMask:!1,blend:!1}),n.finalPass=new n.Shader(T.a,m.a,{defines:{USE_REFLECTION:0}}),n.finalPassSSR=new n.Shader(T.a,m.a,{defines:{USE_REFLECTION:1}}),n.ssrPass=new n.Shader(T.a,R.a);var o=s.e.create(),a=o.subarray(0,3),c=o.subarray(4,7),p=o.subarray(8,11);s.g.normalize(p,[0,0,1]),s.g.makeBasis(p,a,c);var E=new n.Lights.Directional(s.e.create(),[1,1,1]);return n.shadowTypes={none:n.noShadow,pcf:new n.Shadows.PCF(1024,1),vsm:new n.Shadows.VSM(512,4,!0)},E.shadow=n.shadowTypes.pcf,n.lights=[],n.box=Object(l.a)(n),n.fxaa=new f.a(n),n}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c["a"]),I(e,[{key:"lightPassShader",value:function(t,e,n){var r=new this.Shader(E.a,v.a,{fragments:{lightCode:a()(M,t.constructor.lightInfo,t.constructor.declaration,t.shaderCode),lightFunction:t.shaderFunc,shadowCode:n},defines:{SHADOWMAP_ARRAY:t.constructor.arraySize||0,NEEDS_DERIVATIVES:e.constructor.needsDerivatives?1:0,CALCULATE_DERIVATIVES:e.constructor.needsDerivatives&&!t.constructor.providesDerivatives?1:0}});return r.vec4("u_Transform",[1,1,0,0]),r}},{key:"updateLightShader",value:function(t){t.sampler("u_Color",this.gbuffer.color),t.sampler("u_Normal",this.gbuffer.normal),t.sampler("u_Depth",this.gbuffer.depth)}},{key:"pickRay",value:function(t,e){var n=s.g.fromValues(t/this.width*2-1,1-e/this.height*2,-1);return n[0]*=this.camera.tanX,n[1]*=this.camera.tanY,s.g.transformMat4(n,n,this.camera.world),s.g.subtract(n,n,this.camera.pos),s.g.normalize(n,n),new s.b(this.camera.pos,n)}},{key:"render",value:function(t,e){var n=this,r=new this.RenderList;this.lights=[],e.resolve(this.globalTransform,r,this.lights),this.beginFrame(t)&&(this.gbuffer.resize(this.width,this.height),this.accumBuffer.resize(this.width,this.height),this.ssrBuffer.resize(this.width,this.height),this.screenBuffer.resize(this.width,this.height),this.finalPass.sampler("u_Color",this.accumBuffer.color),this.finalPass.sampler("u_Emissive",this.gbuffer.emissive),this.finalPassSSR.sampler("u_Color",this.accumBuffer.color),this.finalPassSSR.sampler("u_Emissive",this.gbuffer.emissive),this.finalPassSSR.sampler("u_Reflection",this.ssrBuffer.color),this.ssrPass.sampler("u_Color",this.gbuffer.color),this.ssrPass.sampler("u_Normal",this.gbuffer.normal),this.ssrPass.sampler("u_Emissive",this.gbuffer.emissive),this.ssrPass.sampler("u_Accum",this.accumBuffer.color),this.ssrPass.sampler("u_Depth",this.gbuffer.depth),s.e.multiply(this.vpMatrix,t.projection,t.view),s.e.invert(this.invVpMatrix,this.vpMatrix),this.gbuffer.bind().clear(),r.render(N.a,function(t){t.mat4("u_ViewProjectionMatrix",n.vpMatrix)}),this.gbuffer.unbind(),this.accumBuffer.bind().clear(),this.lights.forEach(function(e){return e.render(t,r)}),this.accumBuffer.unbind(),this.reflection?(this.ssrBuffer.bind().clear(),this.ssrPass.vec4("u_InvProj",t.inverseProj()),s.d.normalFromMat4(this.viewNormalMatrix,t.view),this.ssrPass.mat3("u_ViewMatrix",this.viewNormalMatrix),this.ssrPass.mat4("u_InverseViewMatrix",t.world),this.ssrPass.render(this.quad),this.ssrBuffer.unbind(),this.screenBuffer.bind(),this.finalPassSSR.render(this.quad),this.screenBuffer.unbind()):(this.screenBuffer.bind(),this.finalPass.render(this.quad),this.screenBuffer.unbind()),this.state.depthTest=!1,this.state.depthMask=!1,this.state.blend=!1,this.fxaa.apply(this.screenBuffer.color),this.endFrame())}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(0),i=n(2),o=n(203),a=n(224),s=n(225),u=n(226),c=n(227),f=n(228),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var h=function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.matApplied=!1,this.matStack=[r.e.create()],this.matStackPos=0,this.activeTexture=[],this.activeProgram=null,this.activeRenderTargetStack=[],this.activeVertexArray=null,this.objectCache={},this.Filters={},this.extensions={},o)this[n]=o[n].bind(null,this);for(var l in f)this.Filters[l]=f[l].bind(null,this);this.canvas=e;var h=this.gl=e.getContext("webgl2",{alpha:!1,premultipliedAlpha:!1});if(h){this.width=h.drawingBufferWidth,this.height=h.drawingBufferHeight,h.clearColor(0,0,0,1),h.clearDepth(1),h.enable(i.DEPTH_TEST),h.enable(i.BLEND),h.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA);for(var d=new Uint8Array(256),_=0;_<d.length;++_)d[_]=255;this.white=new this.Texture,this.white.bind().loadPixels(8,8,d).filter(i.LINEAR).wrap(i.REPEAT),this.primitives={Plane:Object(a.a)(this),Box:Object(s.a)(this),Sphere:Object(u.a)(this)},this.state=new c.a(h)}}return l(t,[{key:"beginFrame",value:function(t){var e=this.gl;return this.width=e.drawingBufferWidth,this.height=e.drawingBufferHeight,!0!==document.hidden&&(this.camera=t,this.camera.update(this.width/this.height),this.activeTexture.length=0,this.activeProgram=null,this.activeRenderTargetStack.length=0,this.activeVertexArray=null,e.viewport(0,0,this.width,this.height),e.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT),!0)}},{key:"endFrame",value:function(){this.gl.flush()}},{key:"setState",value:function(t){var e={};for(var n in t)e[n]=this.state[n],this.state[n]=t[n];return e}},{key:"cache",value:function(t,e){var n=this.objectCache[t];return n||(n=this.objectCache[t]=e()),n}},{key:"extension",value:function(t){return this.extensions.hasOwnProperty(t)?this.extensions[t]:this.extensions[t]=this.gl.getExtension(t)}},{key:"defaultMaterial",get:function(){return this.defaultMaterial_?this.defaultMaterial_:this.defaultMaterial_=new this.Material}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(204);n.d(e,"FrameBuffer",function(){return r.a});var i=n(205);n.d(e,"Material",function(){return i.a});var o=n(206);n.d(e,"MultiTarget",function(){return o.a});var a=n(207);n.d(e,"Primitive",function(){return a.a});var s=n(32);n.d(e,"RenderBuffer",function(){return s.a});var u=n(208);n.d(e,"RenderList",function(){return u.a});var c=n(209);n.d(e,"RenderTarget",function(){return c.a});var f=n(34);n.d(e,"Shader",function(){return f.a});var l=n(70);n.d(e,"Texture",function(){return l.a});var h=n(33);n.d(e,"UniformBuffer",function(){return h.a});var d=n(69);n.d(e,"VertexArray",function(){return d.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(2),i=n(32),o=n(5),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=function(t){function e(t,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.ownedBuffers=[],i.width=n,i.height=r,i.buffer=t.gl.createFramebuffer(),i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o["a"]),a(e,[{key:"bind",value:function(){return this.prevBuffer=this.renderer.gl.getParameter(r.FRAMEBUFFER_BINDING),this.renderer.gl.bindFramebuffer(r.FRAMEBUFFER,this.buffer),this}},{key:"unbind",value:function(){return this.renderer.gl.bindFramebuffer(r.FRAMEBUFFER,this.prevBuffer),delete this.prevBuffer,this}},{key:"read",value:function(t,e,n,i,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r.RGBA,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r.UNSIGNED_BYTE,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r.COLOR_ATTACHMENT0;return this.renderer.gl.readBuffer(u),this.renderer.gl.readPixels(e,n,i,o,a,s,t),this}},{key:"texture",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.TEXTURE_2D,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.renderer.gl.framebufferTexture2D(r.FRAMEBUFFER,t,n,e.texture,i),this}},{key:"textureLayer",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.renderer.gl.framebufferTextureLayer(r.FRAMEBUFFER,t,e.texture,i,n),this}},{key:"renderbuffer",value:function(t,e){return this.renderer.gl.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,e.buffer),this}},{key:"createBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new i.a(this.renderer,this.width,this.height,e,n);return this.ownedBuffers.push(r),this.renderbuffer(t,r)}},{key:"createColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.RGBA8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.COLOR_ATTACHMENT0;return this.createBuffer(e,t)}},{key:"createDepth",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.DEPTH_COMPONENT16;return this.createBuffer(r.DEPTH_ATTACHMENT,t)}},{key:"createStencil",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.STENCIL_INDEX8;return this.createBuffer(r.STENCIL_ATTACHMENT,t)}},{key:"createDepthStencil",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.DEPTH_STENCIL;return this.createBuffer(r.DEPTH_STENCIL_ATTACHMENT,t)}},{key:"blit",value:function(t,e,n,i,o,a,s,u,c){var f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT|r.STENCIL_BUFFER_BIT,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:r.NEAREST,h=this.renderer.gl;return h.bindFramebuffer(r.READ_FRAMEBUFFER,t.buffer),h.blitFramebuffer(e,n,i,o,a,s,u,c,f,l),h.bindFramebuffer(r.READ_FRAMEBUFFER,null),this}},{key:"destroy",value:function(){this.ownedBuffers.forEach(function(t){return t.destroy()}),this.renderer.gl.deleteFramebuffer(this.buffer)}},{key:"checkStatus",value:function(){switch(this.renderer.gl.checkFramebufferStatus(r.FRAMEBUFFER)){case r.FRAMEBUFFER_COMPLETE:return!0;case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw"The attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete.";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw"There is no attachment.";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw"Height and width of the attachment are not the same.";case r.FRAMEBUFFER_UNSUPPORTED:throw"The format of the attachment is not supported or depth and stencil attachments are not the same renderbuffer.";case r.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:throw"The values of RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures."}}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(33),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=Object(i.a)(null,[["vec4","baseColorFactor"],["vec3","emissiveFactor"],["float","metallicFactor"],["float","roughnessFactor"],["float","normalScale"],["float","occlusionStrength"],["float","alphaCutoff"]]),s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.baseColorTexture=null,i.metallicRoughnessTexture=null,i.normalTexture=null,i.occlussionTexture=null,i.emissiveTexture=null,i.alphaMode="OPAQUE",i.doubleSided=!1,r.h.set(i.baseColorFactor,1,1,1,1),r.g.set(i.emissiveFactor,0,0,0),i.metallicFactor=1,i.roughnessFactor=1,i.normalScale=1,i.occlussionStrength=1,i.alphaCutoff=.5,i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),o(e,[{key:"setColor",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return r.h.set(this.baseColorFactor,t,e,n,i),this}},{key:"setEmissive",value:function(t,e,n){return r.g.set(this.emissiveFactor,t,e,n),this}},{key:"apply",value:function(t){t.uniforms("MaterialBlock",this),this.baseColorTexture&&t.sampler("u_BaseColorTexture",this.baseColorTexture.texture),this.metallicRoughnessTexture&&t.sampler("u_MetallicRoughnessTexture",this.metallicRoughnessTexture.texture),this.normalTexture&&t.sampler("u_NormalTexture",this.normalTexture.texture),this.occlussionTexture&&t.sampler("u_OcclussionTexture",this.occlussionTexture.texture),this.emissiveTexture&&t.sampler("u_EmissiveTexture",this.emissiveTexture.texture)}},{key:"defines",get:function(){var t={};return this.baseColorTexture&&this.baseColorTexture.texture&&(t.MATERIAL_BASE_COLOR_TEXTURE=this.baseColorTexture.texCoord||0),this.metallicRoughnessTexture&&this.metallicRoughnessTexture.texture&&(t.MATERIAL_METALLIC_ROUGHNESS_TEXTURE=this.metallicRoughnessTexture.texCoord||0),this.normalTexture&&this.normalTexture.texture&&(t.MATERIAL_NORMAL_TEXTURE=this.normalTexture.texCoord||0),this.occlussionTexture&&this.occlussionTexture.texture&&(t.MATERIAL_OCCLUSION_TEXTURE=this.occlussionTexture.texCoord||0),this.emissiveTexture&&this.emissiveTexture.texture&&(t.MATERIAL_EMISSIVE_TEXTURE=this.emissiveTexture.texCoord||0),"BLEND"===this.alphaMode?t.MATERIAL_ALPHA_BLEND=1:"MASK"===this.alphaMode?t.MATERIAL_ALPHA_MASK=1:t.MATERIAL_OPAQUE=1,this.doubleSided&&(t.MATERIAL_DOUBLE_SIDED=1),t}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(5),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=function(t){function e(t,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.source=new t.RenderTarget(n,r,i,o),a.target=new t.RenderTarget(n,r,i,o);var s=function(t){Object.defineProperty(a,t,{get:function(){return a.source[t]}})};for(var u in i)s(u);return a}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r["a"]),i(e,[{key:"destroy",value:function(){this.source.destroy(),this.target.destroy()}},{key:"bind",value:function(){return this.target.bind(),this}},{key:"clear",value:function(){return this.target.clear(),this}},{key:"unbind",value:function(){return!!this.target.unbind()&&(this.swap(),!0)}},{key:"swap",value:function(){var t=this.target;this.target=this.source,this.source=t;var e=this.renderer.activeRenderTargetStack;if(e.length&&e[e.length-1]===t){for(var n=e.length-1;n>=0&&e[n]===t;--n)e[n]=this.target;this.target.prevParams=t.prevParams,delete t.prevParams,this.target.buffer.unbind(),t.buffer.bind()}return this}},{key:"resize",value:function(t,e){return this.source.resize(t,e),this.target.resize(t,e),this}},{key:"width",get:function(){return this.source.width}},{key:"height",get:function(){return this.target.height}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(5),i=n(0),o=n(69),a=n(2),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var u=function(t){function e(t,n,r,s,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));if(c.mode=a.TRIANGLES,n instanceof o.a)c.vertexArray=n,r&&(c.indices=r);else{var f=r||{},l=f.buffer,h=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(f,["buffer"]);c.vertexArray=new t.VertexArray(n,l),r&&(c.indices=h)}return c.count=s,c.box=i.a.clone(u),c.material=t.defaultMaterial,c}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r["a"]),s(e,[{key:"clone",value:function(t){var n=new e(this.renderer,this.vertexArray,this.indices,this.count,this.box);return n.material=t||this.material,n}},{key:"render",value:function(){this.indices?this.renderer.gl.drawElements(this.mode,this.count,this.indices.type,this.indices.offset||0):this.renderer.gl.drawArrays(this.mode,0,this.count)}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(5),i=n(0),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s=i.d.create(),u=i.e.create(),c=i.a.create(),f=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.list=[],i.list=n,i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r["a"]),a(e,[{key:"clear",value:function(){this.list.length=0}},{key:"add",value:function(t,e,n){this.list.push({matrix:t,primitive:e,morphWeights:n})}},{key:"getBoundingBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.list.reduce(function(e,n){var r=n.matrix,o=n.primitive;return i.e.fromAABB(u,o.box),i.e.multiply(u,r,u),t&&i.e.multiply(u,t,u),i.a.fromMat4(c,u),e?i.a.combine(e,e,c):i.a.clone(c)},null)}},{key:"render",value:function(t,e){var n=this,r=new Map;this.list.forEach(function(t){return delete t.primitive.shader_}),this.list.forEach(function(i){var a=i.primitive,s=i.skin;if(!a.shader_){var u=a.vertexArray.attributes,c={};t.useMaterials&&(r.has(a.material)?c=r.get(a.material):r.set(a.material,c=a.material.defines)),s&&(c=o({},c,{NUM_SKIN_MATRICES:s.joints.length}));var f=(t.shaderName||t.name)+"|"+u.join(",")+"|"+JSON.stringify(c);a.shader_=n.renderer.cache(f,function(){return new t(n.renderer,u,c)}),e&&e(a.shader_),delete a.shader_.skin_,delete a.shader_.material_}}),this.list.sort(function(t,e){var n=t.primitive,r=e.primitive,i="BLEND"===n.material.alphaMode?1:0,o="BLEND"===r.material.alphaMode?1:0;return i!==o?i-o:n.shader_!==r.shader_?n.shader_.instanceId-r.shader_.instanceId:n.vertexArray!==r.vertexArray?n.vertexArray.instanceId-r.vertexArray.instanceId:n.material.instanceId-r.material.instanceId});var a=null;this.list.forEach(function(e){var n=e.matrix,r=e.primitive,o=e.morphWeights,u=e.skin,c=r.shader_;if(c.use(),u&&u!==c.skin_&&(c.skin_=u),c.mat4("u_ModelMatrix",n),i.d.normalFromMat4(s,n),c.mat3("u_NormalMatrix",s),t.useMaterials&&c.material_!==r.material&&(r.material.apply(c),c.material_=r.material),o)if(o.length<4){var f=new Float32Array(4);f.set(o),c.vec4("u_MorphWeights",f)}else o.length>4?c.vec4("u_MorphWeights",o.subarray(0,4)):c.vec4("u_MorphWeights",o);a!==r.vertexArray&&(a=r.vertexArray.bind()),r.render()}),this.renderer.gl.bindVertexArray(null)}},{key:"filter",value:function(t){return new e(this.renderer,this.list.filter(t),this.name)}},{key:"length",get:function(){return this.list.length}}]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return _});var r=n(2),i=n(70),o=n(32),a=n(5),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function u(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var c={color:r.COLOR_ATTACHMENT0,color0:r.COLOR_ATTACHMENT0,color1:r.COLOR_ATTACHMENT1,color2:r.COLOR_ATTACHMENT2,color3:r.COLOR_ATTACHMENT3,color4:r.COLOR_ATTACHMENT4,color5:r.COLOR_ATTACHMENT5,color6:r.COLOR_ATTACHMENT6,color7:r.COLOR_ATTACHMENT7,color8:r.COLOR_ATTACHMENT8,color9:r.COLOR_ATTACHMENT9,color10:r.COLOR_ATTACHMENT10,color11:r.COLOR_ATTACHMENT11,color12:r.COLOR_ATTACHMENT12,color13:r.COLOR_ATTACHMENT13,color14:r.COLOR_ATTACHMENT14,color15:r.COLOR_ATTACHMENT15,depth:r.DEPTH_ATTACHMENT,stencil:r.STENCIL_ATTACHMENT,depth_stencil:r.DEPTH_STENCIL_ATTACHMENT};function f(t){switch(t){case"depth":return r.DEPTH_COMPONENT16;case"stencil":return r.STENCIL_INDEX8;case"depth_stencil":return r.DEPTH24_STENCIL8;default:return r.RGBA8}}var l=[r.R8I,r.RG8I,r.RGB8I,r.RGBA8I,r.R16I,r.RG16I,r.RGB16I,r.RGBA16I,r.R32I,r.RG32I,r.RGB32I,r.RGBA32I],h=[r.R8UI,r.RG8UI,r.RGB8UI,r.RGBA8UI,r.R16UI,r.RG16UI,r.RGB16UI,r.RGBA16UI,r.R32UI,r.RG32UI,r.RGB32UI,r.RGBA32UI,r.RGB10_A2UI];function d(t,e,n){switch("number"===typeof n&&(n=[n]),t){case r.DEPTH_ATTACHMENT:return function(t){return t.clearBufferfv(r.DEPTH,0,n)};case r.STENCIL_ATTACHMENT:return function(t){return t.clearBufferiv(r.STENCIL,0,n)};case r.DEPTH_STENCIL_ATTACHMENT:return function(t){return t.clearBufferfi(r.DEPTH_STENCIL,0,n[0],n[1])};default:var i=t-r.COLOR_ATTACHMENT0;return l.includes(e)?function(t){return t.clearBufferiv(r.COLOR,i,n)}:h.includes(e)?function(t){return t.clearBufferuiv(r.COLOR,i,n)}:function(t){return t.clearBufferfv(r.COLOR,i,n)}}}var _=function(t){function e(t,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.ownedAttachments=[],a.width=n,a.height=r,a.attachments=i,a.drawBuffers=o&&o.drawBuffers;var s=a.buffer=new t.FrameBuffer(n,r);return s.bind(),a.createAttachments(i),s.checkStatus(),s.unbind(),a.defViewport=[0,0,n,r],a.params=Object.assign({viewport:a.defViewport},o),a.params.viewport||delete a.params.viewport,delete a.params.drawBuffers,a}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a["a"]),s(e,[{key:"createAttachments",value:function(t){var e=this.buffer,n=this.width,a=this.height,s=this.renderer,_=[];for(var p in t){var E=t[p];if(E){var g=E,v=0,A=r.TEXTURE_2D,T=0,y=null,m=null;if(!0===E)g=new s.RenderBuffer(n,a,f(p));else if("number"===typeof E||r[E])g=(new s.Texture).create(n,a,"number"===typeof E?E:r[E]);else if(!(g instanceof i.a)&&!(g instanceof o.a))if(y=E.attachment,m=E.clear,E.texture instanceof i.a)g=E.texture,T=E.level||0,v=E.layer||0;else if("buffer"===E.type||"renderbuffer"===E.type)g=new s.RenderBuffer(E.width||n,E.height||a,E.format||f(p),E.samples||1);else{var b,R,N,I;if(A=E.target||r.TEXTURE_2D,g=new s.Texture(A),A===r.TEXTURE_2D_ARRAY?g.create3D(E.width||n,E.height||a,E.layers||1,E.format||f(p),E.levels||1):g.create(E.width||n,E.height||a,E.format||f(p),E.levels||1),E.filter)if(Array.isArray(E.filter))(b=g).filter.apply(b,u(E.filter));else g.filter(E.filter);if(E.wrap)if(Array.isArray(E.wrap))(R=g).wrap.apply(R,u(E.wrap));else g.wrap(E.wrap);if(E.mipmap)(N=g).mipmapLevels.apply(N,u(E.mipmap));if(E.lod)(I=g).clampLod.apply(I,u(E.lod));E.compare&&g.compareMode(r.COMPARE_REF_TO_TEXTURE,!0===E.compare?r.LEQUAL:E.compare),T=E.level||0,v=E.layer||0}if(g!==E&&g!==E.texture&&this.ownedAttachments.push(g),!y){if(!c.hasOwnProperty(p))throw new TypeError("new RenderTarget(): invalid attachment type "+p);y=c[p]}this[p]=g,y>=r.COLOR_ATTACHMENT0&&y<=r.COLOR_ATTACHMENT15&&_.push(y),g instanceof i.a?g.target===r.TEXTURE_2D_ARRAY?e.textureLayer(y,g,v,T):e.texture(y,g,A,T):g instanceof o.a&&e.renderbuffer(y,g),!m&&l.includes(g.format)?m=new Int32Array([0,0,0,0]):!m&&h.includes(g.format)&&(m=new Uint32Array([0,0,0,0])),m&&(this.clearFunc=this.clearFunc||[],this.clearFunc.push(d(y,g.format,m)))}}s.gl.drawBuffers(this.drawBuffers||_)}}]),s(e,[{key:"destroy",value:function(){this.ownedAttachments.forEach(function(t){return t.destroy()}),this.buffer.destroy()}},{key:"bind",value:function(){var t=this.renderer.activeRenderTargetStack;if(!t.length||t[t.length-1]!==this){if(this.prevParams)throw"RenderTarget.bind(): non-consecutive nested bind call";this.buffer.bind(),this.prevParams=this.renderer.setState(this.params)}return t.push(this),this}},{key:"unbind",value:function(){var t=this.renderer.activeRenderTargetStack;return t.pop(),(!t.length||t[t.length-1]!==this)&&(this.buffer.unbind(),this.renderer.setState(this.prevParams),delete this.prevParams,!0)}},{key:"clear",value:function(){var t=this;return this.clearFunc?this.clearFunc.forEach(function(e){return e(t.renderer.gl)}):this.renderer.gl.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this}},{key:"blit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT|r.STENCIL_BUFFER_BIT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.NEAREST;this.buffer.blit(t.buffer,0,0,t.width,t.height,0,0,this.width,this.height,e,n)}},{key:"resize",value:function(t,e){return t===this.width&&e===this.height?this:(this.width=t,this.height=e,this.defViewport[2]=t,this.defViewport[3]=e,this.buffer.bind(),this.ownedAttachments.forEach(function(t){return t.destroy()}),this.createAttachments(this.attachments),this.buffer.checkStatus(),this.buffer.unbind(),this)}}]),e}()},function(t,e,n){var r=n(211).sprintf,i=n(212),o=n(214),a=n(221);t.exports=function(t,e,n){"use strict";var s=o(e)||"of unknown name (see npm glsl-shader-name)",u="unknown type";void 0!==n&&(u=n===i.FRAGMENT_SHADER?"fragment":"vertex");for(var c=r("Error compiling %s shader %s:\n",u,s),f=r("%s%s",c,t),l=t.split("\n"),h={},d=0;d<l.length;d++){var _=l[d];if(""!==_&&"\0"!==_){var p=parseInt(_.split(":")[2]);if(isNaN(p))throw new Error(r("Could not parse error: %s",_));h[p]=h[p]||[],h[p].push(_)}}for(var E=a(e).split("\n"),d=0;d<E.length;d++)if(h[d+3]||h[d+2]||h[d+1]){var g=E[d];if(c+=g+"\n",h[d+1])for(var v=h[d+1],A=0;A<v.length;A++){var T=v[A];T=T.substr(T.split(":",3).join(":").length+1).trim(),c+=r("^^^ %s\n\n",T)}}return{long:c.trim(),short:f.trim()}}},function(t,e,n){!function(t){var n={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function r(){var t=arguments[0],e=r.cache;return e[t]&&e.hasOwnProperty(t)||(e[t]=r.parse(t)),r.format.call(null,e[t],arguments)}r.format=function(t,e){var i,a,s,u,c,f,l,h,d=1,_=t.length,p="",E=[],g=!0,v="";for(a=0;a<_;a++)if("string"===(p=o(t[a])))E[E.length]=t[a];else if("array"===p){if((u=t[a])[2])for(i=e[d],s=0;s<u[2].length;s++){if(!i.hasOwnProperty(u[2][s]))throw new Error(r("[sprintf] property '%s' does not exist",u[2][s]));i=i[u[2][s]]}else i=u[1]?e[u[1]]:e[d++];if("function"==o(i)&&(i=i()),n.not_string.test(u[8])&&n.not_json.test(u[8])&&"number"!=o(i)&&isNaN(i))throw new TypeError(r("[sprintf] expecting number but found %s",o(i)));switch(n.number.test(u[8])&&(g=i>=0),u[8]){case"b":i=i.toString(2);break;case"c":i=String.fromCharCode(i);break;case"d":case"i":i=parseInt(i,10);break;case"j":i=JSON.stringify(i,null,u[6]?parseInt(u[6]):0);break;case"e":i=u[7]?i.toExponential(u[7]):i.toExponential();break;case"f":i=u[7]?parseFloat(i).toFixed(u[7]):parseFloat(i);break;case"g":i=u[7]?parseFloat(i).toPrecision(u[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=String(i))&&u[7]?i.substring(0,u[7]):i;break;case"u":i>>>=0;break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}n.json.test(u[8])?E[E.length]=i:(!n.number.test(u[8])||g&&!u[3]?v="":(v=g?"+":"-",i=i.toString().replace(n.sign,"")),f=u[4]?"0"===u[4]?"0":u[4].charAt(1):" ",l=u[6]-(v+i).length,c=u[6]&&l>0?(h=f,Array(l+1).join(h)):"",E[E.length]=u[5]?v+i+c:"0"===f?v+c+i:c+v+i)}return E.join("")},r.cache={},r.parse=function(t){for(var e=t,r=[],i=[],o=0;e;){if(null!==(r=n.text.exec(e)))i[i.length]=r[0];else if(null!==(r=n.modulo.exec(e)))i[i.length]="%";else{if(null===(r=n.placeholder.exec(e)))throw new SyntaxError("[sprintf] unexpected placeholder");if(r[2]){o|=1;var a=[],s=r[2],u=[];if(null===(u=n.key.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a[a.length]=u[1];""!==(s=s.substring(u[0].length));)if(null!==(u=n.key_access.exec(s)))a[a.length]=u[1];else{if(null===(u=n.index_access.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");a[a.length]=u[1]}r[2]=a}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i[i.length]=r}e=e.substring(r[0].length)}return i};var i=function(t,e,n){return(n=(e||[]).slice(0)).splice(0,0,t),r.apply(null,n)};function o(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}e.sprintf=r,e.vsprintf=i}("undefined"===typeof window||window)},function(t,e,n){var r=n(213);t.exports=function(t){return r[t]}},function(t,e){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34000:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},function(t,e,n){var r=n(215),i=n(220);t.exports=function(t){for(var e=Array.isArray(t)?t:r(t),n=0;n<e.length;n++){var o=e[n];if("preprocessor"===o.type){var a=o.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(a&&a[2]){var s=a[1],u=a[2];return(s?i(u):u).trim()}}}}},function(t,e,n){var r=n(216);t.exports=function(t,e){var n=r(e),i=[];return i=(i=i.concat(n(t))).concat(n(null))}},function(t,e,n){t.exports=function(t){var e,n,b,R=0,N=0,I=u,M=[],O=[],P=1,S=0,x=0,w=!1,L=!1,F="",U=o,C=r;"300 es"===(t=t||{}).version&&(U=s,C=a);return function(t){return O=[],null!==t?function(t){var n;R=0,b=(F+=t).length;for(;e=F[R],R<b;){switch(n=R,I){case f:R=k();break;case l:case h:R=j();break;case d:R=Y();break;case _:R=G();break;case y:R=H();break;case p:R=z();break;case c:R=Q();break;case A:R=X();break;case u:R=B()}if(n!==R)switch(F[n]){case"\n":S=0,++P;break;default:++S}}return N+=R,F=F.slice(R),O}(t.replace?t.replace(/\r\n/g,"\n"):t):function(t){M.length&&D(M.join(""));return I=T,D("(eof)"),O}()};function D(t){t.length&&O.push({type:m[I],data:t,position:x,line:P,column:S})}function B(){return M=M.length?[]:M,"/"===n&&"*"===e?(x=N+R-1,I=f,n=e,R+1):"/"===n&&"/"===e?(x=N+R-1,I=l,n=e,R+1):"#"===e?(I=h,x=N+R,R):/\s/.test(e)?(I=A,x=N+R,R):(w=/\d/.test(e),L=/[^\w_]/.test(e),x=N+R,I=w?_:L?d:c,R)}function X(){return/[^\s]/g.test(e)?(D(M.join("")),I=u,R):(M.push(e),n=e,R+1)}function j(){return"\r"!==e&&"\n"!==e||"\\"===n?(M.push(e),n=e,R+1):(D(M.join("")),I=u,R)}function k(){return"/"===e&&"*"===n?(M.push(e),D(M.join("")),I=u,R+1):(M.push(e),n=e,R+1)}function Y(){if("."===n&&/\d/.test(e))return I=p,R;if("/"===n&&"*"===e)return I=f,R;if("/"===n&&"/"===e)return I=l,R;if("."===e&&M.length){for(;V(M););return I=p,R}if(";"===e||")"===e||"("===e){if(M.length)for(;V(M););return D(e),I=u,R+1}var t=2===M.length&&"="!==e;if(/[\w_\d\s]/.test(e)||t){for(;V(M););return I=u,R}return M.push(e),n=e,R+1}function V(t){for(var e,n,r=0;;){if(e=i.indexOf(t.slice(0,t.length+r).join("")),n=i[e],-1===e){if(r--+t.length>0)continue;n=t.slice(0,1).join("")}return D(n),x+=n.length,(M=M.slice(n.length)).length}}function H(){return/[^a-fA-F0-9]/.test(e)?(D(M.join("")),I=u,R):(M.push(e),n=e,R+1)}function G(){return"."===e?(M.push(e),I=p,n=e,R+1):/[eE]/.test(e)?(M.push(e),I=p,n=e,R+1):"x"===e&&1===M.length&&"0"===M[0]?(I=y,M.push(e),n=e,R+1):/[^\d]/.test(e)?(D(M.join("")),I=u,R):(M.push(e),n=e,R+1)}function z(){return"f"===e&&(M.push(e),n=e,R+=1),/[eE]/.test(e)?(M.push(e),n=e,R+1):"-"===e&&/[eE]/.test(n)?(M.push(e),n=e,R+1):/[^\d]/.test(e)?(D(M.join("")),I=u,R):(M.push(e),n=e,R+1)}function Q(){if(/[^\d\w_]/.test(e)){var t=M.join("");return I=C.indexOf(t)>-1?v:U.indexOf(t)>-1?g:E,D(M.join("")),I=u,R}return M.push(e),n=e,R+1}};var r=n(71),i=n(217),o=n(72),a=n(218),s=n(219),u=999,c=9999,f=0,l=1,h=2,d=3,_=4,p=5,E=6,g=7,v=8,A=9,T=10,y=11,m=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},function(t,e){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},function(t,e,n){var r=n(71);t.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},function(t,e,n){var r=n(72);r=r.slice().filter(function(t){return!/^(gl\_|texture)/.test(t)}),t.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},function(t,e){t.exports=function(t){return atob(t)}},function(t,e,n){var r=n(222);t.exports=function(t,e,n){e="number"===typeof e?e:1,n=n||": ";var i=t.split(/\r?\n/),o=String(i.length+e-1).length;return i.map(function(t,i){var a=i+e,s=String(a).length,u=r(a,o-s);return u+n+t}).join("\n")}},function(t,e,n){"use strict";var r=n(223);t.exports=function(t,e,n){return r(n="undefined"!==typeof n?n+"":" ",e)+t}},function(t,e,n){"use strict";var r,i="";t.exports=function(t,e){if("string"!==typeof t)throw new TypeError("expected a string");if(1===e)return t;if(2===e)return t+t;var n=t.length*e;if(r!==t||"undefined"===typeof r)r=t,i="";else if(i.length>=n)return i.substr(0,n);for(;n>i.length&&e>1;)1&e&&(i+=t),e>>=1,t+=t;return i=(i+=t).substr(0,n)}},function(t,e,n){"use strict";e.a=function(t){var e=new r.a(4);return e.add({POSITION:[1,1,0],NORMAL:[0,0,1],TEXCOORD_0:[1,1]}),e.add({POSITION:[-1,1,0],NORMAL:[0,0,1],TEXCOORD_0:[1,0]}),e.add({POSITION:[-1,-1,0],NORMAL:[0,0,1],TEXCOORD_0:[0,0]}),e.add({POSITION:[1,-1,0],NORMAL:[0,0,1],TEXCOORD_0:[0,1]}),e.build(t,[0,1,2,0,2,3])};var r=n(7)},function(t,e,n){"use strict";e.a=function(t){for(var e=new r.a(24),n=[[1,-1,-1],[1,1,-1],[1,1,1],[1,-1,1],[1,1,-1],[-1,1,-1],[-1,1,1],[1,1,1],[-1,1,-1],[-1,-1,-1],[-1,-1,1],[-1,1,1],[-1,-1,-1],[1,-1,-1],[1,-1,1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1],[-1,-1,1],[-1,-1,-1],[-1,1,-1],[1,1,-1],[1,-1,-1]],i=[[1,0,0],[0,1,0],[-1,0,0],[0,-1,0],[0,0,1],[0,0,-1]],o=[[0,1],[1,1],[1,0],[0,0]],a=0;a<24;++a)e.add({POSITION:n[a],NORMAL:i[Math.floor(a/4)],TEXCOORD_0:o[a%4]});for(var s=[],u=0;u<24;u+=4)s.push(u,u+1,u+2,u,u+2,u+3);return e.build(t,s)};var r=n(7)},function(t,e,n){"use strict";e.a=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=n,o=4*n,a=o+1,s=2*(i+1)*(o+1),u=function(t,e){return e*a+t},c=function(t,e){return a*(i+1+e)+t},f=new r.a(s),l=function(t,e,n,r){var i=Math.cos(e),o=Math.cos(n)*i,a=Math.sin(n)*i,s=Math.sin(e);f.set(t,{POSITION:[o,a,s+r],NORMAL:[o,a,s],TEXCOORD_0:[Math.round(512*n/Math.PI),Math.round(512*(.5-e/Math.PI+r))]})},h=0;h<=i;++h)for(var d=0;d<=o;++d){var _=h*Math.PI/2/i,p=d*Math.PI*2/o;l(u(d,h),-_,p,0),l(c(d,h),_,p,e)}for(var E=[],g=function(t,e,n,r){return E.push(t,e,n,t,n,r)},v=0;v<i;++v)for(var A=0;A<o;++A)g(u(A,v+1),u(A+1,v+1),u(A+1,v),u(A,v)),g(c(A,v),c(A+1,v),c(A+1,v+1),c(A,v+1));if(e)for(var T=0;T<o;++T)g(u(T,0),u(T+1,0),c(T+1,0),c(T,0));return f.build(t,E)};var r=n(7)},function(t,e,n){"use strict";e.a=_;var r,i=n(2);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var s=Symbol("gl");function u(t){return{get:function(){return this[s].isEnabled(t)},set:function(e){e?this[s].enable(t):this[s].disable(t)}}}function c(t,e){return{get:function(){return this[s].getParameter(t)},set:function(t){this[s][e](t)}}}function f(t,e){return{get:function(){return this[s].getParameter(t)},set:function(t){var n;(n=this[s])[e].apply(n,a(t))}}}function l(t,e){return{get:function(){var e=this;return t.map(function(t){return e[s].getParameter(t)})},set:function(t){var n;(n=this[s])[e].apply(n,a(t))}}}function h(t){return{get:function(){return this[s].getParameter(t)},set:function(e){this[s].pixelStorei(t,e)}}}var d=(o(r={blend:u(i.BLEND),blendColor:f(i.BLEND_COLOR,"blendColor"),blendEquation:function(t,e,n){return{get:function(){var e=this;return t.map(function(t){return e[s].getParameter(t)})},set:function(t){var r;Array.isArray(t)?(r=this[s])[n].apply(r,a(t)):this[s][e](t)}}}([i.BLEND_EQUATION_RGB,i.BLEND_EQUATION_ALPHA],"blendEquation","blendEquationSeparate"),blendFunc:{get:function(){return[this[s].getParameter(i.BLEND_SRC_RGB),this[s].getParameter(i.BLEND_SRC_ALPHA),this[s].getParameter(i.BLEND_DST_RGB),this[s].getParameter(i.BLEND_DST_ALPHA)]},set:function(t){var e;2===t.length?this[s].blendFunc(t[0],t[1]):(e=this[s]).blendFuncSeparate.apply(e,a(t))}},clearColor:f(i.COLOR_CLEAR_VALUE,"clearColor"),colorMask:f(i.COLOR_WRITEMASK,"colorMask"),cull:u(i.CULL_FACE),cullFace:c(i.CULL_FACE_MODE,"cullFace"),clearDepth:c(i.DEPTH_CLEAR_VALUE,"clearDepth"),depthFunc:c(i.DEPTH_FUNC,"depthFunc"),depthRange:f(i.DEPTH_RANGE,"depthRange"),depthMask:c(i.DEPTH_WRITEMASK,"depthMask"),depthTest:u(i.DEPTH_TEST),dither:u(i.DITHER),frontFace:c(i.FRONT_FACE,"frontFace"),mipmapHint:{get:function(){return this[s].getParameter(i.GENERATE_MIPMAP_HINT)},set:function(t){this[s].hint(i.GENERATE_MIPMAP_HINT,t)}},lineWidth:c(i.LINE_WIDTH,"lineWidth"),packAlignment:h(i.PACK_ALIGNMENT),polygonOffset:l([i.POLYGON_OFFSET_FACTOR,i.POLYGON_OFFSET_UNITS],"polygonOffset"),polygonOffsetFill:u(i.POLYGON_OFFSET_FILL),sampleCoverage:l([i.SAMPLE_COVERAGE_VALUE,i.SAMPLE_COVERAGE_INVERT],"sampleCoverage"),scissorBox:f(i.SCISSOR_BOX,"scissor"),scissorTest:u(i.SCISSOR_TEST),clearStencil:c(i.STENCIL_CLEAR_VALUE,"clearStencil"),stencilTest:u(i.STENCIL_TEST),stencilFunc:l([i.STENCIL_FUNC,i.STENCIL_REF,i.STENCIL_VALUE_MASK],"stencilFunc"),stencilFrontFunc:o({get:function(){return[this[s].getParameter(i.STENCIL_FUNC),this[s].getParameter(i.STENCIL_REF),this[s].getParameter(i.STENCIL_VALUE_MASK)]}},"get",function(t){var e;(e=this[s]).stencilFuncSeparate.apply(e,[i.FRONT].concat(a(t)))}),stencilBackFunc:o({get:function(){return[this[s].getParameter(i.STENCIL_BACK_FUNC),this[s].getParameter(i.STENCIL_BACK_REF),this[s].getParameter(i.STENCIL_BACK_VALUE_MASK)]}},"get",function(t){var e;(e=this[s]).stencilFuncSeparate.apply(e,[i.BACK].concat(a(t)))}),stencilMask:c(i.STENCIL_WRITEMASK,"stencilMask"),stencilFrontMask:{get:function(){return this[s].getParameter(i.STENCIL_WRITEMASK)},set:function(t){this[s].stencilMaskSeparate(i.FRONT,t)}},stencilBackMask:{get:function(){return this[s].getParameter(i.STENCIL_BACK_WRITEMASK)},set:function(t){this[s].stencilMaskSeparate(i.BACK,t)}},stencilOp:l([i.STENCIL_FAIL,i.STENCIL_PASS_DEPTH_FAIL,i.STENCIL_PASS_DEPTH_PASS],"stencilOp"),stencilFrontOp:o({get:function(){return[this[s].getParameter(i.STENCIL_FAIL),this[s].getParameter(i.STENCIL_PASS_DEPTH_FAIL),this[s].getParameter(i.STENCIL_PASS_DEPTH_PASS)]}},"get",function(t){var e;(e=this[s]).stencilOpSeparate.apply(e,[i.FRONT].concat(a(t)))}),stencilBackOp:o({get:function(){return[this[s].getParameter(i.STENCIL_BACK_FAIL),this[s].getParameter(i.STENCIL_BACK_PASS_DEPTH_FAIL),this[s].getParameter(i.STENCIL_BACK_PASS_DEPTH_PASS)]}},"get",function(t){var e;(e=this[s]).stencilOpSeparate.apply(e,[i.BACK].concat(a(t)))}),unpackAlignment:h(i.UNPACK_ALIGNMENT),unpackColorspaceConversion:h(i.UNPACK_COLORSPACE_CONVERSION_WEBGL),unpackFlipY:h(i.UNPACK_FLIP_Y_WEBGL),unpackPremultiplyAlpha:h(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL),viewport:f(i.VIEWPORT,"viewport"),fragmentShaderDerivativeHint:{get:function(){return this[s].getParameter(i.FRAGMENT_SHADER_DERIVATIVE_HINT)},set:function(t){this[s].hint(i.FRAGMENT_SHADER_DERIVATIVE_HINT,t)}},packRowLength:h(i.PACK_ROW_LENGTH),packSkipPixels:h(i.PACK_SKIP_PIXELS),packSkipRows:h(i.PACK_SKIP_ROWS),unpackRowLength:h(i.PACK_ROW_LENGTH)},"packRowLength",h(i.UNPACK_ROW_LENGTH)),o(r,"unpackImageHeight",h(i.UNPACK_IMAGE_HEIGHT)),o(r,"unpackSkipPixels",h(i.UNPACK_SKIP_PIXELS)),o(r,"unpackSkipRows",h(i.UNPACK_SKIP_ROWS)),o(r,"unpackSkipImages",h(i.UNPACK_SKIP_IMAGES)),o(r,"rasterizerDiscard",u(i.RASTERIZER_DISCARD)),o(r,"sampleCoverageEnable",u(i.SAMPLE_COVERAGE)),o(r,"sampleAlphaToCoverage",u(i.SAMPLE_ALPHA_TO_COVERAGE)),r);function _(t){this[s]=t,Object.preventExtensions(this)}Object.defineProperties(_.prototype,d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(229);n.d(e,"Local",function(){return r.a});var i=n(230);n.d(e,"Global",function(){return i.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r,i,o=n(3),a=n.n(o),s=n(73),u=(r=["\n      precision PRECISION ",";\n      uniform "," u_Source;\n      layout(location=0) out "," o_Color;\n      #define get(x,y) textureOffset(u_Source,v_Position,ivec2(x,y))\n      "," func() {\n        ",";\n      }\n    "],i=["\n      precision PRECISION ",";\n      uniform "," u_Source;\n      layout(location=0) out "," o_Color;\n      #define get(x,y) textureOffset(u_Source,v_Position,ivec2(x,y))\n      "," func() {\n        ",";\n      }\n    "],Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(i)}})));var c=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vec4",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sampler2D";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a()(u,i,i,r,r,n)))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r,i,o=n(3),a=n.n(o),s=n(73),u=(r=["\n      precision PRECISION ",";\n      uniform "," u_Source;\n      layout(location=0) out "," o_Color;\n      #define get(x,y) texelFetch(u_Source,ivec2(x,y),0)\n      "," func() {\n        int x = int(gl_FragCoord.x);\n        int y = int(gl_FragCoord.y);\n        ",";\n      }\n    "],i=["\n      precision PRECISION ",";\n      uniform "," u_Source;\n      layout(location=0) out "," o_Color;\n      #define get(x,y) texelFetch(u_Source,ivec2(x,y),0)\n      "," func() {\n        int x = int(gl_FragCoord.x);\n        int y = int(gl_FragCoord.y);\n        ",";\n      }\n    "],Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(i)}})));var c=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vec4",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sampler2D";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a()(u,i,i,r,r,n)))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),e}()},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(232),i=n.n(r),o=n(233),a=n.n(o),s=n(234),u=n.n(s),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var f="\n  layout(location=0) in vec2 a_Position;\n  void main() {\n    gl_Position = vec4(a_Position, 0.0, 1.0);\n  }\n",l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,this.quad=e.quad,this.plainFilter=new e.Filters.Local("return get(0, 0)"),this.setQuality(n)}return c(t,[{key:"setQuality",value:function(t){t!==this.quality&&(this.shader&&(this.shader.destroy(),delete this.shader),this.quality=t,0!==t&&(this.shader=t<=8?new this.renderer.Shader(f,i.a):9===t?new this.renderer.Shader(f,a.a):new this.renderer.Shader(f,u.a,{defines:{FXAA_QUALITY_PRESET:t}})))}},{key:"apply",value:function(t){this.shader?(this.shader.sampler("u_Texture",t),this.shader.render(this.quad)):this.plainFilter.apply(t)}}]),t}()},function(t,e){t.exports="#define SHADER_NAME_B64 c2hhZGVyLmZyYWc=\nuniform sampler2D u_Texture;\r\n\r\nlayout(location=0) out vec4 o_Color;\r\n\r\nvoid main() {\r\n  vec2 rcpFrame = 1.0 / vec2(textureSize(u_Texture, 0));\r\n  vec2 coord = gl_FragCoord.xy * rcpFrame;\r\n\r\n  vec3 luma = vec3(0.299, 0.587, 0.114);\r\n\r\n  vec3 rgbNW = texture(u_Texture, coord - rcpFrame).xyz;\r\n  vec3 rgbNE = texture(u_Texture, coord + vec2(rcpFrame.x, -rcpFrame.y)).xyz;\r\n  vec3 rgbSW = texture(u_Texture, coord + vec2(-rcpFrame.x, rcpFrame.y)).xyz;\r\n  vec3 rgbSE = texture(u_Texture, coord + rcpFrame).xyz;\r\n  vec4 texColor = texture(u_Texture, coord);\r\n  vec3 rgbM = texColor.xyz;\r\n\r\n  float lumaNW = dot(rgbNW, luma);\r\n  float lumaNE = dot(rgbNE, luma);\r\n  float lumaSW = dot(rgbSW, luma);\r\n  float lumaSE = dot(rgbSE, luma);\r\n  float lumaM = dot(rgbM, luma);\r\n  float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\r\n  float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\r\n\r\n  vec2 dir;\r\n  dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\r\n  dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));\r\n\r\n  float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) / 32.0, 1.0 / 128.0);\r\n  float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\r\n  dir = clamp(dir * rcpDirMin, vec2(-8.0, -8.0), vec2(8.0, 8.0)) * rcpFrame;\r\n\r\n  vec3 rgbA = 0.5 * (texture(u_Texture, coord + dir * (1.0 / 3.0 - 0.5)) + texture(u_Texture, coord + dir * (2.0 / 3.0 - 0.5))).xyz;\r\n  vec3 rgbB = rgbA * 0.5 + 0.25 * (texture(u_Texture, coord - dir * 0.5) + texture(u_Texture, coord + dir * 0.5)).xyz;\r\n\r\n  float lumaB = dot(rgbB, luma);\r\n  if (lumaB < lumaMin || lumaB > lumaMax) {\r\n    o_Color = vec4(rgbA, texColor.a);\r\n  } else {\r\n    o_Color = vec4(rgbB, texColor.a);\r\n  }\r\n}\r\n"},function(t,e){t.exports="#define SHADER_NAME_B64 c2hhZGVyMi5mcmFn\nuniform sampler2D u_Texture;\r\n\r\nlayout(location=0) out vec4 o_Color;\r\n\r\nfloat rgb2luma(vec3 rgb) {\r\n  return sqrt(dot(rgb, vec3(0.299, 0.587, 0.144)));\r\n}\r\n\r\n#define EDGE_THRESHOLD_MIN 0.0312\r\n#define EDGE_THRESHOLD_MAX 0.125\r\n#define ITERATIONS 12\r\nfloat QUALITY(int i) {\r\n  if (i < 5) {\r\n    return 1.0;\r\n  } else if (i == 5) {\r\n    return 1.5;\r\n  } else if (i < 10) {\r\n    return 2.0;\r\n  } else if (i == 10) {\r\n    return 4.0;\r\n  } else {\r\n    return 8.0;\r\n  }\r\n}\r\n#define SUBPIXEL_QUALITY 0.75\r\n\r\nvoid main() {\r\n  vec2 rcpFrame = 1.0 / vec2(textureSize(u_Texture, 0));\r\n  vec2 coord = gl_FragCoord.xy * rcpFrame;\r\n\r\n  vec4 texColor = texture(u_Texture, coord);\r\n  float lumaM = rgb2luma(texColor.xyz);\r\n\r\n  float lumaN = rgb2luma(texture(u_Texture, coord + vec2(0, -rcpFrame.y)).xyz);\r\n  float lumaW = rgb2luma(texture(u_Texture, coord + vec2(-rcpFrame.x, 0)).xyz);\r\n  float lumaE = rgb2luma(texture(u_Texture, coord + vec2(rcpFrame.y, 0)).xyz);\r\n  float lumaS = rgb2luma(texture(u_Texture, coord + vec2(0, rcpFrame.y)).xyz);\r\n\r\n  float lumaMin = min(lumaM, min(min(lumaN, lumaS), min(lumaW, lumaE)));\r\n  float lumaMax = max(lumaM, max(max(lumaN, lumaS), max(lumaW, lumaE)));\r\n\r\n  float lumaRange = lumaMax - lumaMin;\r\n  if (lumaRange < max(EDGE_THRESHOLD_MIN, lumaMax * EDGE_THRESHOLD_MAX)) {\r\n    fragColor = texColor;\r\n    return;\r\n  }\r\n\r\n  float lumaNW = rgb2luma(texture(u_Texture, coord - rcpFrame).xyz);\r\n  float lumaNE = rgb2luma(texture(u_Texture, coord + vec2(rcpFrame.x, -rcpFrame.y)).xyz);\r\n  float lumaSW = rgb2luma(texture(u_Texture, coord + vec2(-rcpFrame.x, rcpFrame.y)).xyz);\r\n  float lumaSE = rgb2luma(texture(u_Texture, coord - rcpFrame).xyz);\r\n\r\n  float lumaNS = lumaN + lumaS;\r\n  float lumaWE = lumaE + lumaW;\r\n\r\n  float lumaNc = lumaNW + lumaNE;\r\n  float lumaWc = lumaNW + lumaSW;\r\n  float lumaEc = lumaNE + lumaSE;\r\n  float lumaSc = lumaSW + lumaSE;\r\n\r\n  float edgeNS = abs(-2.0 * lumaN + lumaNc) + abs(-2.0 * lumaM + lumaWE) + abs(-2.0 * lumaS + lumaSc);\r\n  float edgeWE = abs(-2.0 * lumaW + lumaWc) + abs(-2.0 * lumaM + lumaNS) + abs(-2.0 * lumaE + lumaEc);\r\n\r\n  bool horizontal = edgeWE >= edgeNS;\r\n\r\n  float luma1 = horizontal ? lumaN : lumaW;\r\n  float luma2 = horizontal ? lumaS : lumaE;\r\n\r\n  float grad1 = luma1 - lumaM;\r\n  float grad2 = luma2 - lumaM;\r\n\r\n  bool steep1 = abs(grad1) >= abs(grad2);\r\n\r\n  float gradScaled = 0.25 * max(abs(grad1), abs(grad2));\r\n\r\n  float stepLength = horizontal ? rcpFrame.y : rcpFrame.x;\r\n\r\n  float lumaLocalAverage = 0.0;\r\n\r\n  if (steep1) {\r\n    stepLength = -stepLength;\r\n    lumaLocalAverage = 0.5 * (luma1 + lumaM);\r\n  } else {\r\n    lumaLocalAverage = 0.5 * (luma2 + lumaM);\r\n  }\r\n\r\n  vec2 pos = coord;\r\n  if (horizontal) {\r\n    pos.y += stepLength * 0.5;\r\n  } else {\r\n    pos.x += stepLength * 0.5;\r\n  }\r\n\r\n  vec2 offset = horizontal ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\r\n  vec2 pos1 = pos - offset;\r\n  vec2 pos2 = pos + offset;\r\n\r\n  float lumaEnd1 = rgb2luma(texture(u_Texture, pos1).xyz);\r\n  float lumaEnd2 = rgb2luma(texture(u_Texture, pos2).xyz);\r\n  lumaEnd1 -= lumaLocalAverage;\r\n  lumaEnd2 -= lumaLocalAverage;\r\n\r\n  bool reached1 = abs(lumaEnd1) >= gradScaled;\r\n  bool reached2 = abs(lumaEnd2) >= gradScaled;\r\n  bool reachedBoth = reached1 && reached2;\r\n\r\n  if (!reached1) {\r\n    pos1 -= offset;\r\n  }\r\n  if (!reached2) {\r\n    pos2 += offset;\r\n  }\r\n\r\n  if (!reachedBoth) {\r\n    for (int i = 2; i < ITERATIONS; i++) {\r\n      if (!reached1) {\r\n        lumaEnd1 = rgb2luma(texture(u_Texture, pos1).xyz);\r\n        lumaEnd1 -= lumaLocalAverage;\r\n      }\r\n      if (!reached2) {\r\n        lumaEnd2 = rgb2luma(texture(u_Texture, pos2).xyz);\r\n        lumaEnd2 -= lumaLocalAverage;\r\n      }\r\n\r\n      reached1 = abs(lumaEnd1) >= gradScaled;\r\n      reached2 = abs(lumaEnd2) >= gradScaled;\r\n      reachedBoth = reached1 && reached2;\r\n\r\n      if (!reached1) {\r\n        pos1 -= offset * QUALITY(i);\r\n      }\r\n      if (!reached2) {\r\n        pos2 += offset * QUALITY(i);\r\n      }\r\n\r\n      if (reachedBoth) {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  float dist1 = horizontal ? coord.x - pos1.x : coord.y - pos1.y;\r\n  float dist2 = horizontal ? pos2.x - coord.x : pos2.y - coord.y;\r\n\r\n  bool isDirection1 = dist1 < dist2;\r\n  float distFinal = min(dist1, dist2);\r\n\r\n  float thickness = dist1 + dist2;\r\n  float pixelOffset = -distFinal / thickness + 0.5;\r\n\r\n  bool centerSmaller = lumaM < lumaLocalAverage;\r\n  bool correctVariation = ((isDirection1 ? lumaEnd1 : lumaEnd2) < 0.0) != centerSmaller;\r\n  float finalOffset = correctVariation ? pixelOffset : 0.0;\r\n\r\n  float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaNS + lumaWE) + lumaWc + lumaEc);\r\n  float subOffset1 = clamp(abs(lumaAverage - lumaM) / lumaRange, 0.0, 1.0);\r\n  float subOffset2 = (-2.0 * subOffset1 + 3.0) * subOffset1 * subOffset1;\r\n  float subOffsetFinal = subOffset2 * subOffset2 * SUBPIXEL_QUALITY;\r\n\r\n  finalOffset = max(finalOffset, subOffsetFinal);\r\n\r\n  vec2 finalPos = coord;\r\n  if (horizontal) {\r\n    finalPos.y += finalOffset * stepLength;\r\n  } else {\r\n    finalPos.x += finalOffset * stepLength;\r\n  }\r\n\r\n  vec3 finalColor = texture(u_Texture, finalPos).xyz;\r\n  o_Color = vec4(finalColor, texColor.w);\r\n}\r\n"},function(t,e){t.exports="#define SHADER_NAME_B64 ZnhhYS5mcmFn\n/*============================================================================\r\n\r\n\r\n                    NVIDIA FXAA 3.11 by TIMOTHY LOTTES\r\n\r\n\r\n------------------------------------------------------------------------------\r\nCOPYRIGHT (C) 2010, 2011 NVIDIA CORPORATION. ALL RIGHTS RESERVED.\r\n------------------------------------------------------------------------------\r\nTO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THIS SOFTWARE IS PROVIDED\r\n*AS IS* AND NVIDIA AND ITS SUPPLIERS DISCLAIM ALL WARRANTIES, EITHER EXPRESS\r\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, IMPLIED WARRANTIES OF\r\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL NVIDIA\r\nOR ITS SUPPLIERS BE LIABLE FOR ANY SPECIAL, INCIDENTAL, INDIRECT, OR\r\nCONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION, DAMAGES FOR\r\nLOSS OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION,\r\nOR ANY OTHER PECUNIARY LOSS) ARISING OUT OF THE USE OF OR INABILITY TO USE\r\nTHIS SOFTWARE, EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH\r\nDAMAGES.\r\n\r\n============================================================================*/\r\n\r\n    // Choose the amount of sub-pixel aliasing removal.\r\n    // This can effect sharpness.\r\n    //   1.00 - upper limit (softer)\r\n    //   0.75 - default amount of filtering\r\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\r\n    //   0.25 - almost off\r\n    //   0.00 - completely off\r\n#define FXAA_QUALITY_SUBPIX 0.75\r\n    // The minimum amount of local contrast required to apply algorithm.\r\n    //   0.333 - too little (faster)\r\n    //   0.250 - low quality\r\n    //   0.166 - default\r\n    //   0.125 - high quality \r\n    //   0.063 - overkill (slower)\r\n#define FXAA_QUALITY_EDGE_THRESHOLD 0.166\r\n    // Trims the algorithm from processing darks.\r\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\r\n    //   0.0625 - high quality (faster)\r\n    //   0.0312 - visible limit (slower)\r\n#define FXAA_QUALITY_EDGE_THRESHOLD_MIN 0.0833\r\n\r\n/*============================================================================\r\n\r\n                           FXAA QUALITY - PRESETS\r\n\r\n============================================================================*/\r\n\r\n/*============================================================================\r\n                     FXAA QUALITY - MEDIUM DITHER PRESETS\r\n============================================================================*/\r\n#if FXAA_QUALITY_PRESET <= 10\r\n  #define FXAA_QUALITY_PS 3\r\n  #define FXAA_QUALITY_P0 1.5\r\n  #define FXAA_QUALITY_P1 3.0\r\n  #define FXAA_QUALITY_P2 12.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 11\r\n  #define FXAA_QUALITY_PS 4\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 3.0\r\n  #define FXAA_QUALITY_P3 12.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 12\r\n  #define FXAA_QUALITY_PS 5\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 4.0\r\n  #define FXAA_QUALITY_P4 12.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 13\r\n  #define FXAA_QUALITY_PS 6\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 4.0\r\n  #define FXAA_QUALITY_P5 12.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 14\r\n  #define FXAA_QUALITY_PS 7\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 4.0\r\n  #define FXAA_QUALITY_P6 12.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET >= 15 && FXAA_QUALITY_PRESET <= 19\r\n  #define FXAA_QUALITY_PS 8\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 2.0\r\n  #define FXAA_QUALITY_P6 4.0\r\n  #define FXAA_QUALITY_P7 12.0\r\n#endif\r\n\r\n/*============================================================================\r\n                     FXAA QUALITY - LOW DITHER PRESETS\r\n============================================================================*/\r\n#if FXAA_QUALITY_PRESET == 20\r\n  #define FXAA_QUALITY_PS 3\r\n  #define FXAA_QUALITY_P0 1.5\r\n  #define FXAA_QUALITY_P1 2.0\r\n  #define FXAA_QUALITY_P2 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 21\r\n  #define FXAA_QUALITY_PS 4\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 22\r\n  #define FXAA_QUALITY_PS 5\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 23\r\n  #define FXAA_QUALITY_PS 6\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 24\r\n  #define FXAA_QUALITY_PS 7\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 3.0\r\n  #define FXAA_QUALITY_P6 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 25\r\n  #define FXAA_QUALITY_PS 8\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 2.0\r\n  #define FXAA_QUALITY_P6 4.0\r\n  #define FXAA_QUALITY_P7 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 26\r\n  #define FXAA_QUALITY_PS 9\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 2.0\r\n  #define FXAA_QUALITY_P6 2.0\r\n  #define FXAA_QUALITY_P7 4.0\r\n  #define FXAA_QUALITY_P8 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 27\r\n  #define FXAA_QUALITY_PS 10\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 2.0\r\n  #define FXAA_QUALITY_P6 2.0\r\n  #define FXAA_QUALITY_P7 2.0\r\n  #define FXAA_QUALITY_P8 4.0\r\n  #define FXAA_QUALITY_P9 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 28\r\n  #define FXAA_QUALITY_PS 11\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 2.0\r\n  #define FXAA_QUALITY_P6 2.0\r\n  #define FXAA_QUALITY_P7 2.0\r\n  #define FXAA_QUALITY_P8 2.0\r\n  #define FXAA_QUALITY_P9 4.0\r\n  #define FXAA_QUALITY_P10 8.0\r\n#endif\r\n#if FXAA_QUALITY_PRESET == 29\r\n  #define FXAA_QUALITY_PS 12\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.5\r\n  #define FXAA_QUALITY_P2 2.0\r\n  #define FXAA_QUALITY_P3 2.0\r\n  #define FXAA_QUALITY_P4 2.0\r\n  #define FXAA_QUALITY_P5 2.0\r\n  #define FXAA_QUALITY_P6 2.0\r\n  #define FXAA_QUALITY_P7 2.0\r\n  #define FXAA_QUALITY_P8 2.0\r\n  #define FXAA_QUALITY_P9 2.0\r\n  #define FXAA_QUALITY_P10 4.0\r\n  #define FXAA_QUALITY_P11 8.0\r\n#endif\r\n\r\n/*============================================================================\r\n                     FXAA QUALITY - EXTREME QUALITY\r\n============================================================================*/\r\n#if FXAA_QUALITY_PRESET >= 30\r\n  #define FXAA_QUALITY_PS 12\r\n  #define FXAA_QUALITY_P0 1.0\r\n  #define FXAA_QUALITY_P1 1.0\r\n  #define FXAA_QUALITY_P2 1.0\r\n  #define FXAA_QUALITY_P3 1.0\r\n  #define FXAA_QUALITY_P4 1.0\r\n  #define FXAA_QUALITY_P5 1.5\r\n  #define FXAA_QUALITY_P6 2.0\r\n  #define FXAA_QUALITY_P7 2.0\r\n  #define FXAA_QUALITY_P8 2.0\r\n  #define FXAA_QUALITY_P9 2.0\r\n  #define FXAA_QUALITY_P10 4.0\r\n  #define FXAA_QUALITY_P11 8.0\r\n#endif\r\n\r\nfloat FxaaLuma(vec4 rgba) {\r\n  return sqrt(dot(rgba.xyz, vec3(0.299, 0.587, 0.144)));\r\n}\r\n\r\nvec4 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\r\n  vec2 posM;\r\n  posM.x = pos.x;\r\n  posM.y = pos.y;\r\n  vec4 rgbyM = textureLod(tex, posM, 0.0);\r\n  float lumaM = FxaaLuma(rgbyM);\r\n  float lumaS = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2( 0, 1)));\r\n  float lumaE = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2( 1, 0)));\r\n  float lumaN = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2( 0,-1)));\r\n  float lumaW = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2(-1, 0)));\r\n\r\n  float maxSM = max(lumaS, lumaM);\r\n  float minSM = min(lumaS, lumaM);\r\n  float maxESM = max(lumaE, maxSM);\r\n  float minESM = min(lumaE, minSM);\r\n  float maxWN = max(lumaN, lumaW);\r\n  float minWN = min(lumaN, lumaW);\r\n  float rangeMax = max(maxWN, maxESM);\r\n  float rangeMin = min(minWN, minESM);\r\n  float rangeMaxScaled = rangeMax * FXAA_QUALITY_EDGE_THRESHOLD;\r\n  float range = rangeMax - rangeMin;\r\n  float rangeMaxClamped = max(FXAA_QUALITY_EDGE_THRESHOLD_MIN, rangeMaxScaled);\r\n\r\n  if (range < rangeMaxClamped) {\r\n    return rgbyM;\r\n  }\r\n\r\n  float lumaNW = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2(-1,-1)));\r\n  float lumaSE = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2( 1, 1)));\r\n  float lumaNE = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2( 1,-1)));\r\n  float lumaSW = FxaaLuma(textureLodOffset(tex, posM, 0.0, ivec2(-1, 1)));\r\n\r\n  float lumaNS = lumaN + lumaS;\r\n  float lumaWE = lumaW + lumaE;\r\n  float subpixRcpRange = 1.0/range;\r\n  float subpixNSWE = lumaNS + lumaWE;\r\n  float edgeHorz1 = (-2.0 * lumaM) + lumaNS;\r\n  float edgeVert1 = (-2.0 * lumaM) + lumaWE;\r\n\r\n  float lumaNESE = lumaNE + lumaSE;\r\n  float lumaNWNE = lumaNW + lumaNE;\r\n  float edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\r\n  float edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\r\n\r\n  float lumaNWSW = lumaNW + lumaSW;\r\n  float lumaSWSE = lumaSW + lumaSE;\r\n  float edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\r\n  float edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\r\n  float edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\r\n  float edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\r\n  float edgeHorz = abs(edgeHorz3) + edgeHorz4;\r\n  float edgeVert = abs(edgeVert3) + edgeVert4;\r\n\r\n  float subpixNWSWNESE = lumaNWSW + lumaNESE;\r\n  float lengthSign = rcpFrame.x;\r\n  bool horzSpan = edgeHorz >= edgeVert;\r\n  float subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\r\n\r\n  if (!horzSpan) lumaN = lumaW;\r\n  if (!horzSpan) lumaS = lumaE;\r\n  if (horzSpan) lengthSign = rcpFrame.y;\r\n  float subpixB = (subpixA * (1.0/12.0)) - lumaM;\r\n\r\n  float gradientN = lumaN - lumaM;\r\n  float gradientS = lumaS - lumaM;\r\n  float lumaNN = lumaN + lumaM;\r\n  float lumaSS = lumaS + lumaM;\r\n  bool pairN = abs(gradientN) >= abs(gradientS);\r\n  float gradient = max(abs(gradientN), abs(gradientS));\r\n  if (pairN) lengthSign = -lengthSign;\r\n  float subpixC = clamp(abs(subpixB) * subpixRcpRange, 0.0, 1.0);\r\n\r\n  vec2 posB;\r\n  posB.x = posM.x;\r\n  posB.y = posM.y;\r\n  vec2 offNP;\r\n  offNP.x = (!horzSpan) ? 0.0 : rcpFrame.x;\r\n  offNP.y = ( horzSpan) ? 0.0 : rcpFrame.y;\r\n  if (!horzSpan) posB.x += lengthSign * 0.5;\r\n  if ( horzSpan) posB.y += lengthSign * 0.5;\r\n\r\n  vec2 posN;\r\n  posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\r\n  posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\r\n  vec2 posP;\r\n  posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\r\n  posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\r\n  float subpixD = ((-2.0)*subpixC) + 3.0;\r\n  float lumaEndN = FxaaLuma(textureLod(tex, posN, 0.0));\r\n  float subpixE = subpixC * subpixC;\r\n  float lumaEndP = FxaaLuma(textureLod(tex, posP, 0.0));\r\n\r\n  if (!pairN) lumaNN = lumaSS;\r\n  float gradientScaled = gradient * 1.0/4.0;\r\n  float lumaMM = lumaM - lumaNN * 0.5;\r\n  float subpixF = subpixD * subpixE;\r\n  bool lumaMLTZero = lumaMM < 0.0;\r\n\r\n  lumaEndN -= lumaNN * 0.5;\r\n  lumaEndP -= lumaNN * 0.5;\r\n  bool doneN = abs(lumaEndN) >= gradientScaled;\r\n  bool doneP = abs(lumaEndP) >= gradientScaled;\r\n  if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\r\n  if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\r\n  bool doneNP = (!doneN) || (!doneP);\r\n  if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\r\n  if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\r\n\r\n  if (doneNP) {\r\n    if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n    if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n    if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n    if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n    doneN = abs(lumaEndN) >= gradientScaled;\r\n    doneP = abs(lumaEndP) >= gradientScaled;\r\n    if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\r\n    if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\r\n    doneNP = (!doneN) || (!doneP);\r\n    if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\r\n    if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\r\n\r\n    #if FXAA_QUALITY_PS > 3\r\n    if (doneNP) {\r\n      if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n      if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n      if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n      if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n      doneN = abs(lumaEndN) >= gradientScaled;\r\n      doneP = abs(lumaEndP) >= gradientScaled;\r\n      if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\r\n      if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\r\n      doneNP = (!doneN) || (!doneP);\r\n      if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\r\n      if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\r\n\r\n      #if FXAA_QUALITY_PS > 4\r\n      if (doneNP) {\r\n        if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n        if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n        if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n        if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n        doneN = abs(lumaEndN) >= gradientScaled;\r\n        doneP = abs(lumaEndP) >= gradientScaled;\r\n        if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\r\n        if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\r\n        doneNP = (!doneN) || (!doneP);\r\n        if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\r\n        if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\r\n\r\n        #if FXAA_QUALITY_PS > 5\r\n        if (doneNP) {\r\n          if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n          if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n          if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n          if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n          doneN = abs(lumaEndN) >= gradientScaled;\r\n          doneP = abs(lumaEndP) >= gradientScaled;\r\n          if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\r\n          if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\r\n          doneNP = (!doneN) || (!doneP);\r\n          if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\r\n          if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\r\n\r\n          #if FXAA_QUALITY_PS > 6\r\n          if (doneNP) {\r\n            if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n            if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n            if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n            if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n            doneN = abs(lumaEndN) >= gradientScaled;\r\n            doneP = abs(lumaEndP) >= gradientScaled;\r\n            if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\r\n            if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\r\n            doneNP = (!doneN) || (!doneP);\r\n            if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\r\n            if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\r\n\r\n            #if FXAA_QUALITY_PS > 7\r\n            if (doneNP) {\r\n              if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n              if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n              if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n              if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n              doneN = abs(lumaEndN) >= gradientScaled;\r\n              doneP = abs(lumaEndP) >= gradientScaled;\r\n              if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\r\n              if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\r\n              doneNP = (!doneN) || (!doneP);\r\n              if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\r\n              if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\r\n\r\n              #if FXAA_QUALITY_PS > 8\r\n              if (doneNP) {\r\n                if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n                if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n                if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n                if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n                doneN = abs(lumaEndN) >= gradientScaled;\r\n                doneP = abs(lumaEndP) >= gradientScaled;\r\n                if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\r\n                if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\r\n                doneNP = (!doneN) || (!doneP);\r\n                if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\r\n                if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\r\n\r\n                #if FXAA_QUALITY_PS > 9\r\n                if (doneNP) {\r\n                  if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n                  if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n                  if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n                  if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n                  doneN = abs(lumaEndN) >= gradientScaled;\r\n                  doneP = abs(lumaEndP) >= gradientScaled;\r\n                  if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\r\n                  if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\r\n                  doneNP = (!doneN) || (!doneP);\r\n                  if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\r\n                  if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\r\n\r\n                  #if FXAA_QUALITY_PS > 10\r\n                  if (doneNP) {\r\n                    if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n                    if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n                    if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n                    if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n                    doneN = abs(lumaEndN) >= gradientScaled;\r\n                    doneP = abs(lumaEndP) >= gradientScaled;\r\n                    if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\r\n                    if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\r\n                    doneNP = (!doneN) || (!doneP);\r\n                    if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\r\n                    if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\r\n\r\n                    #if FXAA_QUALITY_PS > 11\r\n                    if (doneNP) {\r\n                      if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n                      if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n                      if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n                      if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n                      doneN = abs(lumaEndN) >= gradientScaled;\r\n                      doneP = abs(lumaEndP) >= gradientScaled;\r\n                      if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\r\n                      if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\r\n                      doneNP = (!doneN) || (!doneP);\r\n                      if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\r\n                      if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\r\n\r\n                      #if FXAA_QUALITY_PS > 12\r\n                      if (doneNP) {\r\n                        if (!doneN) lumaEndN = FxaaLuma(textureLod(tex, posN.xy, 0.0));\r\n                        if (!doneP) lumaEndP = FxaaLuma(textureLod(tex, posP.xy, 0.0));\r\n                        if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\r\n                        if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\r\n                        doneN = abs(lumaEndN) >= gradientScaled;\r\n                        doneP = abs(lumaEndP) >= gradientScaled;\r\n                        if (!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\r\n                        if (!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\r\n                        doneNP = (!doneN) || (!doneP);\r\n                        if (!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\r\n                        if (!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\r\n                      }\r\n                      #endif\r\n                    }\r\n                    #endif\r\n                  }\r\n                  #endif\r\n                }\r\n                #endif\r\n              }\r\n              #endif\r\n            }\r\n            #endif\r\n          }\r\n          #endif\r\n        }\r\n        #endif\r\n      }\r\n      #endif\r\n    }\r\n    #endif\r\n  }\r\n\r\n  float dstN = posM.x - posN.x;\r\n  float dstP = posP.x - posM.x;\r\n  if (!horzSpan) dstN = posM.y - posN.y;\r\n  if (!horzSpan) dstP = posP.y - posM.y;\r\n\r\n  bool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\r\n  float spanLength = (dstP + dstN);\r\n  bool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\r\n  float spanLengthRcp = 1.0/spanLength;\r\n\r\n  bool directionN = dstN < dstP;\r\n  float dst = min(dstN, dstP);\r\n  bool goodSpan = directionN ? goodSpanN : goodSpanP;\r\n  float subpixG = subpixF * subpixF;\r\n  float pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\r\n  float subpixH = subpixG * FXAA_QUALITY_SUBPIX;\r\n\r\n  float pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\r\n  float pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\r\n  if (!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\r\n  if ( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\r\n\r\n  return vec4(textureLod(tex, posM, 0.0).xyz, rgbyM.w);\r\n}\r\n\r\nuniform sampler2D u_Texture;\r\n\r\nlayout(location=0) out vec4 o_Color;\r\n\r\nvoid main() {\r\n  vec2 rcpFrame = 1.0 / vec2(textureSize(u_Texture, 0));\r\n  o_Color = FxaaPixelShader(gl_FragCoord.xy * rcpFrame, u_Texture, rcpFrame);\r\n}\r\n"},function(t,e,n){"use strict";e.a=function(t){var e=new i.a(8,a);e.add({POSITION:[-1,-1,-1]}),e.add({POSITION:[1,-1,-1]}),e.add({POSITION:[-1,1,-1]}),e.add({POSITION:[1,1,-1]}),e.add({POSITION:[-1,-1,1]}),e.add({POSITION:[1,-1,1]}),e.add({POSITION:[-1,1,1]}),e.add({POSITION:[1,1,1]});return e.build(t,[0,2,3,0,3,1,0,1,5,0,5,4,0,4,6,0,6,2,1,3,7,1,7,5,2,6,7,2,7,3,4,5,7,4,7,6])};var r=n(14),i=n(7),o=n(2),a=new r.a({POSITION:o.FLOAT})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(237);n.d(e,"None",function(){return r.a});var i=n(239);n.d(e,"PCF",function(){return i.a});var o=n(240);n.d(e,"VSM",function(){return o.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r,i,o=n(3),a=n.n(o),s=n(35),u=(r=["{\n    return 1.0;\n  }"],i=["{\n    return 1.0;\n  }"],Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(i)}})));var c=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.shadowFunc=a()(u),r.resolution=1024,r.padding=4,r}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s["a"]),e}()},function(t,e){t.exports="#define SHADER_NAME_B64 Z2VvbWV0cnkudmVydA==\nlayout(location=ATTRIBUTE_POSITION) in vec3 a_Position;\r\nout vec3 v_Position;\r\n#ifdef ATTRIBUTE_POSITION_1\r\nlayout(location=ATTRIBUTE_POSITION_1) in vec3 a_Position_1;\r\n#endif\r\n#ifdef ATTRIBUTE_POSITION_2\r\nlayout(location=ATTRIBUTE_POSITION_2) in vec3 a_Position_2;\r\n#endif\r\n#ifdef ATTRIBUTE_POSITION_3\r\nlayout(location=ATTRIBUTE_POSITION_3) in vec3 a_Position_3;\r\n#endif\r\n#ifdef ATTRIBUTE_POSITION_4\r\nlayout(location=ATTRIBUTE_POSITION_4) in vec3 a_Position_4;\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_NORMAL\r\n  layout(location=ATTRIBUTE_NORMAL) in vec3 a_Normal;\r\n  #ifdef ATTRIBUTE_NORMAL_1\r\n  layout(location=ATTRIBUTE_NORMAL_1) in vec3 a_Normal_1;\r\n  #endif\r\n  #ifdef ATTRIBUTE_NORMAL_2\r\n  layout(location=ATTRIBUTE_NORMAL_2) in vec3 a_Normal_2;\r\n  #endif\r\n  #ifdef ATTRIBUTE_NORMAL_3\r\n  layout(location=ATTRIBUTE_NORMAL_3) in vec3 a_Normal_3;\r\n  #endif\r\n  #ifdef ATTRIBUTE_NORMAL_4\r\n  layout(location=ATTRIBUTE_NORMAL_4) in vec3 a_Normal_4;\r\n  #endif\r\n\r\n  #ifdef ATTRIBUTE_TANGENT\r\n    layout(location=ATTRIBUTE_TANGENT) in vec4 a_Tangent;\r\n    #ifdef ATTRIBUTE_TANGENT_1\r\n    layout(location=ATTRIBUTE_TANGENT_1) in vec3 a_Tangent_1;\r\n    #endif\r\n    #ifdef ATTRIBUTE_TANGENT_2\r\n    layout(location=ATTRIBUTE_TANGENT_2) in vec3 a_Tangent_1;\r\n    #endif\r\n    #ifdef ATTRIBUTE_TANGENT_3\r\n    layout(location=ATTRIBUTE_TANGENT_3) in vec3 a_Tangent_1;\r\n    #endif\r\n    #ifdef ATTRIBUTE_TANGENT_4\r\n    layout(location=ATTRIBUTE_TANGENT_4) in vec3 a_Tangent_1;\r\n    #endif\r\n\r\n    out mat3 v_TBN;\r\n  #else\r\n    out vec3 v_Normal;\r\n  #endif\r\n#endif\r\n\r\n#if defined ATTRIBUTE_POSITION_1 || defined ATTRIBUTE_NORMAL_1 || defined ATTRIBUTE_TANGENT_1\r\nuniform vec4 u_MorphWeights;\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_TEXCOORD_0\r\nlayout(location=ATTRIBUTE_TEXCOORD_0) in vec2 a_TexCoord_0;\r\n#endif\r\n#ifdef ATTRIBUTE_TEXCOORD_1\r\nlayout(location=ATTRIBUTE_TEXCOORD_1) in vec2 a_TexCoord_1;\r\n#endif\r\n#ifdef ATTRIBUTE_TEXCOORD_2\r\nlayout(location=ATTRIBUTE_TEXCOORD_2) in vec2 a_TexCoord_2;\r\n#endif\r\n#ifdef ATTRIBUTE_TEXCOORD_3\r\nlayout(location=ATTRIBUTE_TEXCOORD_3) in vec2 a_TexCoord_3;\r\nout vec2 v_TexCoord[4];\r\n#elif defined ATTRIBUTE_TEXCOORD_2\r\nout vec2 v_TexCoord[3];\r\n#elif defined ATTRIBUTE_TEXCOORD_1\r\nout vec2 v_TexCoord[2];\r\n#elif defined ATTRIBUTE_TEXCOORD_0\r\nout vec2 v_TexCoord[1];\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_COLOR_0\r\nlayout(location=ATTRIBUTE_COLOR_0) in vec4 a_Color_0;\r\nout vec4 v_Color;\r\n#endif\r\n#ifdef ATTRIBUTE_COLOR_1\r\nlayout(location=ATTRIBUTE_COLOR_1) in vec4 a_Color_1;\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_JOINTS_0\r\nlayout(location=ATTRIBUTE_JOINTS_0) in uvec4 a_Joints_0;\r\n#endif\r\n#ifdef ATTRIBUTE_JOINTS_1\r\nlayout(location=ATTRIBUTE_JOINTS_1) in uvec4 a_Joints_1;\r\n#endif\r\n#ifdef ATTRIBUTE_WEIGHTS_0\r\nlayout(location=ATTRIBUTE_WEIGHTS_0) in vec4 a_Weights_0;\r\n#endif\r\n#ifdef ATTRIBUTE_WEIGHTS_1\r\nlayout(location=ATTRIBUTE_WEIGHTS_1) in vec4 a_Weights_1;\r\n#endif\r\n\r\n#ifdef NUM_SKIN_MATRICES\r\nuniform mat4 u_SkinMatrices[NUM_SKIN_MATRICES];\r\n#else\r\nuniform mat4 u_ModelMatrix;\r\nuniform mat3 u_NormalMatrix;\r\n#endif\r\n\r\n${declarations}\r\n\r\nvoid main() {\r\n#ifdef NUM_SKIN_MATRICES\r\n  mat4 u_ModelMatrix =\r\n    a_Weights_0.x * u_SkinMatrices[a_JOINTS_0.x] +\r\n    a_Weights_0.y * u_SkinMatrices[a_JOINTS_0.y] +\r\n    a_Weights_0.z * u_SkinMatrices[a_JOINTS_0.z] +\r\n    a_Weights_0.w * u_SkinMatrices[a_JOINTS_0.w];\r\n#ifdef ATTRIBUTE_JOINTS_1\r\n  u_ModelMatrix +=\r\n    a_Weights_1.x * u_SkinMatrices[a_JOINTS_1.x] +\r\n    a_Weights_1.y * u_SkinMatrices[a_JOINTS_1.y] +\r\n    a_Weights_1.z * u_SkinMatrices[a_JOINTS_1.z] +\r\n    a_Weights_1.w * u_SkinMatrices[a_JOINTS_1.w];\r\n#endif\r\n#ifdef ATTRIBUTE_NORMAL\r\n  mat3 u_NormalMatrix = transpose(inverse(mat3(u_ModelMatrix)));\r\n#endif\r\n#endif\r\n\r\n  vec3 pos = a_Position;\r\n#ifdef ATTRIBUTE_POSITION_1\r\n  pos += a_Position_1 * u_MorphWeights.x;\r\n#endif\r\n#ifdef ATTRIBUTE_POSITION_2\r\n  pos += a_Position_2 * u_MorphWeights.y;\r\n#endif\r\n#ifdef ATTRIBUTE_POSITION_3\r\n  pos += a_Position_3 * u_MorphWeights.z;\r\n#endif\r\n#ifdef ATTRIBUTE_POSITION_4\r\n  pos += a_Position_4 * u_MorphWeights.w;\r\n#endif\r\n  vec4 posW = u_ModelMatrix * vec4(pos, 1.0);\r\n  v_Position = posW.xyz / posW.w;\r\n\r\n#ifdef ATTRIBUTE_NORMAL\r\n  vec3 normal = a_Normal;\r\n#ifdef ATTRIBUTE_NORMAL_1\r\n  normal += a_Normal_1 * u_MorphWeights.x;\r\n#endif\r\n#ifdef ATTRIBUTE_NORMAL_2\r\n  normal += a_Normal_2 * u_MorphWeights.y;\r\n#endif\r\n#ifdef ATTRIBUTE_NORMAL_3\r\n  normal += a_Normal_3 * u_MorphWeights.z;\r\n#endif\r\n#ifdef ATTRIBUTE_NORMAL_4\r\n  normal += a_Normal_4 * u_MorphWeights.w;\r\n#endif\r\n  normal = normalize(u_NormalMatrix * normal);\r\n\r\n#ifdef ATTRIBUTE_TANGENT\r\n  vec3 tangent = a_Tangent.xyz;\r\n#ifdef ATTRIBUTE_TANGENT_1\r\n  tangent += a_Tangent_1 * u_MorphWeights.x;\r\n#endif\r\n#ifdef ATTRIBUTE_TANGENT_2\r\n  tangent += a_Tangent_2 * u_MorphWeights.y;\r\n#endif\r\n#ifdef ATTRIBUTE_TANGENT_3\r\n  tangent += a_Tangent_3 * u_MorphWeights.z;\r\n#endif\r\n#ifdef ATTRIBUTE_TANGENT_4\r\n  tangent += a_Tangent_4 * u_MorphWeights.w;\r\n#endif\r\n  tangent = normalize(vec3(u_ModelMatrix * vec4(tangent, 0.0)));\r\n  vec3 bitangent = cross(normal, tangent) * a_Tangent.w;\r\n  v_TBN = mat3(tangent, bitangent, normal);\r\n#else\r\n  v_Normal = normal;\r\n#endif\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_TEXCOORD_0\r\n  v_TexCoord[0] = a_TexCoord_0;\r\n#endif\r\n#ifdef ATTRIBUTE_TEXCOORD_1\r\n  v_TexCoord[1] = a_TexCoord_1;\r\n#endif\r\n#ifdef ATTRIBUTE_TEXCOORD_2\r\n  v_TexCoord[2] = a_TexCoord_2;\r\n#endif\r\n#ifdef ATTRIBUTE_TEXCOORD_3\r\n  v_TexCoord[3] = a_TexCoord_3;\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_COLOR_0\r\n  v_Color = a_Color_0;\r\n#ifdef ATTRIBUTE_COLOR_1\r\n  v_Color *= a_Color_1;\r\n#endif\r\n#endif\r\n\r\n  ${output_func}\r\n}\r\n"},function(t,e,n){"use strict";n.d(e,"a",function(){return _});var r,i,o=n(3),a=n.n(o),s=n(0),u=n(2),c=n(35),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=d(["{\n      vec2 size = vec2(textureSize(u_ShadowMap, 0));\n      vec3 pos = (light.shadow.xyz / light.shadow.w) * 0.5 + 0.5;\n      vec3 ux = light.shadowDx;\n      vec3 uy = light.shadowDy;\n      //vec3 ux = dFdx(pos);\n      //vec3 uy = dFdy(pos);\n      vec2 offset = vec2(ux.z * uy.y - ux.y * uy.z, ux.x * uy.z - ux.z * uy.x) / (ux.x * uy.y - ux.y * uy.x);\n    #if SHADOWMAP_ARRAY\n      vec4 uvw = vec4(pos.xy, float(light.shadowLayer), pos.z);\n      vec4 dx = vec4(1.0, 0.0, 0.0, offset.x) / size.x;\n      vec4 dy = vec4(0.0, 1.0, 0.0, offset.y) / size.y;\n      uvw.w -= abs(dx.w) + abs(dy.w) + 0.001;\n    #else\n      vec3 uvw = pos;\n      vec3 dx = vec3(1.0, 0.0, offset.x) / size.x;\n      vec3 dy = vec3(0.0, 1.0, offset.y) / size.y;\n      uvw.z -= abs(dx.z) + abs(dy.z) + 0.001;\n    #endif\n      float accum = texture(u_ShadowMap, uvw);\n      ","\n      return accum / ",";\n    }"],["{\n      vec2 size = vec2(textureSize(u_ShadowMap, 0));\n      vec3 pos = (light.shadow.xyz / light.shadow.w) * 0.5 + 0.5;\n      vec3 ux = light.shadowDx;\n      vec3 uy = light.shadowDy;\n      //vec3 ux = dFdx(pos);\n      //vec3 uy = dFdy(pos);\n      vec2 offset = vec2(ux.z * uy.y - ux.y * uy.z, ux.x * uy.z - ux.z * uy.x) / (ux.x * uy.y - ux.y * uy.x);\n    #if SHADOWMAP_ARRAY\n      vec4 uvw = vec4(pos.xy, float(light.shadowLayer), pos.z);\n      vec4 dx = vec4(1.0, 0.0, 0.0, offset.x) / size.x;\n      vec4 dy = vec4(0.0, 1.0, 0.0, offset.y) / size.y;\n      uvw.w -= abs(dx.w) + abs(dy.w) + 0.001;\n    #else\n      vec3 uvw = pos;\n      vec3 dx = vec3(1.0, 0.0, offset.x) / size.x;\n      vec3 dy = vec3(0.0, 1.0, offset.y) / size.y;\n      uvw.z -= abs(dx.z) + abs(dy.z) + 0.001;\n    #endif\n      float accum = texture(u_ShadowMap, uvw);\n      ","\n      return accum / ",";\n    }"]),h=d(["\n    //in float depth;\n    void main() {\n      //gl_FragDepth = depth;\n    }\n  "],["\n    //in float depth;\n    void main() {\n      //gl_FragDepth = depth;\n    }\n  "]);function d(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}s.e.create();var _=(i=r=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.shadowmapFrag=a()(h),i.resolution=n,i.kernel=r,i.padding=3+r,i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c["a"]),f(e,[{key:"type",get:function(){return"PCF_"+this.kernel}},{key:"shadowFunc",get:function(){for(var t=function(t,e){return 0===t?"":1===t?" + "+e:-1===t?" - "+e:t>0?" + "+t.toFixed(1)+" * "+e:" - "+(-t).toFixed(1)+" * "+e},e=[],n=-this.kernel;n<=this.kernel;++n)for(var r=-this.kernel;r<=this.kernel;++r)0===n&&0===r||e.push("accum += texture(u_ShadowMap, uvw"+t(n,"dx")+t(r,"dy")+");");return a()(l,e.join("\n"),Math.pow(2*this.kernel+1,2).toFixed(1))}}]),f(e,[{key:"getArrayTargets",value:function(t){var e=this.renderer,n=this.resolution;return e.cache("pcf_target_array_"+n+"_"+t,function(){var r=new e.Texture(u.TEXTURE_2D_ARRAY);r.create3D(n,n,t,u.DEPTH_COMPONENT32F),r.filter(u.LINEAR),r.wrap(u.CLAMP_TO_EDGE),r.compareMode(u.COMPARE_REF_TO_TEXTURE,u.LEQUAL);var i=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Array(t))).map(function(t,i){return new e.RenderTarget(n,n,{depth:{texture:r,layer:i}},{depthTest:!0,depthMask:!0,blend:!1,cull:!0})});return{texture:r,targets:i}})}},{key:"renderMap",value:function(t){var e=this.target;return e.bind().clear(),t(),e.unbind(),e.depth}},{key:"renderMapArray",value:function(t,e){var n=this.getArrayTargets(e),r=n.texture;return n.targets.forEach(function(e,n){e.bind().clear(),t(n),e.unbind()}),r}},{key:"target",get:function(){var t=this.renderer,e=this.resolution;return t.cache("pcf_target_"+e,function(){return new t.RenderTarget(e,e,{depth:{format:u.DEPTH_COMPONENT32F,filter:u.LINEAR,wrap:u.CLAMP_TO_EDGE,compare:u.LEQUAL}},{depthTest:!0,depthMask:!0,blend:!1,cull:!0})})}}]),e}(),r.shadowmapType="sampler2DShadow",r.shadowmapTypeArray="sampler2DArrayShadow",r.needsDerivatives=!0,i)},function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r,i,o=n(3),a=n.n(o),s=n(0),u=n(2),c=n(35),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=_(["\n    in float v_Depth;\n    layout(location=0) out vec2 o_Moments;\n    void main() {\n      float dx = dFdx(v_Depth);\n      float dy = dFdy(v_Depth);\n      o_Moments = vec2(v_Depth, v_Depth * v_Depth + 0.25 * (dx * dx + dy * dy));\n    }\n  "],["\n    in float v_Depth;\n    layout(location=0) out vec2 o_Moments;\n    void main() {\n      float dx = dFdx(v_Depth);\n      float dy = dFdy(v_Depth);\n      o_Moments = vec2(v_Depth, v_Depth * v_Depth + 0.25 * (dx * dx + dy * dy));\n    }\n  "]),h=_(["{\n    vec2 uv = (light.shadow.xy / light.shadow.w) * 0.5 + 0.5;\n    vec2 moments = texture(u_ShadowMap, uv).xy;\n    float p = smoothstep(light.distance - 0.001, light.distance, moments.x);\n    float variance = max(moments.y - moments.x * moments.x, -0.00005);\n    float d = light.distance - moments.x;\n    float p_max = clamp((variance / (variance + d * d) - 0.3) / 0.7, 0.0, 1.0);\n    return clamp(max(p, p_max), 0.0, 1.0);\n  }"],["{\n    vec2 uv = (light.shadow.xy / light.shadow.w) * 0.5 + 0.5;\n    vec2 moments = texture(u_ShadowMap, uv).xy;\n    float p = smoothstep(light.distance - 0.001, light.distance, moments.x);\n    float variance = max(moments.y - moments.x * moments.x, -0.00005);\n    float d = light.distance - moments.x;\n    float p_max = clamp((variance / (variance + d * d) - 0.3) / 0.7, 0.0, 1.0);\n    return clamp(max(p, p_max), 0.0, 1.0);\n  }"]),d=_(["\n        return (get(-1,-1) + get(-1, 0) + get(-1, 1) +\n                get( 0,-1) + get( 0, 0) + get( 0, 1) +\n                get( 1,-1) + get( 1, 0) + get( 1, 1)) / 9.0;\n      "],["\n        return (get(-1,-1) + get(-1, 0) + get(-1, 1) +\n                get( 0,-1) + get( 0, 0) + get( 0, 1) +\n                get( 1,-1) + get( 1, 0) + get( 1, 1)) / 9.0;\n      "]);function _(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}s.e.create();var p=(i=r=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.shadowmapFrag=a()(l),o.shadowFunc=a()(h),o.resolution=n,o.padding=4,o.msaa=r,o.useFilter=i,o}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c["a"]),f(e,[{key:"renderMap",value:function(t){var e=this.target,n=this.textureTarget;e.bind().clear(),t(),e.unbind(),n.bind(),n.blit(e,u.COLOR_BUFFER_BIT),n.unbind();var r=n.color;if(this.useFilter){var i=this.filter,o=this.filterTarget;r=i.apply(r,o).color}return r}},{key:"target",get:function(){var t=this.renderer,e=this.resolution,n=this.msaa;return t.cache("vsm_target_"+e+"_"+n,function(){return new t.RenderTarget(e,e,{color:{type:"renderbuffer",format:u.RG32F,samples:n},depth:{type:"renderbuffer",format:u.DEPTH_COMPONENT24,samples:n}},{depthTest:!0,depthMask:!0,blend:!1,cull:!0,clearColor:[1,1,1,1]})})}},{key:"textureTarget",get:function(){var t=this.renderer,e=this.resolution;return t.cache("vsm_color_"+e,function(){return new t.RenderTarget(e,e,{color:{format:u.RG32F,filter:u.LINEAR,wrap:u.CLAMP_TO_EDGE}})})}},{key:"filter",get:function(){var t=this.renderer;return t.cache("box_filter",function(){return new t.Filters.Local(a()(d))})}},{key:"filterTarget",get:function(){var t=this.renderer,e=this.resolution;return t.cache("vsm_filter_"+e,function(){return new t.RenderTarget(e,e,{color:{format:u.RG32F,filter:u.LINEAR,wrap:u.CLAMP_TO_EDGE}},{depthTest:!1,depthMask:!1,blend:!1})})}}]),e}(),r.shadowmapType="sampler2D",r.shadowmapTypeArray="sampler2DArray",i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(242);n.d(e,"Directional",function(){return r.a});var i=n(247);n.d(e,"Spot",function(){return i.a});var o=n(248);n.d(e,"Point",function(){return o.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return v});var r,i,o,a,s=n(3),u=n.n(s),c=n(0),f=n(36),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),h=(o=["{\n    info.shadow = u_Light.shadowmap * pos;\n    info.distance = info.shadow.z * 0.5 + 0.5;\n    info.color = u_Light.color;\n    info.direction = u_Light.direction;\n    info.penumbra = vec4(0.0, u_Light.iangle, 0.0, u_Light.scale);\n    return true;\n  }"],a=["{\n    info.shadow = u_Light.shadowmap * pos;\n    info.distance = info.shadow.z * 0.5 + 0.5;\n    info.color = u_Light.color;\n    info.direction = u_Light.direction;\n    info.penumbra = vec4(0.0, u_Light.iangle, 0.0, u_Light.scale);\n    return true;\n  }"],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}})));c.g.create(),c.g.create(),c.g.create();var d=[c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create()],_=c.e.create(),p=c.a.create(),E=c.a.create(),g=c.a.create(),v=(i=r=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.view=c.e.create(),i.world=n,c.g.copy(i.color,r),i.angularSize=4,i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Object(f["a"])(["mat4","shadowmap"],["vec3","direction"],["vec3","color"],["float","iangle"],["float","scale"])),l(e,[{key:"prepare",value:function(t,e,n){var r=this;c.e.invert(this.view,this.world),c.g.normalize(this.direction,this.world.slice(8,11)),c.g.negate(this.direction,this.direction),t.getCorners(d,n.zNear),t.getCorners(d.slice(4),n.zFar==1/0?100:n.zFar);for(var i=0,o=0;o<d.length;++o){c.g.transformMat4(d[o],d[o],this.view),o?c.a.combineVec3(g,g,d[o]):c.a.setVec3(g,d[o]);for(var a=0;a<o;++a)i=Math.max(i,c.g.distance(d[o],d[a]))}var s=!0;e=e.filter(function(t){var e=t.matrix,n=t.primitive;return c.e.fromAABB(_,n.box),c.e.multiply(_,e,_),c.e.multiply(_,r.view,_),c.a.fromMat4(E,_),g[0]<E[3]&&g[1]<E[4]&&g[3]>E[0]&&g[4]>E[1]&&(s?(c.a.copy(p,E),s=!1):c.a.combine(p,p,E),!0)});var u=i/(n.resolution-n.padding-2),f=Math.floor(((p[0]+p[3])/u-n.resolution)/2),l=Math.floor(((p[1]+p[4])/u-n.resolution)/2);p[0]=f*u,p[1]=l*u,p[3]=(f+n.resolution)*u,p[4]=(l+n.resolution)*u;var h=this.shadowmap;return c.e.ortho(h,p[0],p[3],p[1],p[4],-p[5],-p[2]),c.e.multiply(h,h,this.view),this.scale=u/(p[5]-p[2]),e}},{key:"angularSize",get:function(){return 360/this.iangle/Math.PI},set:function(t){this.iangle=360/(Math.PI*t)}}]),e}(),r.type="DirectionalLight",r.shaderFunc=u()(h),i)},function(t,e,n){(function(t,r){var i=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),u=r[n];n<o;u=r[++n])p(u)||!T(u)?a+=" "+u:a+=" "+s(u);return a},e.deprecate=function(n,i){if(v(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),_(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),f(r,t,r.depth)}function u(t,e){var n=s.styles[e];return n?"\x1b["+s.colors[n][0]+"m"+t+"\x1b["+s.colors[n][1]+"m":t}function c(t,e){return t}function f(t,n,r){if(t.customInspect&&n&&b(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return g(i)||(i=f(t,i,r)),i}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(E(e))return t.stylize(""+e,"number");if(_(e))return t.stylize(""+e,"boolean");if(p(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),m(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(n);if(0===a.length){if(b(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(A(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(y(n))return t.stylize(Date.prototype.toString.call(n),"date");if(m(n))return l(n)}var c,T="",R=!1,N=["{","}"];(d(n)&&(R=!0,N=["[","]"]),b(n))&&(T=" [Function"+(n.name?": "+n.name:"")+"]");return A(n)&&(T=" "+RegExp.prototype.toString.call(n)),y(n)&&(T=" "+Date.prototype.toUTCString.call(n)),m(n)&&(T=" "+l(n)),0!==a.length||R&&0!=n.length?r<0?A(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=R?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)M(e,String(a))?o.push(h(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}(t,n,r,s,a):a.map(function(e){return h(t,n,r,s,e,R)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,T,N)):N[0]+T+N[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),M(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?(s=p(n)?f(t,u.value,null):f(t,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),v(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t){return Array.isArray(t)}function _(t){return"boolean"===typeof t}function p(t){return null===t}function E(t){return"number"===typeof t}function g(t){return"string"===typeof t}function v(t){return void 0===t}function A(t){return T(t)&&"[object RegExp]"===R(t)}function T(t){return"object"===typeof t&&null!==t}function y(t){return T(t)&&"[object Date]"===R(t)}function m(t){return T(t)&&("[object Error]"===R(t)||t instanceof Error)}function b(t){return"function"===typeof t}function R(t){return Object.prototype.toString.call(t)}function N(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(v(o)&&(o=Object({NODE_ENV:"production",PUBLIC_URL:"/js3d",REACT_APP_BABEL_STAGE_0:"true;",REACT_APP_DECORATORS:"true;",REACT_APP_SASS:"true;",REACT_APP_WEBPACK_DASHBOARD:"true;"}).NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=r.pid;a[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=_,e.isNull=p,e.isNullOrUndefined=function(t){return null==t},e.isNumber=E,e.isString=g,e.isSymbol=function(t){return"symbol"===typeof t},e.isUndefined=v,e.isRegExp=A,e.isObject=T,e.isDate=y,e.isError=m,e.isFunction=b,e.isPrimitive=function(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t},e.isBuffer=n(245);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,n;console.log("%s - %s",(t=new Date,n=[N(t.getHours()),N(t.getMinutes()),N(t.getSeconds())].join(":"),[t.getDate(),I[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=n(246),e._extend=function(t,e){if(!e||!T(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,n(21),n(244))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&d())}function d(){if(!f){var t=s(h);f=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function _(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new _(t,e)),1!==c.length||f||s(d)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"===typeof t&&"function"===typeof t.copy&&"function"===typeof t.fill&&"function"===typeof t.readUInt8}},function(t,e){"function"===typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r,i,o,a,s=n(3),u=n.n(s),c=n(0),f=n(36),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),h=(o=["{\n    info.shadow = u_Light.shadowmap * pos;\n    vec2 xy = info.shadow.xy / info.shadow.w;\n    vec3 dir = pos.xyz - u_Light.position;\n    info.distance = dot(u_Light.direction, dir);\n    float rDistance = length(dir);\n    vec2 atten = 1.0 - smoothstep(u_Light.minSize, u_Light.maxSize, vec2(rDistance, length(xy)));\n    if (info.distance < 0.0) {\n      info.color = vec3(0.0);\n    } else {\n      info.color = u_Light.color * (atten.x * atten.y);\n    }\n    info.direction = dir / rDistance;\n    info.penumbra = u_Light.penumbra;\n    return true;\n  }"],a=["{\n    info.shadow = u_Light.shadowmap * pos;\n    vec2 xy = info.shadow.xy / info.shadow.w;\n    vec3 dir = pos.xyz - u_Light.position;\n    info.distance = dot(u_Light.direction, dir);\n    float rDistance = length(dir);\n    vec2 atten = 1.0 - smoothstep(u_Light.minSize, u_Light.maxSize, vec2(rDistance, length(xy)));\n    if (info.distance < 0.0) {\n      info.color = vec3(0.0);\n    } else {\n      info.color = u_Light.color * (atten.x * atten.y);\n    }\n    info.direction = dir / rDistance;\n    info.penumbra = u_Light.penumbra;\n    return true;\n  }"],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}})));c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.e.create(),c.a.create(),c.a.create(),c.a.create();var d=(i=r=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.view=c.e.create(),i.world=n,c.g.copy(i.color,r),i.minAngle=60,i.maxAngle=90,i.minRadius=1/0,i.maxRadius=1/0,i.lightSize=.5,i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Object(f["a"])(["vec3","color"],["vec3","position"],["vec3","direction"],["vec2","minSize"],["vec2","maxSize"],["mat4","shadowmap"],["vec4","penumbra"])),l(e,[{key:"prepare",value:function(t,e,n){var r=this.minAngle*Math.PI/180,i=this.maxAngle*Math.PI/180;c.g.normalize(this.direction,this.world.slice(8,11)),c.g.negate(this.direction,this.direction),c.g.copy(this.position,this.world.slice(12,15)),c.e.invert(this.view,this.world);var o=Math.tan(i/2)*n.resolution/(n.resolution-n.padding-2),a=2*Math.atan(o),s=this.shadowmap;c.e.perspective(s,a,1,this.lightSize,this.maxRadius);var u=this.minSize,f=this.maxSize;u[0]=this.minRadius==1/0?1e6:this.minRadius,u[1]=Math.tan(r/2)/o,f[0]=this.maxRadius==1/0?2e6:this.maxRadius,f[1]=Math.tan(i/2)/o;var l=this.penumbra;return l[0]=this.lightSize,l[1]=0,l[2]=-2*s[11]/(s[0]*n.resolution),l[3]=0,c.e.multiply(s,s,this.view),e}}]),e}(),r.type="SpotLight",r.shaderFunc=u()(h),i)},function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r,i,o,a,s=n(3),u=n.n(s),c=n(0),f=n(36),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),h=(o=["{\n    vec4 local = u_Light.view * pos;\n  #ifdef RENDER_SHADOWMAP\n    info.shadow = u_Light.shadowmap[u_ShadowMapIndex] * local;\n    info.shadowLayer = u_ShadowMapIndex;\n    info.distance = -info.shadow.w;\n  #elif NEEDS_DERIVATIVES\n    vec4 localAbs = abs(local);\n    int layerX = int(1.5 - step(0.0, local.x));\n    int layerY = 2 + int(1.5 - step(0.0, local.y));\n    int layerZ = 4 + int(1.5 - step(0.0, local.z));\n    vec4 posX = u_Light.shadowmap[layerX] * local;\n    vec4 posY = u_Light.shadowmap[layerY] * local;\n    vec4 posZ = u_Light.shadowmap[layerZ] * local;\n    posX = (posX / posX.w) * 0.5 + 0.5;\n    posY = (posY / posY.w) * 0.5 + 0.5;\n    posZ = (posZ / posZ.w) * 0.5 + 0.5;\n    vec3 dXdx = dFdx(posX.xyz), dXdy = dFdy(posX.xyz);\n    vec3 dYdx = dFdx(posY.xyz), dYdy = dFdy(posY.xyz);\n    vec3 dZdx = dFdx(posZ.xyz), dZdy = dFdy(posZ.xyz);\n    if (localAbs.x > localAbs.y && localAbs.x > localAbs.z) {\n      info.shadowLayer = layerX;\n      info.shadowDx = dXdx;\n      info.shadowDy = dXdy;\n      info.distance = localAbs.x;\n    } else if (localAbs.y > localAbs.z) {\n      info.shadowLayer = layerY;\n      info.shadowDx = dYdx;\n      info.shadowDy = dYdy;\n      info.distance = localAbs.y;\n    } else {\n      info.shadowLayer = layerZ;\n      info.shadowDx = dZdx;\n      info.shadowDy = dZdy;\n      info.distance = localAbs.z;\n    }\n    info.shadow = u_Light.shadowmap[info.shadowLayer] * local;\n  #else\n    vec4 localAbs = abs(local);\n    int index;\n    if (localAbs.x > localAbs.y && localAbs.x > localAbs.z) {\n      index = (local.x > 0.0 ? 0 : 1);\n      info.distance = localAbs.x;\n    } else if (localAbs.y > localAbs.z) {\n      index = (local.y > 0.0 ? 2 : 3);\n      info.distance = localAbs.y;\n    } else {\n      index = (local.z > 0.0 ? 4 : 5);\n      info.distance = localAbs.z;\n    }\n    info.shadow = u_Light.shadowmap[index] * local;\n    info.shadowLayer = index;\n  #endif\n    vec3 dir = pos.xyz - u_Light.position;\n    float rDistance = length(dir);\n    info.color = u_Light.color * (1.0 - smoothstep(u_Light.radius.x, u_Light.radius.y, rDistance));\n    info.direction = dir / rDistance;\n    info.penumbra = u_Light.penumbra;\n    return true;\n  }"],a=["{\n    vec4 local = u_Light.view * pos;\n  #ifdef RENDER_SHADOWMAP\n    info.shadow = u_Light.shadowmap[u_ShadowMapIndex] * local;\n    info.shadowLayer = u_ShadowMapIndex;\n    info.distance = -info.shadow.w;\n  #elif NEEDS_DERIVATIVES\n    vec4 localAbs = abs(local);\n    int layerX = int(1.5 - step(0.0, local.x));\n    int layerY = 2 + int(1.5 - step(0.0, local.y));\n    int layerZ = 4 + int(1.5 - step(0.0, local.z));\n    vec4 posX = u_Light.shadowmap[layerX] * local;\n    vec4 posY = u_Light.shadowmap[layerY] * local;\n    vec4 posZ = u_Light.shadowmap[layerZ] * local;\n    posX = (posX / posX.w) * 0.5 + 0.5;\n    posY = (posY / posY.w) * 0.5 + 0.5;\n    posZ = (posZ / posZ.w) * 0.5 + 0.5;\n    vec3 dXdx = dFdx(posX.xyz), dXdy = dFdy(posX.xyz);\n    vec3 dYdx = dFdx(posY.xyz), dYdy = dFdy(posY.xyz);\n    vec3 dZdx = dFdx(posZ.xyz), dZdy = dFdy(posZ.xyz);\n    if (localAbs.x > localAbs.y && localAbs.x > localAbs.z) {\n      info.shadowLayer = layerX;\n      info.shadowDx = dXdx;\n      info.shadowDy = dXdy;\n      info.distance = localAbs.x;\n    } else if (localAbs.y > localAbs.z) {\n      info.shadowLayer = layerY;\n      info.shadowDx = dYdx;\n      info.shadowDy = dYdy;\n      info.distance = localAbs.y;\n    } else {\n      info.shadowLayer = layerZ;\n      info.shadowDx = dZdx;\n      info.shadowDy = dZdy;\n      info.distance = localAbs.z;\n    }\n    info.shadow = u_Light.shadowmap[info.shadowLayer] * local;\n  #else\n    vec4 localAbs = abs(local);\n    int index;\n    if (localAbs.x > localAbs.y && localAbs.x > localAbs.z) {\n      index = (local.x > 0.0 ? 0 : 1);\n      info.distance = localAbs.x;\n    } else if (localAbs.y > localAbs.z) {\n      index = (local.y > 0.0 ? 2 : 3);\n      info.distance = localAbs.y;\n    } else {\n      index = (local.z > 0.0 ? 4 : 5);\n      info.distance = localAbs.z;\n    }\n    info.shadow = u_Light.shadowmap[index] * local;\n    info.shadowLayer = index;\n  #endif\n    vec3 dir = pos.xyz - u_Light.position;\n    float rDistance = length(dir);\n    info.color = u_Light.color * (1.0 - smoothstep(u_Light.radius.x, u_Light.radius.y, rDistance));\n    info.direction = dir / rDistance;\n    info.penumbra = u_Light.penumbra;\n    return true;\n  }"],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}})));c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create(),c.g.create();var d=c.e.create(),_=(c.a.create(),c.a.create(),c.a.create(),[c.e.fromRows(c.g.negY,c.g.posZ,c.g.negX),c.e.fromRows(c.g.posY,c.g.posZ,c.g.posX),c.e.fromRows(c.g.posX,c.g.posZ,c.g.negY),c.e.fromRows(c.g.negX,c.g.posZ,c.g.posY),c.e.fromRows(c.g.posX,c.g.negY,c.g.negZ),c.e.fromRows(c.g.posX,c.g.posY,c.g.posZ)]),p=(i=r=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.world=n,c.g.copy(i.color,r),i.minRadius=1/0,i.maxRadius=1/0,i.lightSize=.5,i}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Object(f["a"])(["vec3","color"],["vec3","position"],["vec2","radius"],["mat4","view"],["mat4","shadowmap",6],["vec4","penumbra"])),l(e,[{key:"prepare",value:function(t,e,n){c.g.copy(this.position,this.world.slice(12,15)),c.e.invert(this.view,this.world);var r=n.resolution/(n.resolution-n.padding-2),i=2*Math.atan(r),o=this.shadowmap;c.e.perspective(d,i,1,this.lightSize,this.maxRadius);for(var a=0;a<6;++a){var s=o.subarray(16*a,16*a+16);c.e.multiply(s,d,_[a])}var u=this.radius;u[0]=this.minRadius==1/0?1e6:this.minRadius,u[1]=this.maxRadius==1/0?2e6:this.maxRadius;var f=this.penumbra;return f[0]=this.lightSize,f[1]=0,f[2]=-2*d[11]/(d[0]*n.resolution),f[3]=0,e}}]),e}(),r.type="PointLight",r.arraySize=6,r.providesDerivatives=!0,r.shaderFunc=u()(h),i)},function(t,e,n){"use strict";e.a=function(t,e,n,r,o){var s=new i.a(4,a);return s.add({POSITION:[e,n]}),s.add({POSITION:[r,n]}),s.add({POSITION:[e,o]}),s.add({POSITION:[r,o]}),s.build(t,[0,1,3,0,3,2])};var r=n(14),i=n(7),o=n(2),a=new r.a({POSITION:{type:o.FLOAT,size:2}})},function(t,e){t.exports="#define SHADER_NAME_B64 bGlnaHRQYXNzLnZlcnQ=\nlayout(location=0) in vec2 a_Position;\r\nuniform vec4 u_InvProj;\r\nuniform vec4 u_Transform;\r\nout vec2 v_Position;\r\nvoid main() {\r\n  vec2 pos = a_Position * u_Transform.xy + u_Transform.zw;\r\n  gl_Position = vec4(pos, 0.0, 1.0);\r\n  v_Position = pos * u_InvProj.xy;\r\n}\r\n"},function(t,e){t.exports="#define SHADER_NAME_B64 bGlnaHRQYXNzLmZyYWc=\nstruct PBRInfo {\r\n  float NdotL;\r\n  float NdotV;\r\n  float NdotH;\r\n  float LdotH;\r\n  float VdotH;\r\n  float metallic;\r\n  float roughness;\r\n  float alphaRoughness;\r\n  vec3 diffuseColor;\r\n  vec3 specularColor;\r\n  vec3 reflectance0;\r\n  vec3 reflectance90;\r\n};\r\n\r\nconst float M_PI = 3.141592653589793;\r\n\r\n// Lambertian diffuse\r\nvec3 diffuse(in PBRInfo pbr) {\r\n  return pbr.diffuseColor / M_PI;\r\n}\r\n\r\n// Frensel reflectance\r\nvec3 specularReflection(in PBRInfo pbr) {\r\n  return mix(pbr.reflectance0, pbr.reflectance90, pow(clamp(1.0 - pbr.VdotH, 0.0, 1.0), 5.0));\r\n}\r\n\r\n// Schlick geometric occlusion\r\nfloat geometricOcclusion(in PBRInfo pbr) {\r\n  float r = pbr.alphaRoughness;\r\n  float NdotL = pbr.NdotL;\r\n  float NdotV = pbr.NdotV;\r\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(mix(r * r, 1.0, NdotL * NdotL)));\r\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(mix(r * r, 1.0, NdotV * NdotV)));\r\n  return attenuationL * attenuationV;\r\n}\r\n\r\n// Schlick geometric occlusion\r\nconst float Sqrt2overPi = sqrt(2.0 / M_PI);\r\nfloat geometricOcclusion2(in PBRInfo pbr) {\r\n  float k = pbr.roughness * Sqrt2overPi;\r\n  float LdotH = pbr.LdotH;\r\n  float NdotH = pbr.NdotH;\r\n  float attenuationL = LdotH / (LdotH * (1.0 - k) * k);\r\n  float attenuationN = NdotH / (NdotH * (1.0 - k) * k);\r\n  return attenuationL * attenuationN;\r\n}\r\n\r\n// Trowbridge-Reitz microfacet distribution\r\nfloat microfacetDistribution(in PBRInfo pbr) {\r\n  float roughnessSq = pbr.alphaRoughness * pbr.alphaRoughness;\r\n  float f = (pbr.NdotH * roughnessSq - pbr.NdotH) * pbr.NdotH + 1.0;\r\n  return roughnessSq / (M_PI * f * f);\r\n}\r\n\r\nvec3 calculateColor(in vec3 baseColor, in float metallic, in float roughness, in vec3 normal, in vec3 view, in vec3 light) {\r\n  PBRInfo pbr;\r\n  pbr.metallic = metallic;\r\n  pbr.roughness = roughness;\r\n  pbr.alphaRoughness = pbr.roughness * pbr.roughness;\r\n\r\n  vec3 f0 = vec3(0.04);\r\n  pbr.diffuseColor = baseColor * (vec3(1.0) - f0) * (1.0 - pbr.metallic);\r\n  pbr.specularColor = mix(f0, baseColor, pbr.metallic);\r\n\r\n  float reflectance = max(max(pbr.specularColor.r, pbr.specularColor.g), pbr.specularColor.b);\r\n  float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r\n  pbr.reflectance0 = pbr.specularColor;\r\n  pbr.reflectance90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r\n\r\n  vec3 halfDir = normalize(light + view);\r\n\r\n  pbr.NdotL = clamp(dot(normal, light), 0.001, 1.0);\r\n  pbr.NdotV = clamp(abs(dot(normal, view)), 0.001, 1.0);\r\n  pbr.NdotH = clamp(dot(normal, halfDir), 0.0, 1.0);\r\n  pbr.LdotH = clamp(dot(light, halfDir), 0.0, 1.0);\r\n  pbr.VdotH = clamp(dot(view, halfDir), 0.0, 1.0);\r\n\r\n  vec3 F = specularReflection(pbr);\r\n  float G = geometricOcclusion(pbr);\r\n  float D = microfacetDistribution(pbr);\r\n\r\n  vec3 fDiffuse = (1.0 - F) * diffuse(pbr);\r\n  vec3 fSpecular = F * G * D / (4.0 * pbr.NdotL * pbr.NdotV);\r\n  return pbr.NdotL * (fDiffuse + fSpecular);\r\n}\r\n\r\n\r\nin vec2 v_Position;\r\nuniform vec4 u_InvProj;\r\nuniform mat4 u_InverseViewMatrix;\r\nuniform sampler2D u_Color;\r\nuniform sampler2D u_Normal;\r\nuniform sampler2D u_Depth;\r\n\r\n${lightCode}\r\n${shadowCode}\r\n\r\nlayout(location=0) out vec4 o_Color;\r\n\r\nvoid main() {\r\n  ivec2 coord = ivec2(gl_FragCoord.xy);\r\n  vec4 tColor = texelFetch(u_Color, coord, 0);\r\n  vec4 tNormal = texelFetch(u_Normal, coord, 0);\r\n  float tDepth = texelFetch(u_Depth, coord, 0).x;\r\n\r\n  vec4 worldPos = vec4(vec3(v_Position, -1) / (tDepth * u_InvProj.z + u_InvProj.w), 1.0);\r\n  worldPos = u_InverseViewMatrix * worldPos;\r\n  LightInfo light;\r\n  if (!${lightFunction}(worldPos, light)) {\r\n    discard;\r\n  }\r\n#if CALCULATE_DERIVATIVES\r\n  vec3 tPos = (light.shadow.xyz / light.shadow.w) * 0.5 + 0.5;\r\n  light.shadowDx = dFdx(tPos);\r\n  light.shadowDy = dFdy(tPos);\r\n#endif\r\n\r\n  float shadow = getShadow(light);\r\n\r\n  vec3 viewDir = normalize(u_InverseViewMatrix[3].xyz - worldPos.xyz);\r\n  vec3 lightDir = normalize(-light.direction);\r\n  vec3 pbr = calculateColor(tColor.rgb, tColor.a, tNormal.w, normalize(tNormal.xyz), viewDir, lightDir);\r\n\r\n  //o_Color = vec4(pow(pbr * light.color, vec3(1.0 / 2.2)) * shadow, 1.0);\r\n  o_Color = vec4(pbr * light.color * shadow, 1.0);\r\n}\r\n"},function(t,e){t.exports="#define SHADER_NAME_B64 ZmluYWxQYXNzLnZlcnQ=\nlayout(location=0) in vec2 a_Position;\r\nvoid main() {\r\n  gl_Position = vec4(a_Position, 0.0, 1.0);\r\n}\r\n"},function(t,e){t.exports="#define SHADER_NAME_B64 ZmluYWxQYXNzLmZyYWc=\nuniform sampler2D u_Color;\r\nuniform sampler2D u_Emissive;\r\n\r\n#if USE_REFLECTION\r\nuniform sampler2D u_Reflection;\r\n#endif\r\n\r\nlayout(location=0) out vec4 o_Color;\r\n\r\nvoid main() {\r\n  ivec2 coord = ivec2(gl_FragCoord.xy);\r\n  vec3 tColor = texelFetch(u_Color, coord, 0).rgb;\r\n  vec4 tEmissive = texelFetch(u_Emissive, coord, 0);\r\n\r\n  vec3 color = tColor * tEmissive.a + tEmissive.rgb;\r\n\r\n#if USE_REFLECTION\r\n  vec2 tCoord = gl_FragCoord.xy / vec2(textureSize(u_Reflection, 0));\r\n  vec4 tReflected = texelFetch(u_Reflection, coord, 0);\r\n  vec4 factors = pow(vec4(1.0, 0.6, 0.4, 0.2), vec4(1.0 * (1.0 - tReflected.a)));\r\n  factors /= dot(factors, vec4(1.0, 4.0, 4.0, 4.0));\r\n  color += tReflected.rgb * factors.x;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2(-1,  0)).rgb * factors.y;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 1,  0)).rgb * factors.y;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 0, -1)).rgb * factors.y;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 0,  1)).rgb * factors.y;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2(-1,  1)).rgb * factors.z;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 1,  1)).rgb * factors.z;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2(-1, -1)).rgb * factors.z;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 1, -1)).rgb * factors.z;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2(-2,  0)).rgb * factors.w;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 2,  0)).rgb * factors.w;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 0, -2)).rgb * factors.w;\r\n  color += textureOffset(u_Reflection, tCoord, ivec2( 0,  2)).rgb * factors.w;\r\n#endif\r\n\r\n  o_Color = vec4(pow(color, vec3(1.0 / 2.2)), 1.0);\r\n}\r\n"},function(t,e){t.exports="#define SHADER_NAME_B64 c3NyUGFzcy5mcmFn\nuniform sampler2D u_Color;\r\nuniform sampler2D u_Normal;\r\nuniform sampler2D u_Emissive;\r\nuniform sampler2D u_Accum;\r\nuniform sampler2D u_Depth;\r\nuniform vec4 u_InvProj;\r\nuniform mat3 u_ViewMatrix;\r\nuniform mat4 u_InverseViewMatrix;\r\n\r\nlayout(location=0) out vec4 o_Color;\r\n\r\nfloat rand(vec2 c) {\r\n\treturn fract(sin(dot(c.xy ,vec2(12.9898,78.233))) * 43758.5453);\r\n}\r\nvec3 randVec() {\r\n  vec2 c = gl_FragCoord.xy;\r\n  return vec3(rand(c), rand(c + vec2(1.5, 3.5)), rand(c - vec2(1.5, 3.5)));\r\n}\r\n\r\nvoid main() {\r\n  ivec2 coord = ivec2(gl_FragCoord.xy);\r\n\r\n  vec4 tColor = texelFetch(u_Color, coord, 0);\r\n  vec4 tNormal = texelFetch(u_Normal, coord, 0);\r\n  float tDepth = texelFetch(u_Depth, coord, 0).x;\r\n\r\n  float metallic = tColor.a;\r\n  float roughness = tNormal.w;\r\n\r\n  if (metallic < 0.01) {\r\n    discard;\r\n  }\r\n\r\n  vec3 specularColor = mix(vec3(0.04), tColor.rgb, metallic);\r\n\r\n  vec3 screenPos = vec3(gl_FragCoord.xy / vec2(textureSize(u_Depth, 0)), tDepth);\r\n\r\n  vec2 position = screenPos.xy * 2.0 - 1.0;\r\n  position *= u_InvProj.xy;\r\n  vec3 viewPos = vec3(position, -1) / (tDepth * u_InvProj.z + u_InvProj.w);\r\n  vec3 viewNormal = normalize(u_ViewMatrix * tNormal.xyz);\r\n  vec3 reflected = normalize(reflect(viewPos, viewNormal));\r\n\r\n  vec4 worldPos = u_InverseViewMatrix * vec4(viewPos, 1.0);\r\n\r\n  vec3 randNormal = normalize(vec3(rand(worldPos.xy), rand(worldPos.xz), rand(worldPos.yz)));\r\n  randNormal *= sign(dot(randNormal, viewNormal));\r\n  reflected = normalize(mix(reflected, randNormal, 0.25 * pow(roughness, 8.0)));\r\n\r\n  vec3 screenDir = vec3(-reflected.xy / (2.0 * u_InvProj.xy * reflected.z) + 0.5, -u_InvProj.w / u_InvProj.z) - screenPos;\r\n  screenDir *= -sign(reflected.z);\r\n  float screenDist = length(screenDir.xy);\r\n  screenDir /= screenDist;\r\n  float travelDist = min(screenDist, 1.5);\r\n  if (screenDir.x < 0.0) {\r\n    travelDist = min(travelDist, -screenPos.x / screenDir.x);\r\n  } else if (screenDir.x > 0.0) {\r\n    travelDist = min(travelDist, (1.0 - screenPos.x) / screenDir.x);\r\n  }\r\n  if (screenDir.y < 0.0) {\r\n    travelDist = min(travelDist, -screenPos.y / screenDir.y);\r\n  } else if (screenDir.y > 0.0) {\r\n    travelDist = min(travelDist, (1.0 - screenPos.y) / screenDir.y);\r\n  }\r\n  int steps = min(128, int(float(textureSize(u_Depth, 0).x) * travelDist));\r\n\r\n  vec3 color = vec3(0.0, 0.0, 0.0);\r\n\r\n  for (int t = int(float(steps) * 0.01 / travelDist); t < steps; ++t) {\r\n    float tx = float(t) / float(steps) * travelDist;\r\n    vec3 samplePos = screenPos + tx * screenDir;\r\n    float depthAt = texture(u_Depth, samplePos.xy).x;\r\n    if (depthAt < samplePos.z) {\r\n      vec3 aColor = texture(u_Accum, samplePos.xy).rgb;\r\n      vec4 aEmissive = texture(u_Emissive, samplePos.xy);\r\n      aColor = aColor * aEmissive.a + aEmissive.rgb;\r\n      color = aColor;\r\n      break;\r\n    }\r\n  }\r\n\r\n  o_Color = vec4(color * specularColor, roughness);\r\n}\r\n"},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r,i,o=n(74),a=n(256),s=n.n(a);var u=(i=r=function(t){function e(t,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,s.a,{defines:r}))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o["a"]),e}(),r.shaderName="GBuffer",r.useMaterials=!0,i)},function(t,e){t.exports="#define SHADER_NAME_B64 Z2J1ZmZlci5mcmFn\nin vec3 v_Position;\r\n#ifdef ATTRIBUTE_NORMAL\r\n  #ifdef ATTRIBUTE_TANGENT\r\n    in mat3 v_TBN;\r\n  #else\r\n    in vec3 v_Normal;\r\n  #endif\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_TEXCOORD_3\r\nin vec2 v_TexCoord[4];\r\n#define ATTRIBUTE_TEXCOORD_COUNT 4\r\n#elif defined ATTRIBUTE_TEXCOORD_2\r\nin vec2 v_TexCoord[3];\r\n#define ATTRIBUTE_TEXCOORD_COUNT 3\r\n#elif defined ATTRIBUTE_TEXCOORD_1\r\nin vec2 v_TexCoord[2];\r\n#define ATTRIBUTE_TEXCOORD_COUNT 2\r\n#elif defined ATTRIBUTE_TEXCOORD_0\r\nin vec2 v_TexCoord[1];\r\n#define ATTRIBUTE_TEXCOORD_COUNT 1\r\n#else\r\n#define ATTRIBUTE_TEXCOORD_COUNT 0\r\n#endif\r\n\r\n#ifdef ATTRIBUTE_COLOR_0\r\nin vec4 v_Color;\r\n#endif\r\n\r\nuniform MaterialBlock {\r\n  vec4 baseColorFactor;\r\n  vec3 emissiveFactor;\r\n  float metallicFactor;\r\n  float roughnessFactor;\r\n  float normalScale;\r\n  float occlusionStrength;\r\n  float alphaCutoff;\r\n} u_Material;\r\n\r\n#ifdef ATTRIBUTE_TEXCOORD_COUNT\r\n#endif\r\n\r\n#ifdef MATERIAL_BASE_COLOR_TEXTURE\r\n#if defined ATTRIBUTE_TEXCOORD_COUNT && ATTRIBUTE_TEXCOORD_COUNT <= MATERIAL_BASE_COLOR_TEXTURE\r\n#undef MATERIAL_BASE_COLOR_TEXTURE\r\n#else\r\nuniform sampler2D u_BaseColorTexture;\r\n#endif\r\n#endif\r\n\r\n#ifdef MATERIAL_METALLIC_ROUGHNESS_TEXTURE\r\n#if defined ATTRIBUTE_TEXCOORD_COUNT && ATTRIBUTE_TEXCOORD_COUNT <= MATERIAL_METALLIC_ROUGHNESS_TEXTURE\r\n#undef MATERIAL_METALLIC_ROUGHNESS_TEXTURE\r\n#else\r\nuniform sampler2D u_MetallicRoughnessTexture;\r\n#endif\r\n#endif\r\n\r\n#ifdef MATERIAL_NORMAL_TEXTURE\r\n#if defined ATTRIBUTE_TEXCOORD_COUNT && ATTRIBUTE_TEXCOORD_COUNT <= MATERIAL_NORMAL_TEXTURE\r\n#undef MATERIAL_NORMAL_TEXTURE\r\n#else\r\nuniform sampler2D u_NormalTexture;\r\n#endif\r\n#endif\r\n\r\n#ifdef MATERIAL_OCCLUSSION_TEXTURE\r\n#if defined ATTRIBUTE_TEXCOORD_COUNT && ATTRIBUTE_TEXCOORD_COUNT <= MATERIAL_OCCLUSSION_TEXTURE\r\n#undef MATERIAL_OCCLUSSION_TEXTURE\r\n#else\r\nuniform sampler2D u_OcclusionTexture;\r\n#endif\r\n#endif\r\n\r\n#ifdef MATERIAL_EMISSIVE_TEXTURE\r\n#if defined ATTRIBUTE_TEXCOORD_COUNT && ATTRIBUTE_TEXCOORD_COUNT <= MATERIAL_EMISSIVE_TEXTURE\r\n#undef MATERIAL_EMISSIVE_TEXTURE\r\n#else\r\nuniform sampler2D u_EmissiveTexture;\r\n#endif\r\n#endif\r\n\r\nvec3 getNormal() {\r\n#ifdef MATERIAL_NORMAL_TEXTURE\r\n  vec2 uv = v_TexCoord[MATERIAL_NORMAL_TEXTURE];\r\n\r\n#if defined ATTRIBUTE_TANGENT && defined ATTRIBUTE_NORMAL\r\n  mat3 tbn = v_TBN;\r\n#else\r\n  vec3 posDx = dFdx(v_Position);\r\n  vec3 posDy = dFdy(v_Position);\r\n  vec2 texDx = dFdx(uv);\r\n  vec2 texDy = dFdy(uv);\r\n  float area = sign(texDx.x * texDy.y - texDx.y * texDy.x);\r\n  vec3 t = (texDy.y * posDx - texDx.y * posDy) * area;\r\n#ifdef ATTRIBUTE_NORMAL\r\n  vec3 n = normalize(v_Normal);\r\n#else\r\n  vec3 n = normalize(cross(posDx, posDy));\r\n#ifdef MATERIAL_DOUBLE_SIDED\r\n  if (!gl_FrontFacing) {\r\n    n = -n;\r\n  }\r\n#endif\r\n#endif\r\n  //t = cross(vec3(1.0, 0.0, 0.0), n);\r\n  t = normalize(t - n * dot(n, t));\r\n  vec3 b = normalize(cross(n, t)) * area;\r\n  mat3 tbn = mat3(t, b, n);\r\n#endif\r\n\r\n  vec3 normal = texture(u_NormalTexture, uv).xyz;\r\n  normal = (2.0 * normal - 1.0) * vec3(u_Material.normalScale, u_Material.normalScale, 1.0);\r\n  normal = normalize(tbn * normal);\r\n#ifdef MATERIAL_DOUBLE_SIDED\r\n  if (!gl_FrontFacing) {\r\n    normal = -normal;\r\n  }\r\n#endif\r\n  return normal;\r\n\r\n#else\r\n\r\n#ifdef ATTRIBUTE_NORMAL\r\n\r\n#ifdef ATTRIBUTE_TANGENT\r\n  vec3 normal = normalize(v_TBN[2].xyz);\r\n#else\r\n  vec3 normal = normalize(v_Normal);\r\n#endif\r\n#ifdef MATERIAL_DOUBLE_SIDED\r\n  if (!gl_FrontFacing) {\r\n    normal = -normal;\r\n  }\r\n#endif\r\n  return normal;\r\n\r\n#else\r\n  // No normal, calculate using position\r\n  vec3 posDx = dFdx(v_Position);\r\n  vec3 posDy = dFdy(v_Position);\r\n  return normalize(cross(posDx, posDy));\r\n#endif\r\n\r\n#endif\r\n}\r\n\r\n\r\nlayout(location=0) out vec4 o_Color; // rgb=baseColor, a=metallic\r\nlayout(location=1) out vec4 o_Normal; // xyz=normal, w=roughness\r\nlayout(location=2) out vec4 o_Emissive; // rgb=emissiveColor, w=occlusion\r\n\r\nvoid main() {\r\n  vec4 color = u_Material.baseColorFactor;\r\n#ifdef ATTRIBUTE_COLOR_0\r\n  color *= v_Color;\r\n#endif\r\n#ifdef MATERIAL_BASE_COLOR_TEXTURE\r\n  color *= texture(u_BaseColorTexture, v_TexCoord[MATERIAL_BASE_COLOR_TEXTURE]);\r\n#endif\r\n#ifdef MATERIAL_ALPHA_MASK\r\n  if (color.a < u_Material.alphaCutoff) {\r\n    discard;\r\n  }\r\n#endif\r\n#ifdef MATERIAL_ALPHA_BLEND\r\n  if (color.a < 0.01) {\r\n    discard;\r\n  }\r\n#endif\r\n\r\n  float metallic = u_Material.metallicFactor;\r\n  float roughness = u_Material.roughnessFactor;\r\n#ifdef MATERIAL_METALLIC_ROUGHNESS_TEXTURE\r\n  vec4 mrSample = texture(u_MetallicRoughnessTexture, v_TexCoord[MATERIAL_METALLIC_ROUGHNESS_TEXTURE]);\r\n  metallic *= mrSample.b;\r\n  roughness *= mrSample.g;\r\n#endif\r\n\r\n  vec3 normal = getNormal();\r\n\r\n  float occlusion = 1.0;\r\n#ifdef MATERIAL_OCCLUSION_TEXTURE\r\n  occlusion = texture(u_OcclusionTexture, v_TexCoord[MATERIAL_OCCLUSION_TEXTURE]).r;\r\n  occlusion = mix(1.0, occlusion, u_Material.occlusionStrength);\r\n#endif\r\n\r\n  vec3 emissive = u_Material.emissiveFactor;\r\n#ifdef MATERIAL_EMISSIVE_TEXTURE\r\n  emissive *= texture(u_EmissiveTexture, v_TexCoord[MATERIAL_EMISSIVE_TEXTURE]);\r\n#endif\r\n\r\n  o_Color = vec4(color.rgb, metallic);\r\n  o_Normal = vec4(normal, roughness);\r\n  o_Emissive = vec4(emissive, occlusion);\r\n}\r\n"},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=r.g.create(),a=r.g.create(),s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.e.create();!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=r.e.create(),this.projection=r.e.create(),this.corners=[r.g.create(),r.g.create(),r.g.create(),r.g.create()],this.cornerScale=1,this.name=e.name,this.props=e,this.type=e.type||"perspective",this.world=n,this.pos=this.world.subarray(12,15),this.dirX=this.world.subarray(0,3),this.dirY=this.world.subarray(4,7),this.dirZ=this.world.subarray(8,11)}return i(t,[{key:"update",value:function(t){if(r.e.invert(this.view,this.world),"perspective"===this.type){var e=this.props,n=e.xfov,i=e.yfov,s=e.znear,u=e.zfar,c=void 0===u?1/0:u,f=e.aspectRatio,l=void 0===f?t:f;this.aspect=l,n?(this.fovX=n,this.tanX=Math.tan(this.fovX/2),this.tanY=this.tanX/this.aspect,this.fovY=2*Math.atan(this.tanY)):(this.fovY=i,this.tanY=Math.tan(this.fovY/2),this.tanX=this.tanY*this.aspect,this.fovX=2*Math.atan(this.tanX)),this.near=s,this.far=c,r.e.perspective(this.projection,this.fovY,l,s,c),this.cornerScale=1/Math.sqrt(1+this.tanX*this.tanX+this.tanY*this.tanY),r.g.scale(o,this.dirZ,-this.cornerScale),r.g.scaleAndAdd(a,o,this.dirX,-this.tanX*this.cornerScale),r.g.scaleAndAdd(this.corners[0],a,this.dirY,this.tanY*this.cornerScale),r.g.scaleAndAdd(this.corners[1],a,this.dirY,-this.tanY*this.cornerScale),r.g.scaleAndAdd(a,o,this.dirX,this.tanX*this.cornerScale),r.g.scaleAndAdd(this.corners[2],a,this.dirY,-this.tanY*this.cornerScale),r.g.scaleAndAdd(this.corners[3],a,this.dirY,this.tanY*this.cornerScale)}else{var h=this.props,d=h.xmag,_=h.ymag,p=h.znear,E=h.zfar;this.aspect=d/_,this.viewX=d,this.viewY=_,this.near=p,this.far=E,r.e.ortho(this.projection,-d,d,-_,_,p,E),r.g.scaleAndAdd(o,this.pos,this.dirX,-d),r.g.scaleAndAdd(this.corners[0],o,this.dirY,_),r.g.scaleAndAdd(this.corners[1],o,this.dirY,-_),r.g.scaleAndAdd(o,this.pos,this.dirX,d),r.g.scaleAndAdd(this.corners[2],o,this.dirY,-_),r.g.scaleAndAdd(this.corners[3],o,this.dirY,_)}}},{key:"getCorners",value:function(t,e){var n=this.pos,i=this.corners,o=this.dirZ;"perspective"===this.type?(e/=this.cornerScale,r.g.scaleAndAdd(t[0],n,i[0],e),r.g.scaleAndAdd(t[1],n,i[1],e),r.g.scaleAndAdd(t[2],n,i[2],e),r.g.scaleAndAdd(t[3],n,i[3],e)):(r.g.scaleAndAdd(t[0],i[0],o,-e),r.g.scaleAndAdd(t[1],i[1],o,-e),r.g.scaleAndAdd(t[2],i[2],o,-e),r.g.scaleAndAdd(t[3],i[3],o,-e))}},{key:"inverseProj",value:function(){var t=this.tanX,e=this.tanY,n=this.near,r=this.far;return r!==1/0?[t,e,(n-r)/(n*r),1/n]:[t,e,-1/n,1/n]}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.visible=!0,this.children=[],this.worldMatrix=r.e.create(),this.name=e}return i(t,[{key:"addChild",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){t.children.indexOf(e)<0&&t.children.push(e)})}},{key:"removeChild",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){var n=t.children.indexOf(e);n>=0&&t.children.splice(n,1)})}},{key:"resolve",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.visible&&(this.matrix?r.e.multiply(this.worldMatrix,t,this.matrix):this.translation||this.rotation||this.scale?(this.scale?this.translation||this.rotation?r.e.fromRotationTranslationScale(this.worldMatrix,this.rotation||[0,0,0,1],this.translation||[0,0,0],this.scale):r.e.fromScaling(this.worldMatrix,this.scale):this.rotation?this.translation?r.e.fromRotationTranslation(this.worldMatrix,this.rotation,this.translation):r.e.fromQuat(this.worldMatrix,this.rotation):r.e.fromTranslation(this.worldMatrix,this.translation||[0,0,0]),r.e.multiply(this.worldMatrix,t,this.worldMatrix)):r.e.copy(this.worldMatrix,t),n&&this.mesh&&this.mesh.primitives.forEach(function(t){n.add(e.worldMatrix,t,e.morphWeights||e.mesh.morphWeights)}),i&&this.light&&i.push(this.light),this.children.forEach(function(t){return t.resolve(e.worldMatrix,n,i)}))}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.primitives=n}}]);
//# sourceMappingURL=main.01a275ad.js.map